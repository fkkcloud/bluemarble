angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){for(var e=0;18>e;e++)EdgeManagerCluster.hideAll(),NodeManagerCluster.hideAll()}function s(){for(var e=0;18>e;e++)EdgeManagerCluster.showAll(),NodeManagerCluster.showAll()}function r(){var e=function(){this.AdditiveColor=!0,this.Restart=function(){location.reload()},this.HideNodes=!1,this.HideNames=!1,this.Data="US"};RENDEROPTIONS=new e;var l=new dat.GUI,t=l.add(RENDEROPTIONS,"Data",["US","KOR"]),s=l.addFolder("Clusters"),r=s.add(RENDEROPTIONS,"HideNodes"),i=l.addFolder("MergePaths"),o=i.add(RENDEROPTIONS,"HideNodes"),n=i.add(RENDEROPTIONS,"HideNames");t.onFinishChange(function(e){"US"==e?(dataManager.start("US"),a.clusterids=[{value:1,displayName:"1"},{value:2,displayName:"2"},{value:3,displayName:"3"},{value:4,displayName:"4"},{value:5,displayName:"5"},{value:6,displayName:"6"},{value:7,displayName:"7"},{value:8,displayName:"8"},{value:9,displayName:"9"},{value:10,displayName:"10"},{value:11,displayName:"11"},{value:12,displayName:"12"},{value:13,displayName:"13"},{value:14,displayName:"14"},{value:15,displayName:"15"},{value:16,displayName:"16"},{value:17,displayName:"Not Clustered"},{value:18,displayName:"All"}],1==PAGE_NUM.value?a.resetClusters():2==PAGE_NUM.value&&a.resetMergePaths()):"KOR"==e&&(dataManager.start("KOR"),a.clusterids=[{value:0,displayName:"0"},{value:1,displayName:"1"},{value:2,displayName:"2"},{value:3,displayName:"Not Clustered"},{value:4,displayName:"All"}],1==PAGE_NUM.value?a.resetClusters():2==PAGE_NUM.value&&a.resetMergePaths())}),r.onFinishChange(function(e){NodeManagerCluster.toggleNodeVisibility(1==e?!1:!0)}),o.onFinishChange(function(e){if(1==e)for(var a=0;a<NodeManagerMergePaths.length;a++)for(var l=0;l<SELECTED_MERGEPATHIDS.length;l++)SELECTED_MERGEPATHIDS[l]===a&&NodeManagerMergePaths[a].toggleNodeVisibility(!1);else for(var a=0;a<NodeManagerMergePaths.length;a++)for(var l=0;l<SELECTED_MERGEPATHIDS.length;l++)SELECTED_MERGEPATHIDS[l]===a&&NodeManagerMergePaths[a].toggleNodeVisibility(!0)}),n.onFinishChange(function(e){if(1==e)for(var a=0;a<NodeManagerMergePaths.length;a++)for(var l=0;l<SELECTED_MERGEPATHIDS.length;l++)SELECTED_MERGEPATHIDS[l]===a&&NodeManagerMergePaths[a].toggleNodeTextVisibility(!1);else for(var a=0;a<NodeManagerMergePaths.length;a++)for(var l=0;l<SELECTED_MERGEPATHIDS.length;l++)SELECTED_MERGEPATHIDS[l]===a&&NodeManagerMergePaths[a].toggleNodeTextVisibility(!0)}),l.add(RENDEROPTIONS,"Restart"),$(l.domElement).find(">ul").toggleClass("closed")}a.meanAge={value:0},a.mergePathIds={value:"acute myocardial infarction"},a.getMenuShow=function(){return a.show_menu},$(window).resize(function(){this.resizeTO&&clearTimeout(this.resizeTO),this.resizeTO=setTimeout(function(){$(this).trigger("resizeEnd")},200)}),$(window).bind("resizeEnd",function(){location.reload()}),a.clusterids=[{value:1,displayName:"1"},{value:2,displayName:"2"},{value:3,displayName:"3"},{value:4,displayName:"4"},{value:5,displayName:"5"},{value:6,displayName:"6"},{value:7,displayName:"7"},{value:8,displayName:"8"},{value:9,displayName:"9"},{value:10,displayName:"10"},{value:11,displayName:"11"},{value:12,displayName:"12"},{value:13,displayName:"13"},{value:14,displayName:"14"},{value:15,displayName:"15"},{value:16,displayName:"16"},{value:17,displayName:"Not Clustered"},{value:18,displayName:"All"}],a.cleanMergePaths=function(){NodeManagerMergePaths[SELECTED_MERGEPATHID].clean()},a.resetMergePaths=function(){FRAME.value=0,PAGE_NUM.value=2,TWEEN.removeAll(),NodeManagerMergePaths[SELECTED_MERGEPATHID].reset(),EdgeManagerMergePaths[SELECTED_MERGEPATHID].reset()},a.resetClusters=function(){FRAME.value=0,PAGE_NUM.value=1,a.meanAge.value=0,TWEEN.removeAll(),EdgeManagerCluster.reset(),NodeManagerCluster.reset(),a.setClusterID(SELECTED_CLUSTER),a.updateMeanAge()},a.setClusterID=function(e){return SELECTED_CLUSTER=e,e==NOT_CLUSTER_ID?(SELECTED_CLUSTER=NOT_CLUSTER_ID,t(),EdgeManagerCluster.toggleShowByCluster(NOT_CLUSTER_ID),void NodeManagerCluster.toggleShowByCluster(NOT_CLUSTER_ID)):e==ALL_CLUSTER_ID?void s():(t(),EdgeManagerCluster.toggleShowByCluster(SELECTED_CLUSTER),void NodeManagerCluster.toggleShowByCluster(SELECTED_CLUSTER))},a.updateMeanAge=function(){if(!(FRAME.value>620||1!=PAGE_NUM.value)){var e=mapRange([0,620],[35.4,90.5],FRAME.value);a.meanAge.value=Math.ceil(e),a.$apply(),requestAnimationFrame(a.updateMeanAge)}},r()}]),angular.module("app").config(["$routeProvider",function(e){e.when("/mergepaths",{templateUrl:"/templates/mergepaths.html",controller:"MergePathCtrl"}).when("/clusters",{templateUrl:"/templates/clusters.html",controller:"ClusterCtrl"}).when("/intro",{templateUrl:"/templates/intro.html",controller:"IntroCtrl"}).otherwise({redirectTo:"/intro"})}]),angular.module("app").controller("ClusterCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){PAGE_NUM.value=1,bCanvasLoaded&&$("#options-clusters").css("visibility","visible")}function s(){$(".data-visibility").addClass("active")}t(),a.selectedid={value:SELECTED_CLUSTER},s(),$("#btn-reset-clusters").click(function(){a.resetClusters()}),a.updateMeanAge(),$("#clusterid").change(function(){var e=$("#clusterid").val();a.setClusterID(e)})}]),angular.module("app").controller("IntroCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){PAGE_NUM.value=0}function s(){$(".data-visibility").removeClass("active")}t(),s()}]),angular.module("app").controller("MergePathCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){PAGE_NUM.value=2,bCanvasLoaded&&$("#options-mergepaths").css("visibility","visible")}function s(){$(".data-visibility").addClass("active")}t(),s(),$("#btn-reset-mergepaths").click(function(){a.resetMergePaths()}),$("#btn-run-mergepaths").click(function(){var e=document.getElementById("textinfo-mergepathids").value;try{var l=parseInt(e);if(isNaN(l))for(var t=e.toLowerCase(),s=0;s<MERGEPATH_INITNODE_REF.length;s++){var r=MERGEPATH_INITNODE_REF[s];if(r==t){e=s,console.log("selected disease for",t," is id:",s);break}}}catch(i){return void console.log(i)}a.cleanMergePaths(),SELECTED_MERGEPATHID=e,a.mergePathIds.value=MERGEPATH_INITNODE_REF[e],a.$apply(),a.resetMergePaths()})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJDb250cm9sbGVycy9jbHVzdGVyLmN0cmwuanMiLCJDb250cm9sbGVycy9pbnRyby5jdHJsLmpzIiwiQ29udHJvbGxlcnMvbWVyZ2VwYXRoLmN0cmwuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkcm9vdFNjb3BlIiwiJHNjb3BlIiwiJHdpbmRvdyIsImNsZWFyQWxsQ2x1c3RlcnMiLCJpIiwiRWRnZU1hbmFnZXJDbHVzdGVyIiwiaGlkZUFsbCIsIk5vZGVNYW5hZ2VyQ2x1c3RlciIsInZpZXdBbGxDbHVzdGVycyIsInNob3dBbGwiLCJzZXREYXRhR3VpSW5pdGlhbGl6ZSIsInJlbmRlck9wdGlvbnNVSSIsInRoaXMiLCJBZGRpdGl2ZUNvbG9yIiwiUmVzdGFydCIsImxvY2F0aW9uIiwicmVsb2FkIiwiSGlkZU5vZGVzIiwiSGlkZU5hbWVzIiwiRGF0YSIsIlJFTkRFUk9QVElPTlMiLCJndWkiLCJkYXQiLCJHVUkiLCJEYXRhVHlwZSIsImFkZCIsIkNsdXN0ZXJzR3JwIiwiYWRkRm9sZGVyIiwiQ2x1c3RlckhpZGVOb2RlcyIsIk1lcmdlUGF0aEdycCIsIk1lcmdlUGF0aEhpZGVOb2RlcyIsIk1lcmdlUGF0aEhpZGVOYW1lcyIsIm9uRmluaXNoQ2hhbmdlIiwidmFsIiwiZGF0YU1hbmFnZXIiLCJzdGFydCIsImNsdXN0ZXJpZHMiLCJ2YWx1ZSIsImRpc3BsYXlOYW1lIiwiUEFHRV9OVU0iLCJyZXNldENsdXN0ZXJzIiwicmVzZXRNZXJnZVBhdGhzIiwidG9nZ2xlTm9kZVZpc2liaWxpdHkiLCJOb2RlTWFuYWdlck1lcmdlUGF0aHMiLCJsZW5ndGgiLCJqIiwiU0VMRUNURURfTUVSR0VQQVRISURTIiwidG9nZ2xlTm9kZVRleHRWaXNpYmlsaXR5IiwiJCIsImRvbUVsZW1lbnQiLCJmaW5kIiwidG9nZ2xlQ2xhc3MiLCJtZWFuQWdlIiwibWVyZ2VQYXRoSWRzIiwiZ2V0TWVudVNob3ciLCJzaG93X21lbnUiLCJ3aW5kb3ciLCJyZXNpemUiLCJyZXNpemVUTyIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJ0cmlnZ2VyIiwiYmluZCIsImNsZWFuTWVyZ2VQYXRocyIsIlNFTEVDVEVEX01FUkdFUEFUSElEIiwiY2xlYW4iLCJGUkFNRSIsIlRXRUVOIiwicmVtb3ZlQWxsIiwicmVzZXQiLCJFZGdlTWFuYWdlck1lcmdlUGF0aHMiLCJzZXRDbHVzdGVySUQiLCJTRUxFQ1RFRF9DTFVTVEVSIiwidXBkYXRlTWVhbkFnZSIsImNsdXN0ZXJpZCIsIk5PVF9DTFVTVEVSX0lEIiwidG9nZ2xlU2hvd0J5Q2x1c3RlciIsIkFMTF9DTFVTVEVSX0lEIiwibmV3TWVhbkFnZSIsIm1hcFJhbmdlIiwiTWF0aCIsImNlaWwiLCIkYXBwbHkiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJzZXRQYWdlTnVtIiwiYkNhbnZhc0xvYWRlZCIsImNzcyIsInNldFZpc2liaWxpdHkiLCJhZGRDbGFzcyIsInNlbGVjdGVkaWQiLCJjbGljayIsImNoYW5nZSIsInJlbW92ZUNsYXNzIiwiaW5wdXQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwibWVyZ2VQYXRoSWQiLCJwYXJzZUludCIsImlzTmFOIiwibG93ZXJDYXNlZERpc2Vhc2VOYW1lIiwidG9Mb3dlckNhc2UiLCJNRVJHRVBBVEhfSU5JVE5PREVfUkVGIiwibmFtZSIsImNvbnNvbGUiLCJsb2ciLCJlcnIiXSwibWFwcGluZ3MiOiJBQUNBQSxRQUFBQyxPQUFBLE9BQ0EsWUNGQUQsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLG1CQUFBLGFBQUEsU0FBQSxVQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBOEdBLFFBQUFDLEtBQ0EsSUFBQSxHQUFBQyxHQUFBLEVBQUEsR0FBQUEsRUFB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LE1BQUEyRyxHQUVBLFdBREFGLFNBQUFDLElBQUFDLEdBSUE5RyxFQUFBOEQsa0JBRUFDLHFCQUFBbUMsRUFFQWxHLEVBQUFvRCxhQUFBaEIsTUFBQXNFLHVCQUFBUixHQUNBbEcsRUFBQWlGLFNBRUFqRixFQUFBd0MiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuXHQnbmdSb3V0ZScsXG5dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdyl7XG5cblx0JHNjb3BlLm1lYW5BZ2UgPSB7IHZhbHVlIDogMCB9O1xuXHQkc2NvcGUubWVyZ2VQYXRoSWRzID0geyB2YWx1ZSA6IFwiYWN1dGUgbXlvY2FyZGlhbCBpbmZhcmN0aW9uXCJ9O1xuXG5cdCRzY29wZS5nZXRNZW51U2hvdyA9IGZ1bmN0aW9uKCl7XG5cdFx0cmV0dXJuICRzY29wZS5zaG93X21lbnU7XG5cdH1cblxuXHQvLyBhcyByZXNpemUsIHJlLWluaXQgZGF0YXNcblx0JCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbigpIHtcbiAgICBpZih0aGlzLnJlc2l6ZVRPKSBjbGVhclRpbWVvdXQodGhpcy5yZXNpemVUTyk7XG5cdCAgICB0aGlzLnJlc2l6ZVRPID0gc2V0VGltZW91dChmdW5jdGlvbigpIHtcblx0ICAgICAgICAkKHRoaXMpLnRyaWdnZXIoJ3Jlc2l6ZUVuZCcpO1xuXHQgICAgfSwgMjAwKTtcblx0fSk7XG5cblx0JCh3aW5kb3cpLmJpbmQoJ3Jlc2l6ZUVuZCcsIGZ1bmN0aW9uKCkge1xuXHQgICAgLy9kbyBzb21ldGhpbmcsIHdpbmRvdyBoYXNuJ3QgY2hhbmdlZCBzaXplIGluIDUwMG1zXG5cdCAgICBsb2NhdGlvbi5yZWxvYWQoKTtcblx0fSk7XG5cblx0JHNjb3BlLmNsdXN0ZXJpZHMgPSBbXG4gICAgICB7dmFsdWU6IDEsIGRpc3BsYXlOYW1lOiAnMSd9LFxuICAgICAge3ZhbHVlOiAyLCBkaXNwbGF5TmFtZTogJzInfSxcbiAgICAgIHt2YWx1ZTogMywgZGlzcGxheU5hbWU6ICczJ30sXG4gICAgICB7dmFsdWU6IDQsIGRpc3BsYXlOYW1lOiAnNCd9LFxuICAgICAge3ZhbHVlOiA1LCBkaXNwbGF5TmFtZTogJzUnfSxcbiAgICAgIHt2YWx1ZTogNiwgZGlzcGxheU5hbWU6ICc2J30sXG4gICAgICB7dmFsdWU6IDcsIGRpc3BsYXlOYW1lOiAnNyd9LFxuICAgICAge3ZhbHVlOiA4LCBkaXNwbGF5TmFtZTogJzgnfSxcbiAgICAgIHt2YWx1ZTogOSwgZGlzcGxheU5hbWU6ICc5J30sXG4gICAgICB7dmFsdWU6IDEwLCBkaXNwbGF5TmFtZTogJzEwJ30sXG4gICAgICB7dmFsdWU6IDExLCBkaXNwbGF5TmFtZTogJzExJ30sXG4gICAgICB7dmFsdWU6IDEyLCBkaXNwbGF5TmFtZTogJzEyJ30sXG4gICAgICB7dmFsdWU6IDEzLCBkaXNwbGF5TmFtZTogJzEzJ30sXG4gICAgICB7dmFsdWU6IDE0LCBkaXNwbGF5TmFtZTogJzE0J30sXG4gICAgICB7dmFsdWU6IDE1LCBkaXNwbGF5TmFtZTogJzE1J30sXG4gICAgICB7dmFsdWU6IDE2LCBkaXNwbGF5TmFtZTogJzE2J30sXG4gICAgICB7dmFsdWU6IDE3LCBkaXNwbGF5TmFtZTogJ05vdCBDbHVzdGVyZWQnfSxcbiAgICAgIHt2YWx1ZTogMTgsIGRpc3BsYXlOYW1lOiAnQWxsJ31cbiAgXHRdO1xuXG5cblxuXHQkc2NvcGUuY2xlYW5NZXJnZVBhdGhzID0gZnVuY3Rpb24oKXtcblxuXHRcdE5vZGVNYW5hZ2VyTWVyZ2VQYXRoc1tTRUxFQ1RFRF9NRVJHRVBBVEhJRF0uY2xlYW4oKTtcblxuXHR9XG5cblx0JHNjb3BlLnJlc2V0TWVyZ2VQYXRocyA9IGZ1bmN0aW9uKCl7XG5cdFx0RlJBTUUudmFsdWUgICAgPSAwO1xuXHRcdFBBR0VfTlVNLnZhbHVlID0gMjtcblxuXHRcdFRXRUVOLnJlbW92ZUFsbCgpOyAvLyByZXNldCB0d2VlbiBhbmltYXRpb25zXG5cblx0XHROb2RlTWFuYWdlck1lcmdlUGF0aHNbU0VMRUNURURfTUVSR0VQQVRISURdLnJlc2V0KCk7XG5cdFx0RWRnZU1hbmFnZXJNZXJnZVBhdGhzW1NFTEVDVEVEX01FUkdFUEFUSElEXS5yZXNldCgpO1xuXG5cdH1cblxuXHQkc2NvcGUucmVzZXRDbHVzdGVycyA9IGZ1bmN0aW9uKCl7XG5cbiAgICAgIFx0RlJBTUUudmFsdWUgICAgPSAwO1xuICAgICAgXHRQQUdFX05VTS52YWx1ZSA9IDE7XG5cbiAgICAgIFx0JHNjb3BlLm1lYW5BZ2UudmFsdWUgPSAwO1xuXG4gICAgICBcdFRXRUVOLnJlbW92ZUFsbCgpOyAvLyByZXNldCB0d2VlbiBhbmltYXRpb25zXG5cbiAgICAgIFx0RWRnZU1hbmFnZXJDbHVzdGVyLnJlc2V0KCk7XG4gICAgICBcdE5vZGVNYW5hZ2VyQ2x1c3Rlci5yZXNldCgpO1xuXG4gICAgICBcdCRzY29wZS5zZXRDbHVzdGVySUQoU0VMRUNURURfQ0xVU1RFUik7XG5cbiAgICAgIFx0JHNjb3BlLnVwZGF0ZU1lYW5BZ2UoKTtcblx0XG5cdH1cblxuXHQkc2NvcGUuc2V0Q2x1c3RlcklEID0gZnVuY3Rpb24oY2x1c3RlcmlkKXtcblxuXHQgICAgU0VMRUNURURfQ0xVU1RFUiA9IGNsdXN0ZXJpZDtcblxuXHQgICAgaWYgKGNsdXN0ZXJpZCA9PSBOT1RfQ0xVU1RFUl9JRCl7XG5cblx0ICAgICAgICBTRUxFQ1RFRF9DTFVTVEVSID0gTk9UX0NMVVNURVJfSUQ7XG5cdCAgICAgICAgXG5cdCAgICAgICAgY2xlYXJBbGxDbHVzdGVycygpO1xuXHQgICAgICAgIEVkZ2VNYW5hZ2VyQ2x1c3Rlci50b2dnbGVTaG93QnlDbHVzdGVyKE5PVF9DTFVTVEVSX0lEKTtcblx0ICAgICAgICBOb2RlTWFuYWdlckNsdXN0ZXIudG9nZ2xlU2hvd0J5Q2x1c3RlcihOT1RfQ0xVU1RFUl9JRCk7XG5cblx0ICAgICAgICByZXR1cm47XG5cblx0ICAgIH1cblxuXHQgICAgaWYgKGNsdXN0ZXJpZCA9PSBBTExfQ0xVU1RFUl9JRCl7XG5cblx0ICAgICAgICB2aWV3QWxsQ2x1c3RlcnMoKTsgXG5cblx0ICAgICAgICByZXR1cm47IFxuXG5cdCAgICB9XG5cblx0ICAgIGNsZWFyQWxsQ2x1c3RlcnMoKTtcblx0ICAgIEVkZ2VNYW5hZ2VyQ2x1c3Rlci50b2dnbGVTaG93QnlDbHVzdGVyKFNFTEVDVEVEX0NMVVNURVIpO1xuXHQgICAgTm9kZU1hbmFnZXJDbHVzdGVyLnRvZ2dsZVNob3dCeUNsdXN0ZXIoU0VMRUNURURfQ0xVU1RFUik7XG5cdH1cblxuXHQvLyBjbGVhciBhbGwgY2x1c3RlcnNcbiAgXHRmdW5jdGlvbiBjbGVhckFsbENsdXN0ZXJzKCl7IC8vIOyngOq4iCDsnbTqsowgZ2xvYmFs66GcIOygleydmOuQnCDqsoPsnbjrjbAsIOyVhOuniOuPhCDtgbTroZzspazslrQg7JWI7JeQIOuEo+yWtOyEnCwg7J20IO2MjOydvCDslYjsl5DshJzrp4wg6rCA64ql7ZWcIGxvY2FsIHNwYWNl66GcIOyYruqyqOyVvCDtlaDrk6/si7bri6QuXG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE4OyBpKyspe1xuXG5cdCAgICAgIEVkZ2VNYW5hZ2VyQ2x1c3Rlci5oaWRlQWxsKCk7XG5cdCAgICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci5oaWRlQWxsKCk7XG5cblx0ICAgIH1cblx0fVxuXG5cdC8vIGNsZWFyIGFsbCBjbHVzdGVyc1xuXHRmdW5jdGlvbiB2aWV3QWxsQ2x1c3RlcnMoKXtcblx0ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTg7IGkrKyl7XG5cblx0ICAgICAgRWRnZU1hbmFnZXJDbHVzdGVyLnNob3dBbGwoKTtcblx0ICAgICAgTm9kZU1hbmFnZXJDbHVzdGVyLnNob3dBbGwoKTtcblxuXHQgICAgfVxuXHR9XG5cblx0JHNjb3BlLnVwZGF0ZU1lYW5BZ2UgPSBmdW5jdGlvbigpe1xuXHQgICAgaWYgKEZSQU1FLnZhbHVlID4gNjIwIHx8IFBBR0VfTlVNLnZhbHVlICE9IDEpXG5cdCAgICAgIHJldHVybjtcblxuXHQgICAgdmFyIG5ld01lYW5BZ2UgPSBtYXBSYW5nZShbMCwgNjIwLjBdLCBbMzUuNCwgOTAuNV0sIEZSQU1FLnZhbHVlKTtcblx0ICAgICRzY29wZS5tZWFuQWdlLnZhbHVlID0gTWF0aC5jZWlsKG5ld01lYW5BZ2UpO1xuXHQgICAgJHNjb3BlLiRhcHBseSgpO1xuXHQgICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCRzY29wZS51cGRhdGVNZWFuQWdlKTtcblx0fVxuXG5cdGZ1bmN0aW9uIHNldERhdGFHdWlJbml0aWFsaXplKCl7XG5cblx0ICAgIHZhciByZW5kZXJPcHRpb25zVUkgPSBmdW5jdGlvbigpIHtcblxuXHQgICAgICB0aGlzLkFkZGl0aXZlQ29sb3IgPSB0cnVlO1xuXG5cdCAgICAgIHRoaXMuUmVzdGFydCA9IGZ1bmN0aW9uKCkgeyBcblxuXHQgICAgICBcdCAvLyByZXN0YXJ0IHRoZSBwYWdlXG5cdCAgICAgIFx0IGxvY2F0aW9uLnJlbG9hZCgpO1xuXG5cdCAgICAgIH07XG5cblx0ICAgICAgdGhpcy5IaWRlTm9kZXMgPSBmYWxzZTtcblxuXHQgICAgICB0aGlzLkhpZGVOYW1lcyA9IGZhbHNlO1xuXG5cdCAgICAgIHRoaXMuRGF0YSAgICAgID0gJ1VTJztcblx0ICAgIH07XG5cblx0ICAgIFJFTkRFUk9QVElPTlMgXHQ9IG5ldyByZW5kZXJPcHRpb25zVUkoKTtcblx0ICAgIHZhciBndWkgIFx0XHQ9IG5ldyBkYXQuR1VJKCk7XG5cblx0ICAgIHZhciBEYXRhVHlwZSAgICAgICAgID0gZ3VpLmFkZChSRU5ERVJPUFRJT05TLCAnRGF0YScsIFsgJ1VTJywgJ0tPUicgXSApO1xuXG5cdCAgICB2YXIgQ2x1c3RlcnNHcnAgICAgICA9IGd1aS5hZGRGb2xkZXIoJ0NsdXN0ZXJzJyk7XG5cdFx0dmFyIENsdXN0ZXJIaWRlTm9kZXMgPSBDbHVzdGVyc0dycC5hZGQoUkVOREVST1BUSU9OUywgJ0hpZGVOb2RlcycpO1xuXG5cdFx0dmFyIE1lcmdlUGF0aEdycCAgICAgICA9IGd1aS5hZGRGb2xkZXIoJ01lcmdlUGF0aHMnKTtcblx0XHR2YXIgTWVyZ2VQYXRoSGlkZU5vZGVzID0gTWVyZ2VQYXRoR3JwLmFkZChSRU5ERVJPUFRJT05TLCAnSGlkZU5vZGVzJyk7XG5cdFx0dmFyIE1lcmdlUGF0aEhpZGVOYW1lcyA9IE1lcmdlUGF0aEdycC5hZGQoUkVOREVST1BUSU9OUywgJ0hpZGVOYW1lcycpO1xuXG5cdFx0RGF0YVR5cGUub25GaW5pc2hDaGFuZ2UoZnVuY3Rpb24odmFsKSB7XG5cdFx0XHRpZiAodmFsID09ICdVUycpe1xuXHRcdFx0XHRkYXRhTWFuYWdlci5zdGFydCgnVVMnKTtcblx0XHRcdFx0JHNjb3BlLmNsdXN0ZXJpZHMgPSBbXG5cdFx0XHQgICAgICB7dmFsdWU6IDEsIGRpc3BsYXlOYW1lOiAnMSd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiAyLCBkaXNwbGF5TmFtZTogJzInfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMywgZGlzcGxheU5hbWU6ICczJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDQsIGRpc3BsYXlOYW1lOiAnNCd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiA1LCBkaXNwbGF5TmFtZTogJzUnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogNiwgZGlzcGxheU5hbWU6ICc2J30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDcsIGRpc3BsYXlOYW1lOiAnNyd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiA4LCBkaXNwbGF5TmFtZTogJzgnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogOSwgZGlzcGxheU5hbWU6ICc5J30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDEwLCBkaXNwbGF5TmFtZTogJzEwJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDExLCBkaXNwbGF5TmFtZTogJzExJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDEyLCBkaXNwbGF5TmFtZTogJzEyJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDEzLCBkaXNwbGF5TmFtZTogJzEzJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDE0LCBkaXNwbGF5TmFtZTogJzE0J30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDE1LCBkaXNwbGF5TmFtZTogJzE1J30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDE2LCBkaXNwbGF5TmFtZTogJzE2J30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDE3LCBkaXNwbGF5TmFtZTogJ05vdCBDbHVzdGVyZWQnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTgsIGRpc3BsYXlOYW1lOiAnQWxsJ31cblx0XHRcdCAgXHRdO1xuXHRcdFx0ICBcdGlmIChQQUdFX05VTS52YWx1ZSA9PSAxKSBcblx0XHRcdCAgXHRcdCRzY29wZS5yZXNldENsdXN0ZXJzKCk7XG5cdFx0XHQgIFx0ZWxzZSBpZiAoUEFHRV9OVU0udmFsdWUgPT0gMilcblx0XHRcdCAgXHRcdCRzY29wZS5yZXNldE1lcmdlUGF0aHMoKTsgXG5cdFx0XHR9XG5cdFx0XHRlbHNlIGlmICh2YWwgPT0gJ0tPUicpe1xuXHRcdFx0XHRkYXRhTWFuYWdlci5zdGFydCgnS09SJyk7XG5cdFx0XHRcdCRzY29wZS5jbHVzdGVyaWRzID0gW1xuXHRcdFx0ICAgICAge3ZhbHVlOiAwLCBkaXNwbGF5TmFtZTogJzAnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMSwgZGlzcGxheU5hbWU6ICcxJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDIsIGRpc3BsYXlOYW1lOiAnMid9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiAzLCBkaXNwbGF5TmFtZTogJ05vdCBDbHVzdGVyZWQnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogNCwgZGlzcGxheU5hbWU6ICdBbGwnfVxuXHRcdFx0ICBcdF07XG5cdFx0XHQgIFx0aWYgKFBBR0VfTlVNLnZhbHVlID09IDEpIFxuXHRcdFx0ICBcdFx0JHNjb3BlLnJlc2V0Q2x1c3RlcnMoKTtcblx0XHRcdCAgXHRlbHNlIGlmIChQQUdFX05VTS52YWx1ZSA9PSAyKVxuXHRcdFx0ICBcdFx0JHNjb3BlLnJlc2V0TWVyZ2VQYXRocygpOyAgXG5cdFx0XHR9XG5cdFx0fSlcblxuXHQgICAgQ2x1c3RlckhpZGVOb2Rlcy5vbkZpbmlzaENoYW5nZShmdW5jdGlvbih2YWwpIHtcblx0ICAgIFx0aWYgKHZhbCA9PSB0cnVlKSB7XG5cdFx0ICAgICAgICBOb2RlTWFuYWdlckNsdXN0ZXIudG9nZ2xlTm9kZVZpc2liaWxpdHkoZmFsc2UpO1xuXHQgICAgXHR9XG5cdCAgICBcdGVsc2Uge1xuXHRcdCAgICAgICAgTm9kZU1hbmFnZXJDbHVzdGVyLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KHRydWUpO1xuXHQgICAgXHR9XG5cdCAgICB9KTtcblxuXHQgICBcdE1lcmdlUGF0aEhpZGVOb2Rlcy5vbkZpbmlzaENoYW5nZShmdW5jdGlvbih2YWwpIHtcblx0ICAgIFx0aWYgKHZhbCA9PSB0cnVlKSB7XG5cdCAgICAgICAgXHRmb3IgKHZhciBpID0gMDsgaSA8IE5vZGVNYW5hZ2VyTWVyZ2VQYXRocy5sZW5ndGg7IGkrKyl7XG5cblx0XHQgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBTRUxFQ1RFRF9NRVJHRVBBVEhJRFMubGVuZ3RoOyBqKyspe1xuXG5cdFx0ICAgICAgICAgICAgaWYgKFNFTEVDVEVEX01FUkdFUEFUSElEU1tqXSA9PT0gaSlcblx0XHQgICAgICAgICAgICAgIE5vZGVNYW5hZ2VyTWVyZ2VQYXRoc1tpXS50b2dnbGVOb2RlVmlzaWJpbGl0eShmYWxzZSk7XG5cblx0XHQgICAgICAgICAgfVxuXHRcdCAgICAgICAgICBcblx0XHQgICAgICAgIH1cblx0ICAgIFx0fVxuXHQgICAgXHRlbHNlIHtcblx0ICAgICAgICBcdGZvciAodmFyIGkgPSAwOyBpIDwgTm9kZU1hbmFnZXJNZXJnZVBhdGhzLmxlbmd0aDsgaSsrKXtcblxuXHRcdCAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IFNFTEVDVEVEX01FUkdFUEFUSElEUy5sZW5ndGg7IGorKyl7XG5cblx0XHQgICAgICAgICAgICBpZiAoU0VMRUNURURfTUVSR0VQQVRISURTW2pdID09PSBpKVxuXHRcdCAgICAgICAgICAgICAgTm9kZU1hbmFnZXJNZXJnZVBhdGhzW2ldLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KHRydWUpO1xuXG5cdFx0ICAgICAgICAgIH1cblxuXHRcdCAgICAgICAgfVxuXHRcdCAgICB9XG5cdCAgICB9KTtcblxuXHQgICAgTWVyZ2VQYXRoSGlkZU5hbWVzLm9uRmluaXNoQ2hhbmdlKGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgXHRpZiAodmFsID09IHRydWUpIHtcblx0ICAgIFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IE5vZGVNYW5hZ2VyTWVyZ2VQYXRocy5sZW5ndGg7IGkrKyl7XG5cblx0XHQgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBTRUxFQ1RFRF9NRVJHRVBBVEhJRFMubGVuZ3RoOyBqKyspe1xuXG5cdFx0ICAgICAgICAgICAgaWYgKFNFTEVDVEVEX01FUkdFUEFUSElEU1tqXSA9PT0gaSlcblx0XHQgICAgICAgICAgICAgIE5vZGVNYW5hZ2VyTWVyZ2VQYXRoc1tpXS50b2dnbGVOb2RlVGV4dFZpc2liaWxpdHkoZmFsc2UpO1xuXG5cdFx0ICAgICAgICAgIH1cblx0XHQgICAgICAgIH1cblx0ICAgIFx0fVxuXHQgICAgXHRlbHNlIHtcblx0ICAgIFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IE5vZGVNYW5hZ2VyTWVyZ2VQYXRocy5sZW5ndGg7IGkrKyl7XG5cblx0XHQgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBTRUxFQ1RFRF9NRVJHRVBBVEhJRFMubGVuZ3RoOyBqKyspe1xuXG5cdFx0ICAgICAgICAgICAgaWYgKFNFTEVDVEVEX01FUkdFUEFUSElEU1tqXSA9PT0gaSlcblx0XHQgICAgICAgICAgICAgIE5vZGVNYW5hZ2VyTWVyZ2VQYXRoc1tpXS50b2dnbGVOb2RlVGV4dFZpc2liaWxpdHkodHJ1ZSk7XG5cblx0XHQgICAgICAgICAgfVxuXHRcdCAgICAgICAgfVxuXHQgICAgXHR9XG5cdCAgICB9KTtcblxuXHQgICAgZ3VpLmFkZChSRU5ERVJPUFRJT05TLCAnUmVzdGFydCcpO1xuXG5cdCAgICAkKGd1aS5kb21FbGVtZW50KS5maW5kKFwiPnVsXCIpLnRvZ2dsZUNsYXNzKFwiY2xvc2VkXCIpOyAvLyBkYXQuZ3VpIGRlZmF1bHQgdG8gYmUgY2xvc2VkXG5cblx0fVxuICBcdHNldERhdGFHdWlJbml0aWFsaXplKCk7XG59KTsiLCJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpe1xuXHQkcm91dGVQcm92aWRlclxuXHQud2hlbignL21lcmdlcGF0aHMnLCBcblx0XHR7XG5cdFx0XHR0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvbWVyZ2VwYXRocy5odG1sJyxcblx0XHRcdGNvbnRyb2xsZXI6ICdNZXJnZVBhdGhDdHJsJ1xuXHRcdH0pXG5cdC53aGVuKCcvY2x1c3RlcnMnLCBcblx0XHR7XG5cdFx0XHR0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvY2x1c3RlcnMuaHRtbCcsXG5cdFx0XHRjb250cm9sbGVyOiAnQ2x1c3RlckN0cmwnXG5cdFx0fSlcblx0LndoZW4oJy9pbnRybycsIFxuXHRcdHtcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9pbnRyby5odG1sJyxcblx0XHRcdGNvbnRyb2xsZXI6ICdJbnRyb0N0cmwnXG5cdFx0fSlcblx0Lm90aGVyd2lzZShcblx0XHR7XG4gICBcdFx0XHRyZWRpcmVjdFRvOiAnL2ludHJvJ1xuXHRcdH0pO1xuXG59KTtcbiIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQ2x1c3RlckN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICR3aW5kb3cpe1xuXG4gIGZ1bmN0aW9uIHNldFBhZ2VOdW0oKXtcbiAgICBQQUdFX05VTS52YWx1ZSA9IDE7IC8vIDEgLSBjbHVzdGVyXG5cbiAgICBpZiAoYkNhbnZhc0xvYWRlZClcbiAgICAgICQoJyNvcHRpb25zLWNsdXN0ZXJzJykuY3NzKCd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTtcbiAgfVxuICBzZXRQYWdlTnVtKCk7XG5cbiAgJHNjb3BlLnNlbGVjdGVkaWQgPSB7IHZhbHVlIDogU0VMRUNURURfQ0xVU1RFUiB9O1xuXG5cbiAgZnVuY3Rpb24gc2V0VmlzaWJpbGl0eSgpe1xuICAgICQoJy5kYXRhLXZpc2liaWxpdHknKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gIH1cbiAgc2V0VmlzaWJpbGl0eSgpO1xuXG5cbiAgLy8gcmVzZXQgYW5pbWF0aW9uLlxuICAkKCcjYnRuLXJlc2V0LWNsdXN0ZXJzJykuY2xpY2soZnVuY3Rpb24oKSB7XG5cbiAgICAkc2NvcGUucmVzZXRDbHVzdGVycygpO1xuXG4gIH0pO1xuXG5cbiAgJHNjb3BlLnVwZGF0ZU1lYW5BZ2UoKTtcbiAgLypcbiAgLy9zZXQgaW5pdGlhbCBzdGF0ZS4gIGV4YW1wbGUgb2YgY2hlY2sgYm94IGV2ZW50XG4gICQoJyNjaGVja2JveC1oaWRlLW5vZGVzLWNsdXN0ZXJzJykuY2hhbmdlKGZ1bmN0aW9uKCkge1xuICAgICAgaWYoJCh0aGlzKS5pcyhcIjpjaGVja2VkXCIpKSB7XG4gICAgICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci50b2dnbGVOb2RlVmlzaWJpbGl0eSh0cnVlKTtcbiAgICAgIH1cbiAgICAgIGVsc2VcbiAgICAgIHtcbiAgICAgICAgTm9kZU1hbmFnZXJDbHVzdGVyLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KGZhbHNlKTtcbiAgICAgIH1cbiAgfSk7XG4gICovXG5cbiAgJCgnI2NsdXN0ZXJpZCcpLmNoYW5nZShmdW5jdGlvbigpe1xuXG4gICAgdmFyIGNsdXN0ZXJpZCA9ICQoJyNjbHVzdGVyaWQnKS52YWwoKTtcblxuICAgICRzY29wZS5zZXRDbHVzdGVySUQoY2x1c3RlcmlkKTtcblxuICB9KVxuXG5cbn0pOyIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignSW50cm9DdHJsJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkd2luZG93KXtcblxuXHRmdW5jdGlvbiBzZXRQYWdlTnVtKCl7XG4gICAgXHRQQUdFX05VTS52YWx1ZSA9IDA7XG4gIFx0fVxuICBcdHNldFBhZ2VOdW0oKTtcblxuXG5cdGZ1bmN0aW9uIHNldFZpc2liaWxpdHkoKXtcblx0XHQkKCcuZGF0YS12aXNpYmlsaXR5JykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHR9XG5cdHNldFZpc2liaWxpdHkoKTtcblxufSk7IiwiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdNZXJnZVBhdGhDdHJsJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkd2luZG93KXtcblxuICBmdW5jdGlvbiBzZXRQYWdlTnVtKCl7XG5cbiAgICBQQUdFX05VTS52YWx1ZSA9IDI7XG4gICAgLy8kc2NvcGUucmVzZXRNZXJnZVBhdGhzKCk7XG4gICAgXG4gICAgaWYgKGJDYW52YXNMb2FkZWQpXG4gICAgICAkKCcjb3B0aW9ucy1tZXJnZXBhdGhzJykuY3NzKCd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTtcblxuICB9XG4gIHNldFBhZ2VOdW0oKTtcblxuICBmdW5jdGlvbiBzZXRWaXNpYmlsaXR5KCl7XG5cbiAgICAkKCcuZGF0YS12aXNpYmlsaXR5JykuYWRkQ2xhc3MoJ2FjdGl2ZScpO1xuXG4gIH1cbiAgc2V0VmlzaWJpbGl0eSgpO1xuXG5cbiAgLy8gcmVzZXQgYW5pbWF0aW9uLlxuICAkKCcjYnRuLXJlc2V0LW1lcmdlcGF0aHMnKS5jbGljayhmdW5jdGlvbigpIHtcblxuICAgICRzY29wZS5yZXNldE1lcmdlUGF0aHMoKTsgXG5cbiAgfSk7XG5cblxuICAkKCcjYnRuLXJ1bi1tZXJnZXBhdGhzJykuY2xpY2soZnVuY3Rpb24oKSB7XG5cbiAgICB2YXIgaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInRleHRpbmZvLW1lcmdlcGF0aGlkc1wiKS52YWx1ZTtcblxuICAgIC8vIGRlYWwgd2l0aCBpbnB1dCB0byBmaW5kIG1lcmdlcGF0aCFcbiAgICB0cnkge1xuXG4gICAgICB2YXIgbWVyZ2VQYXRoSWQgPSBwYXJzZUludChpbnB1dCk7XG4gICAgICBpZiAoaXNOYU4obWVyZ2VQYXRoSWQpKXtcblxuICAgICAgICB2YXIgbG93ZXJDYXNlZERpc2Vhc2VOYW1lID0gaW5wdXQudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IE1FUkdFUEFUSF9JTklUTk9ERV9SRUYubGVuZ3RoOyBpKyspe1xuXG4gICAgICAgICAgdmFyIG5hbWUgPSBNRVJHRVBBVEhfSU5JVE5PREVfUkVGW2ldO1xuXG4gICAgICAgICAgaWYgKG5hbWUgPT0gbG93ZXJDYXNlZERpc2Vhc2VOYW1lKXtcblxuICAgICAgICAgICAgaW5wdXQgPSBpO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlbGVjdGVkIGRpc2Vhc2UgZm9yJywgbG93ZXJDYXNlZERpc2Vhc2VOYW1lLCAnIGlzIGlkOicsIGkpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICB9IFxuXG4gICAgICAgIH1cblxuICAgICAgfVxuICAgIH1cbiAgICBjYXRjaChlcnIpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgJHNjb3BlLmNsZWFuTWVyZ2VQYXRocygpO1xuXG4gICAgU0VMRUNURURfTUVSR0VQQVRISUQgPSBpbnB1dDtcblxuICAgICRzY29wZS5tZXJnZVBhdGhJZHMudmFsdWUgPSBNRVJHRVBBVEhfSU5JVE5PREVfUkVGW2lucHV0XTtcbiAgICAkc2NvcGUuJGFwcGx5KCk7XG5cbiAgICAkc2NvcGUucmVzZXRNZXJnZVBhdGhzKCk7XG5cbiAgfSlcblxuICAvL3NldCBpbml0aWFsIHN0YXRlLlxuICAvKlxuICAkKCcjY2hlY2tib3gtaGlkZS1ub2Rlcy1tZXJnZXBhdGhzJykuY2hhbmdlKGZ1bmN0aW9uKCkge1xuICAgICAgaWYoJCh0aGlzKS5pcyhcIjpjaGVja2VkXCIpKSB7XG5cbiAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTm9kZU1hbmFnZXJNZXJnZVBhdGhzLmxlbmd0aDsgaSsrKXtcblxuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgU0VMRUNURURfTUVSR0VQQVRISURTLmxlbmd0aDsgaisrKXtcblxuICAgICAgICAgICAgaWYgKFNFTEVDVEVEX01FUkdFUEFUSElEU1tqXSA9PT0gaSlcbiAgICAgICAgICAgICAgTm9kZU1hbmFnZXJNZXJnZVBhdGhzW2ldLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KHRydWUpO1xuXG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgfVxuICAgICAgICBcbiAgICAgIH1cbiAgICAgIGVsc2VcbiAgICAgIHtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IE5vZGVNYW5hZ2VyTWVyZ2VQYXRocy5sZW5ndGg7IGkrKyl7XG5cbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IFNFTEVDVEVEX01FUkdFUEFUSElEUy5sZW5ndGg7IGorKyl7XG5cbiAgICAgICAgICAgIGlmIChTRUxFQ1RFRF9NRVJHRVBBVEhJRFNbal0gPT09IGkpXG4gICAgICAgICAgICAgIE5vZGVNYW5hZ2VyTWVyZ2VQYXRoc1tpXS50b2dnbGVOb2RlVmlzaWJpbGl0eShmYWxzZSk7XG5cbiAgICAgICAgICB9XG5cbiAgICAgICAgIH1cblxuICAgICAgfVxuICB9KTtcblxuICAvL3NldCBpbml0aWFsIHN0YXRlLlxuICAkKCcjY2hlY2tib3gtaGlkZS1uYW1lcy1tZXJnZXBhdGhzJykuY2hhbmdlKGZ1bmN0aW9uKCkge1xuICAgICAgaWYoJCh0aGlzKS5pcyhcIjpjaGVja2VkXCIpKSB7XG5cbiAgICAgICAgTm9kZU1hbmFnZXJNZXJnZVBhdGhzW1NFTEVDVEVEX01FUkdFUEFUSElEXS50b2dnbGVOb2RlVGV4dFZpc2liaWxpdHkodHJ1ZSk7XG4gICAgICAgIFxuICAgICAgfVxuICAgICAgZWxzZVxuICAgICAge1xuXG4gICAgICAgIE5vZGVNYW5hZ2VyTWVyZ2VQYXRoc1tTRUxFQ1RFRF9NRVJHRVBBVEhJRF0udG9nZ2xlTm9kZVRleHRWaXNpYmlsaXR5KGZhbHNlKTtcblxuICAgICAgICAgIH1cblxuICAgICAgICAgfVxuXG4gICAgICB9XG4gIH0pO1xuKi9cbiAgXG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=