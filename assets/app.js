angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){EdgeManagerCluster.hideAll(),NodeManagerCluster.hideAll()}function s(){EdgeManagerCluster.showAll(),NodeManagerCluster.showAll()}function r(){var e=function(){this.AdditiveColor=!0,this.Restart=function(){location.reload()},this.HideNodes=!1,this.HideNames=!1,this.Data="US"};RENDEROPTIONS=new e;var l=new dat.GUI,t=l.add(RENDEROPTIONS,"Data",["US","KOR"]);t.onFinishChange(function(e){"US"==e?(dataManager.start("US"),a.clusterids=[{value:1,displayName:"1"},{value:2,displayName:"2"},{value:3,displayName:"3"},{value:4,displayName:"4"},{value:5,displayName:"5"},{value:6,displayName:"6"},{value:7,displayName:"7"},{value:8,displayName:"8"},{value:9,displayName:"9"},{value:10,displayName:"10"},{value:11,displayName:"11"},{value:12,displayName:"12"},{value:13,displayName:"13"},{value:14,displayName:"14"},{value:15,displayName:"15"},{value:16,displayName:"16"},{value:17,displayName:"Not Clustered"},{value:18,displayName:"All"}],1==PAGE_NUM.value?a.resetClusters():2==PAGE_NUM.value&&a.resetMergePaths(),a.mergePathIds.value="acute myocardial infarction",a.$apply()):"KOR"==e&&(dataManager.start("KOR"),a.clusterids=[{value:0,displayName:"0"},{value:1,displayName:"1"},{value:2,displayName:"2"},{value:3,displayName:"Not Clustered"},{value:4,displayName:"All"}],1==PAGE_NUM.value?a.resetClusters():2==PAGE_NUM.value&&a.resetMergePaths(),a.mergePathIds.value="chronic viral hepatitis",a.$apply())}),l.add(RENDEROPTIONS,"Restart")}a.diseases=void 0,setInterval(function(){a.diseases=MERGEPATH_INITNODE_REF},500),a.meanAge={value:0},a.mergePathIds={value:"acute myocardial infarction"},a.getMenuShow=function(){return a.show_menu},$(window).resize(function(){this.resizeTO&&clearTimeout(this.resizeTO),this.resizeTO=setTimeout(function(){$(this).trigger("resizeEnd")},200)}),$(window).bind("resizeEnd",function(){location.reload()}),a.clusterids=[{value:1,displayName:"1"},{value:2,displayName:"2"},{value:3,displayName:"3"},{value:4,displayName:"4"},{value:5,displayName:"5"},{value:6,displayName:"6"},{value:7,displayName:"7"},{value:8,displayName:"8"},{value:9,displayName:"9"},{value:10,displayName:"10"},{value:11,displayName:"11"},{value:12,displayName:"12"},{value:13,displayName:"13"},{value:14,displayName:"14"},{value:15,displayName:"15"},{value:16,displayName:"16"},{value:17,displayName:"Not Clustered"},{value:18,displayName:"All"}],a.cleanMergePaths=function(){NodeManagerMergePaths[SELECTED_MERGEPATHID]&&NodeManagerMergePaths[SELECTED_MERGEPATHID].clean()},a.resetMergePaths=function(){FRAME.value=0,PAGE_NUM.value=2,TWEEN.removeAll(),NodeManagerMergePaths[SELECTED_MERGEPATHID]&&NodeManagerMergePaths[SELECTED_MERGEPATHID].reset(),EdgeManagerMergePaths[SELECTED_MERGEPATHID]&&EdgeManagerMergePaths[SELECTED_MERGEPATHID].reset()},a.resetClusters=function(){FRAME.value=0,PAGE_NUM.value=1,a.meanAge.value=0,TWEEN.removeAll(),EdgeManagerCluster.reset(),NodeManagerCluster.reset(),a.setClusterID(SELECTED_CLUSTER),a.updateMeanAge()},a.setClusterID=function(e){return SELECTED_CLUSTER=e,e==NOT_CLUSTER_ID?(SELECTED_CLUSTER=NOT_CLUSTER_ID,t(),EdgeManagerCluster.toggleShowByCluster(NOT_CLUSTER_ID),void NodeManagerCluster.toggleShowByCluster(NOT_CLUSTER_ID)):e==ALL_CLUSTER_ID?(SELECTED_CLUSTER=ALL_CLUSTER_ID,t(),void s()):(t(),EdgeManagerCluster.toggleShowByCluster(SELECTED_CLUSTER),void NodeManagerCluster.toggleShowByCluster(SELECTED_CLUSTER))},a.updateMeanAge=function(){if(!(FRAME.value>620||1!=PAGE_NUM.value)){var e=mapRange([0,620],[35.4,90.5],FRAME.value);a.meanAge.value=Math.ceil(e),a.$apply(),requestAnimationFrame(a.updateMeanAge)}},r()}]),angular.module("app").config(["$routeProvider",function(e){e.when("/mergepaths",{templateUrl:"/templates/mergepaths.html",controller:"MergePathCtrl"}).when("/clusters",{templateUrl:"/templates/clusters.html",controller:"ClusterCtrl"}).when("/intro",{templateUrl:"/templates/intro.html",controller:"IntroCtrl"}).otherwise({redirectTo:"/intro"})}]),angular.module("app").controller("ClusterCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){PAGE_NUM.value=1,bCanvasLoaded&&$("#options-clusters").css("visibility","visible")}function s(){$(".data-visibility").addClass("active")}t(),a.selectedid={value:SELECTED_CLUSTER},s(),$("#btn-reset-clusters").click(function(){a.resetClusters()}),a.updateMeanAge(),$("#clusterid").change(function(){var e=$("#clusterid").val();SELECTED_CLUSTER=e,a.setClusterID(e)})}]),angular.module("app").controller("IntroCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){PAGE_NUM.value=0}function s(){$(".data-visibility").removeClass("active")}t(),s()}]),angular.module("app").controller("MergePathCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(e){return e.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function s(){PAGE_NUM.value=2,bCanvasLoaded&&$("#options-mergepaths").css("visibility","visible")}function r(){$(".data-visibility").addClass("active")}a.search="";var i;a.$watch("search",function(e){i=new RegExp("\\b"+t(e),"i"),setTimeout(function(){a.search=""},1e3)}),a.filterBySearch=function(e){return a.search?i.test(e):!1},a.runName=function(e){var l=e;a.search=l},s(),r(),$("#btn-reset-mergepaths").click(function(){a.resetMergePaths()}),$("#btn-run-mergepaths").click(function(){var e,l=document.getElementById("textinfo-mergepathids").value;try{var t=parseInt(l);if(isNaN(t))for(var s=l.toLowerCase(),r=0;r<MERGEPATH_INITNODE_REF.length;r++){var i=MERGEPATH_INITNODE_REF[r];if(i==s){e=r;break}}}catch(n){return void console.log(n)}a.cleanMergePaths(),SELECTED_MERGEPATHID=e,a.mergePathIds.value=MERGEPATH_INITNODE_REF[e],a.$apply(),a.resetMergePaths()})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJDb250cm9sbGVycy9jbHVzdGVyLmN0cmwuanMiLCJDb250cm9sbGVycy9pbnRyby5jdHJsLmpzIiwiQ29udHJvbGxlcnMvbWVyZ2VwYXRoLmN0cmwuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkcm9vdFNjb3BlIiwiJHNjb3BlIiwiJHdpbmRvdyIsImNsZWFyQWxsQ2x1c3RlcnMiLCJFZGdlTWFuYWdlckNsdXN0ZXIiLCJoaWRlQWxsIiwiTm9kZU1hbmFnZXJDbHVzdGVyIiwidmlld0FsbENsdXN0ZXJzIiwic2hvd0FsbCIsInNldERhdGFHdWlJbml0aWFsaXplIiwicmVuZGVyT3B0aW9uc1VJIiwidGhpcyIsIkFkZGl0aXZlQ29sb3IiLCJSZXN0YXJ0IiwibG9jYXRpb24iLCJyZWxvYWQiLCJIaWRlTm9kZXMiLCJIaWRlTmFtZXMiLCJEYXRhIiwiUkVOREVST1BUSU9OUyIsImd1aSIsImRhdCIsIkdVSSIsIkRhdGFUeXBlIiwiYWRkIiwib25GaW5pc2hDaGFuZ2UiLCJ2YWwiLCJkYXRhTWFuYWdlciIsInN0YXJ0IiwiY2x1c3RlcmlkcyIsInZhbHVlIiwiZGlzcGxheU5hbWUiLCJQQUdFX05VTSIsInJlc2V0Q2x1c3RlcnMiLCJyZXNldE1lcmdlUGF0aHMiLCJtZXJnZVBhdGhJZHMiLCIkYXBwbHkiLCJkaXNlYXNlcyIsInVuZGVmaW5lZCIsInNldEludGVydmFsIiwiTUVSR0VQQVRIX0lOSVROT0RFX1JFRiIsIm1lYW5BZ2UiLCJnZXRNZW51U2hvdyIsInNob3dfbWVudSIsIiQiLCJ3aW5kb3ciLCJyZXNpemUiLCJyZXNpemVUTyIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJ0cmlnZ2VyIiwiYmluZCIsImNsZWFuTWVyZ2VQYXRocyIsIk5vZGVNYW5hZ2VyTWVyZ2VQYXRocyIsIlNFTEVDVEVEX01FUkdFUEFUSElEIiwiY2xlYW4iLCJGUkFNRSIsIlRXRUVOIiwicmVtb3ZlQWxsIiwicmVzZXQiLCJFZGdlTWFuYWdlck1lcmdlUGF0aHMiLCJzZXRDbHVzdGVySUQiLCJTRUxFQ1RFRF9DTFVTVEVSIiwidXBkYXRlTWVhbkFnZSIsImNsdXN0ZXJpZCIsIk5PVF9DTFVTVEVSX0lEIiwidG9nZ2xlU2hvd0J5Q2x1c3RlciIsIkFMTF9DTFVTVEVSX0lEIiwibmV3TWVhbkFnZSIsIm1hcFJhbmdlIiwiTWF0aCIsImNlaWwiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJzZXRQYWdlTnVtIiwiYkNhbnZhc0xvYWRlZCIsImNzcyIsInNldFZpc2liaWxpdHkiLCJhZGRDbGFzcyIsInNlbGVjdGVkaWQiLCJjbGljayIsImNoYW5nZSIsInJlbW92ZUNsYXNzIiwiZXNjYXBlUmVnRXhwIiwic3RyaW5nIiwicmVwbGFjZSIsInNlYXJjaCIsInJlZ2V4IiwiJHdhdGNoIiwiUmVnRXhwIiwiZmlsdGVyQnlTZWFyY2giLCJuYW1lIiwidGVzdCIsInJ1bk5hbWUiLCJkaXNlYXNlIiwiaWQiLCJpbnB1dCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJtZXJnZVBhdGhJZCIsInBhcnNlSW50IiwiaXNOYU4iLCJsb3dlckNhc2VkRGlzZWFzZU5hbWUiLCJ0b0xvd2VyQ2FzZSIsImkiLCJsZW5ndGgiLCJlcnIiLCJjb25zb2xlIiwibG9nIl0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxPQUNBLFlDRkFELFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxtQkFBQSxhQUFBLFNBQUEsVUFBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQXVIQSxRQUFBQyxLQUVBQyxtQkFBQUMsVUFDQUMsbUJBQUFELFVBS0EsUUFBQUUsS0FFQUgsbUJBQUFJLFVBQ0FGLG1CQUFBRSxVQWNBLFFBQUFDLEtBRUEsR0FBQUMsR0FBQSxXQUVB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SUEvRixFQUFBaUcsUUFBQSxTQUFBQyxHQUVBLEdBQUFILEdBQUFHLENBRUFsRyxHQUFBMEYsT0FBQUssR0FZQWpCLElBT0FHLElBR0F0QyxFQUFBLHlCQUFBeUMsTUFBQSxXQUVBcEYsRUFBQWlDLG9CQUlBVSxFQUFBLHVCQUFBeUMsTUFBQSxXQUVBLEdBRUFlLEdBRkFDLEVBQUFDLFNBQUFDLGVBQUEseUJBQUF6RSxLQUtBLEtBRUEsR0FBQTBFLEdBQUFDLFNBQUFKLEVBQ0EsSUFBQUssTUFBQUYsR0FJQSxJQUFBLEdBRkFHLEdBQUFOLEVBQUFPLGNBRUFDLEVBQUEsRUFBQUEsRUFBQXJFLHVCQUFBc0UsT0FBQUQsSUFBQSxDQUVBLEdBQUFiLEdBQUF4RCx1QkFBQXFFLEVBRUEsSUFBQWIsR0FBQVcsRUFBQSxDQUVBUCxFQUFBUyxDQUVBLFNBUUEsTUFBQUUsR0FFQSxXQURBQyxTQUFBQyxJQUFBRixHQUlBOUcsRUFBQW1ELGtCQUVBRSxxQkFBQThDLEVBR0FuRyxFQUFBa0MsYUFBQUwsTUFBQVUsdUJBQUE0RCxHQUNBbkcsRUFBQW1DLFNBRUFuQyxFQUFBaUMiLCJmaWxlIjoiYXBwLmpzIiwic291cmNlc0NvbnRlbnQiOlsiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJywgW1xuXHQnbmdSb3V0ZScsXG5dKTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdyl7XG5cblx0JHNjb3BlLmRpc2Vhc2VzID0gdW5kZWZpbmVkOyAvLyB1c2VkIGZvciBzZWFyY2gga2V5d29yZHNcblx0c2V0SW50ZXJ2YWwoZnVuY3Rpb24oKXtcblx0ICAgICRzY29wZS5kaXNlYXNlcyA9IE1FUkdFUEFUSF9JTklUTk9ERV9SRUY7XG5cdCAgfSwgNTAwKTtcblxuXHQkc2NvcGUubWVhbkFnZSA9IHsgdmFsdWUgOiAwIH07XG5cdCRzY29wZS5tZXJnZVBhdGhJZHMgPSB7IHZhbHVlIDogXCJhY3V0ZSBteW9jYXJkaWFsIGluZmFyY3Rpb25cIn07XG5cblx0JHNjb3BlLmdldE1lbnVTaG93ID0gZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4gJHNjb3BlLnNob3dfbWVudTtcblx0fVxuXG5cdC8vIGFzIHJlc2l6ZSwgcmUtaW5pdCBkYXRhc1xuXHQkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uKCkge1xuICAgIGlmKHRoaXMucmVzaXplVE8pIGNsZWFyVGltZW91dCh0aGlzLnJlc2l6ZVRPKTtcblx0ICAgIHRoaXMucmVzaXplVE8gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICQodGhpcykudHJpZ2dlcigncmVzaXplRW5kJyk7XG5cdCAgICB9LCAyMDApO1xuXHR9KTtcblxuXHQkKHdpbmRvdykuYmluZCgncmVzaXplRW5kJywgZnVuY3Rpb24oKSB7XG5cdCAgICAvL2RvIHNvbWV0aGluZywgd2luZG93IGhhc24ndCBjaGFuZ2VkIHNpemUgaW4gNTAwbXNcblx0ICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xuXHR9KTtcblxuXHQkc2NvcGUuY2x1c3RlcmlkcyA9IFtcbiAgICAgIHt2YWx1ZTogMSwgZGlzcGxheU5hbWU6ICcxJ30sXG4gICAgICB7dmFsdWU6IDIsIGRpc3BsYXlOYW1lOiAnMid9LFxuICAgICAge3ZhbHVlOiAzLCBkaXNwbGF5TmFtZTogJzMnfSxcbiAgICAgIHt2YWx1ZTogNCwgZGlzcGxheU5hbWU6ICc0J30sXG4gICAgICB7dmFsdWU6IDUsIGRpc3BsYXlOYW1lOiAnNSd9LFxuICAgICAge3ZhbHVlOiA2LCBkaXNwbGF5TmFtZTogJzYnfSxcbiAgICAgIHt2YWx1ZTogNywgZGlzcGxheU5hbWU6ICc3J30sXG4gICAgICB7dmFsdWU6IDgsIGRpc3BsYXlOYW1lOiAnOCd9LFxuICAgICAge3ZhbHVlOiA5LCBkaXNwbGF5TmFtZTogJzknfSxcbiAgICAgIHt2YWx1ZTogMTAsIGRpc3BsYXlOYW1lOiAnMTAnfSxcbiAgICAgIHt2YWx1ZTogMTEsIGRpc3BsYXlOYW1lOiAnMTEnfSxcbiAgICAgIHt2YWx1ZTogMTIsIGRpc3BsYXlOYW1lOiAnMTInfSxcbiAgICAgIHt2YWx1ZTogMTMsIGRpc3BsYXlOYW1lOiAnMTMnfSxcbiAgICAgIHt2YWx1ZTogMTQsIGRpc3BsYXlOYW1lOiAnMTQnfSxcbiAgICAgIHt2YWx1ZTogMTUsIGRpc3BsYXlOYW1lOiAnMTUnfSxcbiAgICAgIHt2YWx1ZTogMTYsIGRpc3BsYXlOYW1lOiAnMTYnfSxcbiAgICAgIHt2YWx1ZTogMTcsIGRpc3BsYXlOYW1lOiAnTm90IENsdXN0ZXJlZCd9LFxuICAgICAge3ZhbHVlOiAxOCwgZGlzcGxheU5hbWU6ICdBbGwnfVxuICBcdF07XG5cblx0JHNjb3BlLmNsZWFuTWVyZ2VQYXRocyA9IGZ1bmN0aW9uKCl7XG5cblx0XHRpZiAoTm9kZU1hbmFnZXJNZXJnZVBhdGhzW1NFTEVDVEVEX01FUkdFUEFUSElEXSlcblx0XHRcdE5vZGVNYW5hZ2VyTWVyZ2VQYXRoc1tTRUxFQ1RFRF9NRVJHRVBBVEhJRF0uY2xlYW4oKTtcblxuXHR9XG5cblx0JHNjb3BlLnJlc2V0TWVyZ2VQYXRocyA9IGZ1bmN0aW9uKCl7XG5cdFx0RlJBTUUudmFsdWUgICAgPSAwO1xuXHRcdFBBR0VfTlVNLnZhbHVlID0gMjtcblxuXHRcdFRXRUVOLnJlbW92ZUFsbCgpOyAvLyByZXNldCB0d2VlbiBhbmltYXRpb25zXG5cblx0XHRpZiAoTm9kZU1hbmFnZXJNZXJnZVBhdGhzW1NFTEVDVEVEX01FUkdFUEFUSElEXSlcblx0XHRcdE5vZGVNYW5hZ2VyTWVyZ2VQYXRoc1tTRUxFQ1RFRF9NRVJHRVBBVEhJRF0ucmVzZXQoKTtcblx0XHRpZiAoRWRnZU1hbmFnZXJNZXJnZVBhdGhzW1NFTEVDVEVEX01FUkdFUEFUSElEXSlcblx0XHRcdEVkZ2VNYW5hZ2VyTWVyZ2VQYXRoc1tTRUxFQ1RFRF9NRVJHRVBBVEhJRF0ucmVzZXQoKTtcblxuXHR9XG5cblx0JHNjb3BlLnJlc2V0Q2x1c3RlcnMgPSBmdW5jdGlvbigpe1xuXG4gICAgICBcdEZSQU1FLnZhbHVlICAgID0gMDtcbiAgICAgIFx0UEFHRV9OVU0udmFsdWUgPSAxO1xuXG4gICAgICBcdCRzY29wZS5tZWFuQWdlLnZhbHVlID0gMDtcblxuICAgICAgXHRUV0VFTi5yZW1vdmVBbGwoKTsgLy8gcmVzZXQgdHdlZW4gYW5pbWF0aW9uc1xuXG4gICAgICBcdEVkZ2VNYW5hZ2VyQ2x1c3Rlci5yZXNldCgpO1xuICAgICAgXHROb2RlTWFuYWdlckNsdXN0ZXIucmVzZXQoKTtcblxuICAgICAgXHQkc2NvcGUuc2V0Q2x1c3RlcklEKFNFTEVDVEVEX0NMVVNURVIpO1xuXG4gICAgICBcdCRzY29wZS51cGRhdGVNZWFuQWdlKCk7XG5cdFxuXHR9XG5cblx0JHNjb3BlLnNldENsdXN0ZXJJRCA9IGZ1bmN0aW9uKGNsdXN0ZXJpZCl7XG5cblx0ICAgIFNFTEVDVEVEX0NMVVNURVIgPSBjbHVzdGVyaWQ7XG5cblx0ICAgIGlmIChjbHVzdGVyaWQgPT0gTk9UX0NMVVNURVJfSUQpe1xuXG5cdCAgICAgICAgU0VMRUNURURfQ0xVU1RFUiA9IE5PVF9DTFVTVEVSX0lEO1xuXHQgICAgICAgIFxuXHQgICAgICAgIGNsZWFyQWxsQ2x1c3RlcnMoKTtcblx0ICAgICAgICBFZGdlTWFuYWdlckNsdXN0ZXIudG9nZ2xlU2hvd0J5Q2x1c3RlcihOT1RfQ0xVU1RFUl9JRCk7XG5cdCAgICAgICAgTm9kZU1hbmFnZXJDbHVzdGVyLnRvZ2dsZVNob3dCeUNsdXN0ZXIoTk9UX0NMVVNURVJfSUQpO1xuXG5cdCAgICAgICAgcmV0dXJuO1xuXG5cdCAgICB9XG5cblx0ICAgIGlmIChjbHVzdGVyaWQgPT0gQUxMX0NMVVNURVJfSUQpe1xuXG5cdCAgICBcdFNFTEVDVEVEX0NMVVNURVIgPSBBTExfQ0xVU1RFUl9JRDtcblxuXHQgICAgXHRjbGVhckFsbENsdXN0ZXJzKCk7XG5cdCAgICAgICAgdmlld0FsbENsdXN0ZXJzKCk7IFxuXG5cdCAgICAgICAgcmV0dXJuOyBcblxuXHQgICAgfVxuXG5cdCAgICBjbGVhckFsbENsdXN0ZXJzKCk7XG5cdCAgICBFZGdlTWFuYWdlckNsdXN0ZXIudG9nZ2xlU2hvd0J5Q2x1c3RlcihTRUxFQ1RFRF9DTFVTVEVSKTtcblx0ICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci50b2dnbGVTaG93QnlDbHVzdGVyKFNFTEVDVEVEX0NMVVNURVIpO1xuXHR9XG5cblx0Ly8gY2xlYXIgYWxsIGNsdXN0ZXJzXG4gIFx0ZnVuY3Rpb24gY2xlYXJBbGxDbHVzdGVycygpeyAvLyDsp4DquIgg7J206rKMIGdsb2JhbOuhnCDsoJXsnZjrkJwg6rKD7J24642wLCDslYTrp4jrj4Qg7YG066Gc7KWs7Ja0IOyViOyXkCDrhKPslrTshJwsIOydtCDtjIzsnbwg7JWI7JeQ7ISc66eMIOqwgOuKpe2VnCBsb2NhbCBzcGFjZeuhnCDsmK7qsqjslbwg7ZWg65Ov7Iu264ukLlxuXG4gICAgICBcdEVkZ2VNYW5hZ2VyQ2x1c3Rlci5oaWRlQWxsKCk7XG4gICAgICBcdE5vZGVNYW5hZ2VyQ2x1c3Rlci5oaWRlQWxsKCk7XG5cblx0fVxuXG5cdC8vIGNsZWFyIGFsbCBjbHVzdGVyc1xuXHRmdW5jdGlvbiB2aWV3QWxsQ2x1c3RlcnMoKXtcblxuXHQgICAgRWRnZU1hbmFnZXJDbHVzdGVyLnNob3dBbGwoKTtcblx0ICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci5zaG93QWxsKCk7XG5cblx0fVxuXG5cdCRzY29wZS51cGRhdGVNZWFuQWdlID0gZnVuY3Rpb24oKXtcblx0ICAgIGlmIChGUkFNRS52YWx1ZSA+IDYyMCB8fCBQQUdFX05VTS52YWx1ZSAhPSAxKVxuXHQgICAgICByZXR1cm47XG5cblx0ICAgIHZhciBuZXdNZWFuQWdlID0gbWFwUmFuZ2UoWzAsIDYyMC4wXSwgWzM1LjQsIDkwLjVdLCBGUkFNRS52YWx1ZSk7XG5cdCAgICAkc2NvcGUubWVhbkFnZS52YWx1ZSA9IE1hdGguY2VpbChuZXdNZWFuQWdlKTtcblx0ICAgICRzY29wZS4kYXBwbHkoKTtcblx0ICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgkc2NvcGUudXBkYXRlTWVhbkFnZSk7XG5cdH1cblxuXHRmdW5jdGlvbiBzZXREYXRhR3VpSW5pdGlhbGl6ZSgpe1xuXG5cdCAgICB2YXIgcmVuZGVyT3B0aW9uc1VJID0gZnVuY3Rpb24oKSB7XG5cblx0ICAgICAgdGhpcy5BZGRpdGl2ZUNvbG9yID0gdHJ1ZTtcblxuXHQgICAgICB0aGlzLlJlc3RhcnQgPSBmdW5jdGlvbigpIHsgXG5cblx0ICAgICAgXHQgLy8gcmVzdGFydCB0aGUgcGFnZVxuXHQgICAgICBcdCBsb2NhdGlvbi5yZWxvYWQoKTtcblxuXHQgICAgICB9O1xuXG5cdCAgICAgIHRoaXMuSGlkZU5vZGVzID0gZmFsc2U7XG5cblx0ICAgICAgdGhpcy5IaWRlTmFtZXMgPSBmYWxzZTtcblxuXHQgICAgICB0aGlzLkRhdGEgICAgICA9ICdVUyc7XG5cdCAgICB9O1xuXG5cdCAgICBSRU5ERVJPUFRJT05TIFx0PSBuZXcgcmVuZGVyT3B0aW9uc1VJKCk7XG5cdCAgICB2YXIgZ3VpICBcdFx0PSBuZXcgZGF0LkdVSSgpO1xuXG5cdCAgICB2YXIgRGF0YVR5cGUgICAgICAgICA9IGd1aS5hZGQoUkVOREVST1BUSU9OUywgJ0RhdGEnLCBbICdVUycsICdLT1InIF0gKTtcblxuXHQgICAgLypcblx0ICAgIHZhciBDbHVzdGVyc0dycCAgICAgID0gZ3VpLmFkZEZvbGRlcignQ2x1c3RlcnMnKTtcblx0XHR2YXIgQ2x1c3RlckhpZGVOb2RlcyAgID0gQ2x1c3RlcnNHcnAuYWRkKFJFTkRFUk9QVElPTlMsICdIaWRlTm9kZXMnKTtcblx0XHR2YXIgQ2x1c3RlckhpZGVOYW1lcyAgID0gQ2x1c3RlcnNHcnAuYWRkKFJFTkRFUk9QVElPTlMsICdIaWRlTmFtZXMnKTtcblxuXHRcdHZhciBNZXJnZVBhdGhHcnAgICAgICAgPSBndWkuYWRkRm9sZGVyKCdNZXJnZVBhdGhzJyk7XG5cdFx0dmFyIE1lcmdlUGF0aEhpZGVOb2RlcyA9IE1lcmdlUGF0aEdycC5hZGQoUkVOREVST1BUSU9OUywgJ0hpZGVOb2RlcycpO1xuXHRcdHZhciBNZXJnZVBhdGhIaWRlTmFtZXMgPSBNZXJnZVBhdGhHcnAuYWRkKFJFTkRFUk9QVElPTlMsICdIaWRlTmFtZXMnKTtcblx0XHQqL1xuXG5cdFx0RGF0YVR5cGUub25GaW5pc2hDaGFuZ2UoZnVuY3Rpb24odmFsKSB7XG5cdFx0XHRpZiAodmFsID09ICdVUycpe1xuXG5cdFx0XHRcdGRhdGFNYW5hZ2VyLnN0YXJ0KCdVUycpO1xuXHRcdFx0XHQkc2NvcGUuY2x1c3RlcmlkcyA9IFtcblx0XHRcdCAgICAgIHt2YWx1ZTogMSwgZGlzcGxheU5hbWU6ICcxJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDIsIGRpc3BsYXlOYW1lOiAnMid9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiAzLCBkaXNwbGF5TmFtZTogJzMnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogNCwgZGlzcGxheU5hbWU6ICc0J30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDUsIGRpc3BsYXlOYW1lOiAnNSd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiA2LCBkaXNwbGF5TmFtZTogJzYnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogNywgZGlzcGxheU5hbWU6ICc3J30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDgsIGRpc3BsYXlOYW1lOiAnOCd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiA5LCBkaXNwbGF5TmFtZTogJzknfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTAsIGRpc3BsYXlOYW1lOiAnMTAnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTEsIGRpc3BsYXlOYW1lOiAnMTEnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTIsIGRpc3BsYXlOYW1lOiAnMTInfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTMsIGRpc3BsYXlOYW1lOiAnMTMnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTQsIGRpc3BsYXlOYW1lOiAnMTQnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTUsIGRpc3BsYXlOYW1lOiAnMTUnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTYsIGRpc3BsYXlOYW1lOiAnMTYnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTcsIGRpc3BsYXlOYW1lOiAnTm90IENsdXN0ZXJlZCd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiAxOCwgZGlzcGxheU5hbWU6ICdBbGwnfVxuXHRcdFx0ICBcdF07XG5cdFx0XHQgIFx0aWYgKFBBR0VfTlVNLnZhbHVlID09IDEpIHtcblx0XHRcdCAgXHRcdCRzY29wZS5yZXNldENsdXN0ZXJzKCk7XG5cdFx0XHQgIFx0fVxuXHRcdFx0ICBcdGVsc2UgaWYgKFBBR0VfTlVNLnZhbHVlID09IDIpe1xuXHRcdFx0ICBcdFx0JHNjb3BlLnJlc2V0TWVyZ2VQYXRocygpO1xuXHRcdFx0ICBcdH1cblx0XHRcdCAgXHQkc2NvcGUubWVyZ2VQYXRoSWRzLnZhbHVlICA9IFwiYWN1dGUgbXlvY2FyZGlhbCBpbmZhcmN0aW9uXCI7XG5cdFx0XHQgIFx0JHNjb3BlLiRhcHBseSgpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiAodmFsID09ICdLT1InKXtcblx0XHRcdFx0ZGF0YU1hbmFnZXIuc3RhcnQoJ0tPUicpO1xuXHRcdFx0XHQkc2NvcGUuY2x1c3RlcmlkcyA9IFtcblx0XHRcdCAgICAgIHt2YWx1ZTogMCwgZGlzcGxheU5hbWU6ICcwJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDEsIGRpc3BsYXlOYW1lOiAnMSd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiAyLCBkaXNwbGF5TmFtZTogJzInfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMywgZGlzcGxheU5hbWU6ICdOb3QgQ2x1c3RlcmVkJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDQsIGRpc3BsYXlOYW1lOiAnQWxsJ31cblx0XHRcdCAgXHRdO1xuXHRcdFx0ICBcdGlmIChQQUdFX05VTS52YWx1ZSA9PSAxKXtcblx0XHRcdCAgXHRcdCRzY29wZS5yZXNldENsdXN0ZXJzKCk7XG5cdFx0XHQgIFx0fVxuXHRcdFx0ICBcdGVsc2UgaWYgKFBBR0VfTlVNLnZhbHVlID09IDIpe1xuXHRcdFx0ICBcdFx0JHNjb3BlLnJlc2V0TWVyZ2VQYXRocygpOyAgXG5cdFx0XHQgIFx0fVxuXHRcdFx0ICBcdCRzY29wZS5tZXJnZVBhdGhJZHMudmFsdWUgID0gXCJjaHJvbmljIHZpcmFsIGhlcGF0aXRpc1wiO1xuXHRcdFx0ICBcdCRzY29wZS4kYXBwbHkoKTtcblx0XHRcdH1cblxuXHRcdFx0Ly8gc2VhcmNoIGtleXdvcmQgaGVscCB3b3JkcyBzZXR1cFxuXHRcdFx0XG5cdFx0fSlcblxuXHRcdC8qXG5cdCAgICBDbHVzdGVySGlkZU5vZGVzLm9uRmluaXNoQ2hhbmdlKGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgXHRpZiAodmFsID09IHRydWUpIHtcblx0XHQgICAgICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci50b2dnbGVOb2RlVmlzaWJpbGl0eUJ5Q2x1c3RlcihmYWxzZSk7XG5cdCAgICBcdH1cblx0ICAgIFx0ZWxzZSB7XG5cdFx0ICAgICAgICBOb2RlTWFuYWdlckNsdXN0ZXIudG9nZ2xlTm9kZVZpc2liaWxpdHlCeUNsdXN0ZXIodHJ1ZSk7XG5cdCAgICBcdH1cblx0ICAgIH0pO1xuXG5cdCAgICBDbHVzdGVySGlkZU5hbWVzLm9uRmluaXNoQ2hhbmdlKGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgXHRpZiAodmFsID09IHRydWUpIHtcblx0XHQgICAgICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci50b2dnbGVOb2RlVGV4dFZpc2liaWxpdHlCeUNsdXN0ZXIoZmFsc2UpO1xuXHQgICAgXHR9XG5cdCAgICBcdGVsc2Uge1xuXHRcdCAgICAgICAgTm9kZU1hbmFnZXJDbHVzdGVyLnRvZ2dsZU5vZGVUZXh0VmlzaWJpbGl0eUJ5Q2x1c3Rlcih0cnVlKTtcblx0ICAgIFx0fVxuXHQgICAgfSk7XG5cblx0ICAgXHRNZXJnZVBhdGhIaWRlTm9kZXMub25GaW5pc2hDaGFuZ2UoZnVuY3Rpb24odmFsKSB7XG5cdCAgICBcdGlmICh2YWwgPT0gdHJ1ZSkge1xuXG5cdFx0ICAgICAgICBOb2RlTWFuYWdlck1lcmdlUGF0aHNbU0VMRUNURURfTUVSR0VQQVRISURdLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KGZhbHNlKTtcblxuXHQgICAgXHR9XG5cdCAgICBcdGVsc2Uge1xuXG5cdFx0ICAgICAgICBOb2RlTWFuYWdlck1lcmdlUGF0aHNbU0VMRUNURURfTUVSR0VQQVRISURdLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KHRydWUpO1xuXG5cdFx0ICAgIH1cblx0ICAgIH0pO1xuXG5cdCAgICBNZXJnZVBhdGhIaWRlTmFtZXMub25GaW5pc2hDaGFuZ2UoZnVuY3Rpb24odmFsKSB7XG5cdCAgICBcdGlmICh2YWwgPT0gdHJ1ZSkge1xuXG5cdFx0ICAgICAgICBOb2RlTWFuYWdlck1lcmdlUGF0aHNbU0VMRUNURURfTUVSR0VQQVRISURdLnRvZ2dsZU5vZGVUZXh0VmlzaWJpbGl0eShmYWxzZSk7XG5cblx0ICAgIFx0fVxuXHQgICAgXHRlbHNlIHtcblxuXHRcdCAgICAgICAgTm9kZU1hbmFnZXJNZXJnZVBhdGhzW1NFTEVDVEVEX01FUkdFUEFUSElEXS50b2dnbGVOb2RlVGV4dFZpc2liaWxpdHkodHJ1ZSk7XG5cblx0ICAgIFx0fVxuXHQgICAgfSk7XG5cdCAgICAqL1xuXG5cdCAgICBndWkuYWRkKFJFTkRFUk9QVElPTlMsICdSZXN0YXJ0Jyk7XG5cblx0ICAgIC8vJChndWkuZG9tRWxlbWVudCkuZmluZChcIj51bFwiKS50b2dnbGVDbGFzcyhcImNsb3NlZFwiKTsgLy8gZGF0Lmd1aSBkZWZhdWx0IHRvIGJlIGNsb3NlZFxuXG5cdH1cbiAgXHRzZXREYXRhR3VpSW5pdGlhbGl6ZSgpO1xufSk7IiwiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKXtcblx0JHJvdXRlUHJvdmlkZXJcblx0LndoZW4oJy9tZXJnZXBhdGhzJywgXG5cdFx0e1xuXHRcdFx0dGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL21lcmdlcGF0aHMuaHRtbCcsXG5cdFx0XHRjb250cm9sbGVyOiAnTWVyZ2VQYXRoQ3RybCdcblx0XHR9KVxuXHQud2hlbignL2NsdXN0ZXJzJywgXG5cdFx0e1xuXHRcdFx0dGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL2NsdXN0ZXJzLmh0bWwnLFxuXHRcdFx0Y29udHJvbGxlcjogJ0NsdXN0ZXJDdHJsJ1xuXHRcdH0pXG5cdC53aGVuKCcvaW50cm8nLCBcblx0XHR7XG5cdFx0XHR0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvaW50cm8uaHRtbCcsXG5cdFx0XHRjb250cm9sbGVyOiAnSW50cm9DdHJsJ1xuXHRcdH0pXG5cdC5vdGhlcndpc2UoXG5cdFx0e1xuICAgXHRcdFx0cmVkaXJlY3RUbzogJy9pbnRybydcblx0XHR9KTtcblxufSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdDbHVzdGVyQ3RybCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdyl7XG5cbiAgZnVuY3Rpb24gc2V0UGFnZU51bSgpe1xuICAgIFBBR0VfTlVNLnZhbHVlID0gMTsgLy8gMSAtIGNsdXN0ZXJcblxuICAgIGlmIChiQ2FudmFzTG9hZGVkKVxuICAgICAgJCgnI29wdGlvbnMtY2x1c3RlcnMnKS5jc3MoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpO1xuICB9XG4gIHNldFBhZ2VOdW0oKTtcblxuICAkc2NvcGUuc2VsZWN0ZWRpZCA9IHsgdmFsdWUgOiBTRUxFQ1RFRF9DTFVTVEVSIH07XG5cblxuICBmdW5jdGlvbiBzZXRWaXNpYmlsaXR5KCl7XG4gICAgJCgnLmRhdGEtdmlzaWJpbGl0eScpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgfVxuICBzZXRWaXNpYmlsaXR5KCk7XG5cbiAgLy8gcmVzZXQgYW5pbWF0aW9uLlxuICAkKCcjYnRuLXJlc2V0LWNsdXN0ZXJzJykuY2xpY2soZnVuY3Rpb24oKSB7XG5cbiAgICAkc2NvcGUucmVzZXRDbHVzdGVycygpO1xuXG4gIH0pO1xuXG4gICRzY29wZS51cGRhdGVNZWFuQWdlKCk7XG5cbiAgJCgnI2NsdXN0ZXJpZCcpLmNoYW5nZShmdW5jdGlvbigpe1xuXG4gICAgdmFyIGNsdXN0ZXJpZCA9ICQoJyNjbHVzdGVyaWQnKS52YWwoKTtcblxuICAgIFNFTEVDVEVEX0NMVVNURVIgPSBjbHVzdGVyaWQ7XG5cbiAgICAkc2NvcGUuc2V0Q2x1c3RlcklEKGNsdXN0ZXJpZCk7XG5cbiAgfSlcblxuXG59KTsiLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdJbnRyb0N0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICR3aW5kb3cpe1xuXG5cdGZ1bmN0aW9uIHNldFBhZ2VOdW0oKXtcbiAgICBcdFBBR0VfTlVNLnZhbHVlID0gMDtcbiAgXHR9XG4gIFx0c2V0UGFnZU51bSgpO1xuXG5cdGZ1bmN0aW9uIHNldFZpc2liaWxpdHkoKXtcblx0XHQkKCcuZGF0YS12aXNpYmlsaXR5JykucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpO1xuXHR9XG5cdHNldFZpc2liaWxpdHkoKTtcblxufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignTWVyZ2VQYXRoQ3RybCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdyl7XG5cbiAgLyogU0VBUkNIIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXG5cbiAgZnVuY3Rpb24gZXNjYXBlUmVnRXhwKHN0cmluZyl7XG4gICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC8oWy4qKz9ePSE6JHt9KCl8XFxbXFxdXFwvXFxcXF0pL2csIFwiXFxcXCQxXCIpO1xuICB9XG5cbiAgLy9jb25zb2xlLmxvZyhNRVJHRVBBVEhfSU5JVE5PREVfUkVGKTtcblxuXG4gICRzY29wZS5zZWFyY2ggPSAnJztcbiAgXG4gIHZhciByZWdleDtcblxuICAkc2NvcGUuJHdhdGNoKCdzZWFyY2gnLCBmdW5jdGlvbiAodmFsdWUpIHtcbiAgICByZWdleCA9IG5ldyBSZWdFeHAoJ1xcXFxiJyArIGVzY2FwZVJlZ0V4cCh2YWx1ZSksICdpJyk7XG5cbiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7JHNjb3BlLnNlYXJjaCA9ICcnO30sIDEwMDApO1xuICB9KTtcbiAgICBcbiAgJHNjb3BlLmZpbHRlckJ5U2VhcmNoID0gZnVuY3Rpb24obmFtZSkge1xuICAgICAgaWYgKCEkc2NvcGUuc2VhcmNoKSByZXR1cm4gZmFsc2U7XG4gICAgICByZXR1cm4gcmVnZXgudGVzdChuYW1lKTtcbiAgfTtcblxuICAkc2NvcGUucnVuTmFtZSA9IGZ1bmN0aW9uKGRpc2Vhc2Upe1xuICAgIC8vY29uc29sZS5sb2coJ2luIGRpc2Vhc2U6JywgZGlzZWFzZSk7XG4gICAgdmFyIG5hbWUgPSBkaXNlYXNlO1xuICAgIC8vZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0ZXh0aW5mby1tZXJnZXBhdGhpZHNcIikudmFsdWUgPSBuYW1lO1xuICAgICRzY29wZS5zZWFyY2ggPSBuYW1lO1xuICB9XG5cbiAgLyogRU5EIE9GIFNFQVJDSCAtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xuXG4gIGZ1bmN0aW9uIHNldFBhZ2VOdW0oKXtcblxuICAgIFBBR0VfTlVNLnZhbHVlID0gMjtcbiAgICBpZiAoYkNhbnZhc0xvYWRlZClcbiAgICAgICQoJyNvcHRpb25zLW1lcmdlcGF0aHMnKS5jc3MoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpO1xuXG4gIH1cbiAgc2V0UGFnZU51bSgpO1xuXG4gIGZ1bmN0aW9uIHNldFZpc2liaWxpdHkoKXtcblxuICAgICQoJy5kYXRhLXZpc2liaWxpdHknKS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgfVxuICBzZXRWaXNpYmlsaXR5KCk7XG5cbiAgLy8gcmVzZXQgYW5pbWF0aW9uLlxuICAkKCcjYnRuLXJlc2V0LW1lcmdlcGF0aHMnKS5jbGljayhmdW5jdGlvbigpIHtcblxuICAgICRzY29wZS5yZXNldE1lcmdlUGF0aHMoKTsgXG5cbiAgfSk7XG5cbiAgJCgnI2J0bi1ydW4tbWVyZ2VwYXRocycpLmNsaWNrKGZ1bmN0aW9uKCkge1xuXG4gICAgdmFyIGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0ZXh0aW5mby1tZXJnZXBhdGhpZHNcIikudmFsdWU7XG5cbiAgICB2YXIgaWQ7XG5cbiAgICAvLyBkZWFsIHdpdGggaW5wdXQgdG8gZmluZCBtZXJnZXBhdGghXG4gICAgdHJ5IHtcblxuICAgICAgdmFyIG1lcmdlUGF0aElkID0gcGFyc2VJbnQoaW5wdXQpO1xuICAgICAgaWYgKGlzTmFOKG1lcmdlUGF0aElkKSl7XG5cbiAgICAgICAgdmFyIGxvd2VyQ2FzZWREaXNlYXNlTmFtZSA9IGlucHV0LnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBNRVJHRVBBVEhfSU5JVE5PREVfUkVGLmxlbmd0aDsgaSsrKXtcblxuICAgICAgICAgIHZhciBuYW1lID0gTUVSR0VQQVRIX0lOSVROT0RFX1JFRltpXTtcblxuICAgICAgICAgIGlmIChuYW1lID09IGxvd2VyQ2FzZWREaXNlYXNlTmFtZSl7XG5cbiAgICAgICAgICAgIGlkID0gaTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ3NlbGVjdGVkIGRpc2Vhc2UgZm9yJywgbG93ZXJDYXNlZERpc2Vhc2VOYW1lLCAnIGlzIGlkOicsIGkpO1xuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgICB9IFxuXG4gICAgICAgIH1cblxuICAgICAgfVxuICAgIH1cbiAgICBjYXRjaChlcnIpIHtcbiAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgJHNjb3BlLmNsZWFuTWVyZ2VQYXRocygpO1xuXG4gICAgU0VMRUNURURfTUVSR0VQQVRISUQgPSBpZDtcblxuICAgIC8vIHNldCB0aGUgbmFtZSBvZiBpdFxuICAgICRzY29wZS5tZXJnZVBhdGhJZHMudmFsdWUgPSBNRVJHRVBBVEhfSU5JVE5PREVfUkVGW2lkXTtcbiAgICAkc2NvcGUuJGFwcGx5KCk7XG5cbiAgICAkc2NvcGUucmVzZXRNZXJnZVBhdGhzKCk7XG5cbiAgfSlcblxufSk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9