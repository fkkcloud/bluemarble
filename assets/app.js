angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){for(var e=0;18>e;e++)EdgeManagerCluster.hideAll(),NodeManagerCluster.hideAll()}function s(){for(var e=0;18>e;e++)EdgeManagerCluster.showAll(),NodeManagerCluster.showAll()}function i(){var e=function(){this.AdditiveColor=!0,this.Restart=function(){location.reload()},this.HideNodes=!1,this.HideNames=!1,this.Data="US"};RENDEROPTIONS=new e;var l=new dat.GUI,t=l.add(RENDEROPTIONS,"Data",["US","KOR"]),s=l.addFolder("Clusters"),i=s.add(RENDEROPTIONS,"HideNodes"),r=s.add(RENDEROPTIONS,"HideNames"),n=l.addFolder("MergePaths"),o=n.add(RENDEROPTIONS,"HideNodes"),u=n.add(RENDEROPTIONS,"HideNames");t.onFinishChange(function(e){"US"==e?(dataManager.start("US"),a.clusterids=[{value:1,displayName:"1"},{value:2,displayName:"2"},{value:3,displayName:"3"},{value:4,displayName:"4"},{value:5,displayName:"5"},{value:6,displayName:"6"},{value:7,displayName:"7"},{value:8,displayName:"8"},{value:9,displayName:"9"},{value:10,displayName:"10"},{value:11,displayName:"11"},{value:12,displayName:"12"},{value:13,displayName:"13"},{value:14,displayName:"14"},{value:15,displayName:"15"},{value:16,displayName:"16"},{value:17,displayName:"Not Clustered"},{value:18,displayName:"All"}],1==PAGE_NUM.value?a.resetClusters():2==PAGE_NUM.value&&a.resetMergePaths(),a.mergePathIds.value="acute myocardial infarction",a.$apply()):"KOR"==e&&(dataManager.start("KOR"),a.clusterids=[{value:0,displayName:"0"},{value:1,displayName:"1"},{value:2,displayName:"2"},{value:3,displayName:"Not Clustered"},{value:4,displayName:"All"}],1==PAGE_NUM.value?a.resetClusters():2==PAGE_NUM.value&&a.resetMergePaths(),a.mergePathIds.value="chronic viral hepatitis",a.$apply())}),i.onFinishChange(function(e){NodeManagerCluster.toggleNodeVisibilityByCluster(1==e?!1:!0)}),r.onFinishChange(function(e){NodeManagerCluster.toggleNodeTextVisibilityByCluster(1==e?!1:!0)}),o.onFinishChange(function(e){NodeManagerMergePaths[SELECTED_MERGEPATHID].toggleNodeVisibility(1==e?!1:!0)}),u.onFinishChange(function(e){NodeManagerMergePaths[SELECTED_MERGEPATHID].toggleNodeTextVisibility(1==e?!1:!0)}),l.add(RENDEROPTIONS,"Restart")}a.meanAge={value:0},a.mergePathIds={value:"acute myocardial infarction"},a.getMenuShow=function(){return a.show_menu},$(window).resize(function(){this.resizeTO&&clearTimeout(this.resizeTO),this.resizeTO=setTimeout(function(){$(this).trigger("resizeEnd")},200)}),$(window).bind("resizeEnd",function(){location.reload()}),a.clusterids=[{value:1,displayName:"1"},{value:2,displayName:"2"},{value:3,displayName:"3"},{value:4,displayName:"4"},{value:5,displayName:"5"},{value:6,displayName:"6"},{value:7,displayName:"7"},{value:8,displayName:"8"},{value:9,displayName:"9"},{value:10,displayName:"10"},{value:11,displayName:"11"},{value:12,displayName:"12"},{value:13,displayName:"13"},{value:14,displayName:"14"},{value:15,displayName:"15"},{value:16,displayName:"16"},{value:17,displayName:"Not Clustered"},{value:18,displayName:"All"}],a.cleanMergePaths=function(){NodeManagerMergePaths[SELECTED_MERGEPATHID].clean()},a.resetMergePaths=function(){FRAME.value=0,PAGE_NUM.value=2,TWEEN.removeAll(),NodeManagerMergePaths[SELECTED_MERGEPATHID].reset(),EdgeManagerMergePaths[SELECTED_MERGEPATHID].reset()},a.resetClusters=function(){FRAME.value=0,PAGE_NUM.value=1,a.meanAge.value=0,TWEEN.removeAll(),EdgeManagerCluster.reset(),NodeManagerCluster.reset(),a.setClusterID(SELECTED_CLUSTER),a.updateMeanAge()},a.setClusterID=function(e){return SELECTED_CLUSTER=e,e==NOT_CLUSTER_ID?(SELECTED_CLUSTER=NOT_CLUSTER_ID,t(),EdgeManagerCluster.toggleShowByCluster(NOT_CLUSTER_ID),void NodeManagerCluster.toggleShowByCluster(NOT_CLUSTER_ID)):e==ALL_CLUSTER_ID?void s():(t(),EdgeManagerCluster.toggleShowByCluster(SELECTED_CLUSTER),void NodeManagerCluster.toggleShowByCluster(SELECTED_CLUSTER))},a.updateMeanAge=function(){if(!(FRAME.value>620||1!=PAGE_NUM.value)){var e=mapRange([0,620],[35.4,90.5],FRAME.value);a.meanAge.value=Math.ceil(e),a.$apply(),requestAnimationFrame(a.updateMeanAge)}},i()}]),angular.module("app").config(["$routeProvider",function(e){e.when("/mergepaths",{templateUrl:"/templates/mergepaths.html",controller:"MergePathCtrl"}).when("/clusters",{templateUrl:"/templates/clusters.html",controller:"ClusterCtrl"}).when("/intro",{templateUrl:"/templates/intro.html",controller:"IntroCtrl"}).otherwise({redirectTo:"/intro"})}]),angular.module("app").controller("ClusterCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){PAGE_NUM.value=1,bCanvasLoaded&&$("#options-clusters").css("visibility","visible")}function s(){$(".data-visibility").addClass("active")}t(),a.selectedid={value:SELECTED_CLUSTER},s(),$("#btn-reset-clusters").click(function(){a.resetClusters()}),a.updateMeanAge(),$("#clusterid").change(function(){var e=$("#clusterid").val();SELECTED_CLUSTER=e,a.setClusterID(e)})}]),angular.module("app").controller("IntroCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){PAGE_NUM.value=0}function s(){$(".data-visibility").removeClass("active")}t(),s()}]),angular.module("app").controller("MergePathCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){PAGE_NUM.value=2,bCanvasLoaded&&$("#options-mergepaths").css("visibility","visible")}function s(){$(".data-visibility").addClass("active")}t(),s(),$("#btn-reset-mergepaths").click(function(){a.resetMergePaths()}),$("#btn-run-mergepaths").click(function(){var e=document.getElementById("textinfo-mergepathids").value;try{var l=parseInt(e);if(isNaN(l))for(var t=e.toLowerCase(),s=0;s<MERGEPATH_INITNODE_REF.length;s++){var i=MERGEPATH_INITNODE_REF[s];if(i==t){e=s,console.log("selected disease for",t," is id:",s);break}}}catch(r){return void console.log(r)}a.cleanMergePaths(),SELECTED_MERGEPATHID=e,console.log(e),a.mergePathIds.value=MERGEPATH_INITNODE_REF[e],a.$apply(),a.resetMergePaths()})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJDb250cm9sbGVycy9jbHVzdGVyLmN0cmwuanMiLCJDb250cm9sbGVycy9pbnRyby5jdHJsLmpzIiwiQ29udHJvbGxlcnMvbWVyZ2VwYXRoLmN0cmwuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkcm9vdFNjb3BlIiwiJHNjb3BlIiwiJHdpbmRvdyIsImNsZWFyQWxsQ2x1c3RlcnMiLCJpIiwiRWRnZU1hbmFnZXJDbHVzdGVyIiwiaGlkZUFsbCIsIk5vZGVNYW5hZ2VyQ2x1c3RlciIsInZpZXdBbGxDbHVzdGVycyIsInNob3dBbGwiLCJzZXREYXRhR3VpSW5pdGlhbGl6ZSIsInJlbmRlck9wdGlvbnNVSSIsInRoaXMiLCJBZGRpdGl2ZUNvbG9yIiwiUmVzdGFydCIsImxvY2F0aW9uIiwicmVsb2FkIiwiSGlkZU5vZGVzIiwiSGlkZU5hbWVzIiwiRGF0YSIsIlJFTkRFUk9QVElPTlMiLCJndWkiLCJkYXQiLCJHVUkiLCJEYXRhVHlwZSIsImFkZCIsIkNsdXN0ZXJzR3JwIiwiYWRkRm9sZGVyIiwiQ2x1c3RlckhpZGVOb2RlcyIsIkNsdXN0ZXJIaWRlTmFtZXMiLCJNZXJnZVBhdGhHcnAiLCJNZXJnZVBhdGhIaWRlTm9kZXMiLCJNZXJnZVBhdGhIaWRlTmFtZXMiLCJvbkZpbmlzaENoYW5nZSIsInZhbCIsImRhdGFNYW5hZ2VyIiwic3RhcnQiLCJjbHVzdGVyaWRzIiwidmFsdWUiLCJkaXNwbGF5TmFtZSIsIlBBR0VfTlVNIiwicmVzZXRDbHVzdGVycyIsInJlc2V0TWVyZ2VQYXRocyIsIm1lcmdlUGF0aElkcyIsIiRhcHBseSIsInRvZ2dsZU5vZGVWaXNpYmlsaXR5QnlDbHVzdGVyIiwidG9nZ2xlTm9kZVRleHRWaXNpYmlsaXR5QnlDbHVzdGVyIiwiTm9kZU1hbmFnZXJNZXJnZVBhdGhzIiwiU0VMRUNURURfTUVSR0VQQVRISUQiLCJ0b2dnbGVOb2RlVmlzaWJpbGl0eSIsInRvZ2dsZU5vZGVUZXh0VmlzaWJpbGl0eSIsIm1lYW5BZ2UiLCJnZXRNZW51U2hvdyIsInNob3dfbWVudSIsIiQiLCJ3aW5kb3ciLCJyZXNpemUiLCJyZXNpemVUTyIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJ0cmlnZ2VyIiwiYmluZCIsImNsZWFuTWVyZ2VQYXRocyIsImNsZWFuIiwiRlJBTUUiLCJUV0VFTiIsInJlbW92ZUFsbCIsInJlc2V0IiwiRWRnZU1hbmFnZXJNZXJnZVBhdGhzIiwic2V0Q2x1c3RlcklEIiwiU0VMRUNURURfQ0xVU1RFUiIsInVwZGF0ZU1lYW5BZ2UiLCJjbHVzdGVyaWQiLCJOT1RfQ0xVU1RFUl9JRCIsInRvZ2dsZVNob3dCeUNsdXN0ZXIiLCJBTExfQ0xVU1RFUl9JRCIsIm5ld01lYW5BZ2UiLCJtYXBSYW5nZSIsIk1hdGgiLCJjZWlsIiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwiY29uZmlnIiwiJHJvdXRlUHJvdmlkZXIiLCJ3aGVuIiwidGVtcGxhdGVVcmwiLCJvdGhlcndpc2UiLCJyZWRpcmVjdFRvIiwic2V0UGFnZU51bSIsImJDYW52YXNMb2FkZWQiLCJjc3MiLCJzZXRWaXNpYmlsaXR5IiwiYWRkQ2xhc3MiLCJzZWxlY3RlZGlkIiwiY2xpY2siLCJjaGFuZ2UiLCJyZW1vdmVDbGFzcyIsImlucHV0IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsIm1lcmdlUGF0aElkIiwicGFyc2VJbnQiLCJpc05hTiIsImxvd2VyQ2FzZWREaXNlYXNlTmFtZSIsInRvTG93ZXJDYXNlIiwiTUVSR0VQQVRIX0lOSVROT0RFX1JFRiIsImxlbmd0aCIsIm5hbWUiLCJjb25zb2xlIiwibG9nIiwiZXJyIl0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxPQUNBLFlDRkFELFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxtQkFBQSxhQUFBLFNBQUEsVUFBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQThHQSxRQUFBQyxLQUNBLElBQUEs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cEMsRUFBQSxvQkFBQXlDLFlBQUEsVUFKQVIsSUFNQUcsT0NaQTdGLFFBQUFDLE9BQUEsT0FDQUMsV0FBQSxpQkFBQSxhQUFBLFNBQUEsVUFBQSxTQUFBQyxFQUFBQyxFQUFBQyxHQUVBLFFBQUFxRixLQUVBL0MsU0FBQUYsTUFBQSxFQUdBa0QsZUFDQWxDLEVBQUEsdUJBQUFtQyxJQUFBLGFBQUEsV0FLQSxRQUFBQyxLQUVBcEMsRUFBQSxvQkFBQXFDLFNBQUEsVUFKQUosSUFPQUcsSUFJQXBDLEVBQUEseUJBQUF1QyxNQUFBLFdBRUE1RixFQUFBeUMsb0JBS0FZLEVBQUEsdUJBQUF1QyxNQUFBLFdBRUEsR0FBQUcsR0FBQUMsU0FBQUMsZUFBQSx5QkFBQTVELEtBR0EsS0FFQSxHQUFBNkQsR0FBQUMsU0FBQUosRUFDQSxJQUFBSyxNQUFBRixHQUlBLElBQUEsR0FGQUcsR0FBQU4sRUFBQU8sY0FFQW5HLEVBQUEsRUFBQUEsRUFBQW9HLHVCQUFBQyxPQUFBckcsSUFBQSxDQUVBLEdBQUFzRyxHQUFBRix1QkFBQXBHLEVBRUEsSUFBQXNHLEdBQUFKLEVBQUEsQ0FFQU4sRUFBQTVGLEVBQ0F1RyxRQUFBQyxJQUFBLHVCQUFBTixFQUFBLFVBQUFsRyxFQUNBLFNBUUEsTUFBQXlHLEdBRUEsV0FEQUYsU0FBQUMsSUFBQUMsR0FJQTVHLEVBQUE2RCxrQkFFQWQscUJBQUFnRCxFQUVBVyxRQUFBQyxJQUFBWixHQUVBL0YsRUFBQTBDLGFBQUFMLE1BQUFrRSx1QkFBQVIsR0FDQS9GLEVBQUEyQyxTQUVBM0MsRUFBQXlDIiwiZmlsZSI6ImFwcC5qcyIsInNvdXJjZXNDb250ZW50IjpbIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcblx0J25nUm91dGUnLFxuXSk7XG4iLCJhbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICR3aW5kb3cpe1xuXG5cdCRzY29wZS5tZWFuQWdlID0geyB2YWx1ZSA6IDAgfTtcblx0JHNjb3BlLm1lcmdlUGF0aElkcyA9IHsgdmFsdWUgOiBcImFjdXRlIG15b2NhcmRpYWwgaW5mYXJjdGlvblwifTtcblxuXHQkc2NvcGUuZ2V0TWVudVNob3cgPSBmdW5jdGlvbigpe1xuXHRcdHJldHVybiAkc2NvcGUuc2hvd19tZW51O1xuXHR9XG5cblx0Ly8gYXMgcmVzaXplLCByZS1pbml0IGRhdGFzXG5cdCQod2luZG93KS5yZXNpemUoZnVuY3Rpb24oKSB7XG4gICAgaWYodGhpcy5yZXNpemVUTykgY2xlYXJUaW1lb3V0KHRoaXMucmVzaXplVE8pO1xuXHQgICAgdGhpcy5yZXNpemVUTyA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG5cdCAgICAgICAgJCh0aGlzKS50cmlnZ2VyKCdyZXNpemVFbmQnKTtcblx0ICAgIH0sIDIwMCk7XG5cdH0pO1xuXG5cdCQod2luZG93KS5iaW5kKCdyZXNpemVFbmQnLCBmdW5jdGlvbigpIHtcblx0ICAgIC8vZG8gc29tZXRoaW5nLCB3aW5kb3cgaGFzbid0IGNoYW5nZWQgc2l6ZSBpbiA1MDBtc1xuXHQgICAgbG9jYXRpb24ucmVsb2FkKCk7XG5cdH0pO1xuXG5cdCRzY29wZS5jbHVzdGVyaWRzID0gW1xuICAgICAge3ZhbHVlOiAxLCBkaXNwbGF5TmFtZTogJzEnfSxcbiAgICAgIHt2YWx1ZTogMiwgZGlzcGxheU5hbWU6ICcyJ30sXG4gICAgICB7dmFsdWU6IDMsIGRpc3BsYXlOYW1lOiAnMyd9LFxuICAgICAge3ZhbHVlOiA0LCBkaXNwbGF5TmFtZTogJzQnfSxcbiAgICAgIHt2YWx1ZTogNSwgZGlzcGxheU5hbWU6ICc1J30sXG4gICAgICB7dmFsdWU6IDYsIGRpc3BsYXlOYW1lOiAnNid9LFxuICAgICAge3ZhbHVlOiA3LCBkaXNwbGF5TmFtZTogJzcnfSxcbiAgICAgIHt2YWx1ZTogOCwgZGlzcGxheU5hbWU6ICc4J30sXG4gICAgICB7dmFsdWU6IDksIGRpc3BsYXlOYW1lOiAnOSd9LFxuICAgICAge3ZhbHVlOiAxMCwgZGlzcGxheU5hbWU6ICcxMCd9LFxuICAgICAge3ZhbHVlOiAxMSwgZGlzcGxheU5hbWU6ICcxMSd9LFxuICAgICAge3ZhbHVlOiAxMiwgZGlzcGxheU5hbWU6ICcxMid9LFxuICAgICAge3ZhbHVlOiAxMywgZGlzcGxheU5hbWU6ICcxMyd9LFxuICAgICAge3ZhbHVlOiAxNCwgZGlzcGxheU5hbWU6ICcxNCd9LFxuICAgICAge3ZhbHVlOiAxNSwgZGlzcGxheU5hbWU6ICcxNSd9LFxuICAgICAge3ZhbHVlOiAxNiwgZGlzcGxheU5hbWU6ICcxNid9LFxuICAgICAge3ZhbHVlOiAxNywgZGlzcGxheU5hbWU6ICdOb3QgQ2x1c3RlcmVkJ30sXG4gICAgICB7dmFsdWU6IDE4LCBkaXNwbGF5TmFtZTogJ0FsbCd9XG4gIFx0XTtcblxuXG5cblx0JHNjb3BlLmNsZWFuTWVyZ2VQYXRocyA9IGZ1bmN0aW9uKCl7XG5cblx0XHROb2RlTWFuYWdlck1lcmdlUGF0aHNbU0VMRUNURURfTUVSR0VQQVRISURdLmNsZWFuKCk7XG5cblx0fVxuXG5cdCRzY29wZS5yZXNldE1lcmdlUGF0aHMgPSBmdW5jdGlvbigpe1xuXHRcdEZSQU1FLnZhbHVlICAgID0gMDtcblx0XHRQQUdFX05VTS52YWx1ZSA9IDI7XG5cblx0XHRUV0VFTi5yZW1vdmVBbGwoKTsgLy8gcmVzZXQgdHdlZW4gYW5pbWF0aW9uc1xuXG5cdFx0Tm9kZU1hbmFnZXJNZXJnZVBhdGhzW1NFTEVDVEVEX01FUkdFUEFUSElEXS5yZXNldCgpO1xuXHRcdEVkZ2VNYW5hZ2VyTWVyZ2VQYXRoc1tTRUxFQ1RFRF9NRVJHRVBBVEhJRF0ucmVzZXQoKTtcblxuXHR9XG5cblx0JHNjb3BlLnJlc2V0Q2x1c3RlcnMgPSBmdW5jdGlvbigpe1xuXG4gICAgICBcdEZSQU1FLnZhbHVlICAgID0gMDtcbiAgICAgIFx0UEFHRV9OVU0udmFsdWUgPSAxO1xuXG4gICAgICBcdCRzY29wZS5tZWFuQWdlLnZhbHVlID0gMDtcblxuICAgICAgXHRUV0VFTi5yZW1vdmVBbGwoKTsgLy8gcmVzZXQgdHdlZW4gYW5pbWF0aW9uc1xuXG4gICAgICBcdEVkZ2VNYW5hZ2VyQ2x1c3Rlci5yZXNldCgpO1xuICAgICAgXHROb2RlTWFuYWdlckNsdXN0ZXIucmVzZXQoKTtcblxuICAgICAgXHQkc2NvcGUuc2V0Q2x1c3RlcklEKFNFTEVDVEVEX0NMVVNURVIpO1xuXG4gICAgICBcdCRzY29wZS51cGRhdGVNZWFuQWdlKCk7XG5cdFxuXHR9XG5cblx0JHNjb3BlLnNldENsdXN0ZXJJRCA9IGZ1bmN0aW9uKGNsdXN0ZXJpZCl7XG5cblx0ICAgIFNFTEVDVEVEX0NMVVNURVIgPSBjbHVzdGVyaWQ7XG5cblx0ICAgIGlmIChjbHVzdGVyaWQgPT0gTk9UX0NMVVNURVJfSUQpe1xuXG5cdCAgICAgICAgU0VMRUNURURfQ0xVU1RFUiA9IE5PVF9DTFVTVEVSX0lEO1xuXHQgICAgICAgIFxuXHQgICAgICAgIGNsZWFyQWxsQ2x1c3RlcnMoKTtcblx0ICAgICAgICBFZGdlTWFuYWdlckNsdXN0ZXIudG9nZ2xlU2hvd0J5Q2x1c3RlcihOT1RfQ0xVU1RFUl9JRCk7XG5cdCAgICAgICAgTm9kZU1hbmFnZXJDbHVzdGVyLnRvZ2dsZVNob3dCeUNsdXN0ZXIoTk9UX0NMVVNURVJfSUQpO1xuXG5cdCAgICAgICAgcmV0dXJuO1xuXG5cdCAgICB9XG5cblx0ICAgIGlmIChjbHVzdGVyaWQgPT0gQUxMX0NMVVNURVJfSUQpe1xuXG5cdCAgICAgICAgdmlld0FsbENsdXN0ZXJzKCk7IFxuXG5cdCAgICAgICAgcmV0dXJuOyBcblxuXHQgICAgfVxuXG5cdCAgICBjbGVhckFsbENsdXN0ZXJzKCk7XG5cdCAgICBFZGdlTWFuYWdlckNsdXN0ZXIudG9nZ2xlU2hvd0J5Q2x1c3RlcihTRUxFQ1RFRF9DTFVTVEVSKTtcblx0ICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci50b2dnbGVTaG93QnlDbHVzdGVyKFNFTEVDVEVEX0NMVVNURVIpO1xuXHR9XG5cblx0Ly8gY2xlYXIgYWxsIGNsdXN0ZXJzXG4gIFx0ZnVuY3Rpb24gY2xlYXJBbGxDbHVzdGVycygpeyAvLyDsp4DquIgg7J206rKMIGdsb2JhbOuhnCDsoJXsnZjrkJwg6rKD7J24642wLCDslYTrp4jrj4Qg7YG066Gc7KWs7Ja0IOyViOyXkCDrhKPslrTshJwsIOydtCDtjIzsnbwg7JWI7JeQ7ISc66eMIOqwgOuKpe2VnCBsb2NhbCBzcGFjZeuhnCDsmK7qsqjslbwg7ZWg65Ov7Iu264ukLlxuXHQgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxODsgaSsrKXtcblxuXHQgICAgICBFZGdlTWFuYWdlckNsdXN0ZXIuaGlkZUFsbCgpO1xuXHQgICAgICBOb2RlTWFuYWdlckNsdXN0ZXIuaGlkZUFsbCgpO1xuXG5cdCAgICB9XG5cdH1cblxuXHQvLyBjbGVhciBhbGwgY2x1c3RlcnNcblx0ZnVuY3Rpb24gdmlld0FsbENsdXN0ZXJzKCl7XG5cdCAgICBmb3IgKHZhciBpID0gMDsgaSA8IDE4OyBpKyspe1xuXG5cdCAgICAgIEVkZ2VNYW5hZ2VyQ2x1c3Rlci5zaG93QWxsKCk7XG5cdCAgICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci5zaG93QWxsKCk7XG5cblx0ICAgIH1cblx0fVxuXG5cdCRzY29wZS51cGRhdGVNZWFuQWdlID0gZnVuY3Rpb24oKXtcblx0ICAgIGlmIChGUkFNRS52YWx1ZSA+IDYyMCB8fCBQQUdFX05VTS52YWx1ZSAhPSAxKVxuXHQgICAgICByZXR1cm47XG5cblx0ICAgIHZhciBuZXdNZWFuQWdlID0gbWFwUmFuZ2UoWzAsIDYyMC4wXSwgWzM1LjQsIDkwLjVdLCBGUkFNRS52YWx1ZSk7XG5cdCAgICAkc2NvcGUubWVhbkFnZS52YWx1ZSA9IE1hdGguY2VpbChuZXdNZWFuQWdlKTtcblx0ICAgICRzY29wZS4kYXBwbHkoKTtcblx0ICAgIHJlcXVlc3RBbmltYXRpb25GcmFtZSgkc2NvcGUudXBkYXRlTWVhbkFnZSk7XG5cdH1cblxuXHRmdW5jdGlvbiBzZXREYXRhR3VpSW5pdGlhbGl6ZSgpe1xuXG5cdCAgICB2YXIgcmVuZGVyT3B0aW9uc1VJID0gZnVuY3Rpb24oKSB7XG5cblx0ICAgICAgdGhpcy5BZGRpdGl2ZUNvbG9yID0gdHJ1ZTtcblxuXHQgICAgICB0aGlzLlJlc3RhcnQgPSBmdW5jdGlvbigpIHsgXG5cblx0ICAgICAgXHQgLy8gcmVzdGFydCB0aGUgcGFnZVxuXHQgICAgICBcdCBsb2NhdGlvbi5yZWxvYWQoKTtcblxuXHQgICAgICB9O1xuXG5cdCAgICAgIHRoaXMuSGlkZU5vZGVzID0gZmFsc2U7XG5cblx0ICAgICAgdGhpcy5IaWRlTmFtZXMgPSBmYWxzZTtcblxuXHQgICAgICB0aGlzLkRhdGEgICAgICA9ICdVUyc7XG5cdCAgICB9O1xuXG5cdCAgICBSRU5ERVJPUFRJT05TIFx0PSBuZXcgcmVuZGVyT3B0aW9uc1VJKCk7XG5cdCAgICB2YXIgZ3VpICBcdFx0PSBuZXcgZGF0LkdVSSgpO1xuXG5cdCAgICB2YXIgRGF0YVR5cGUgICAgICAgICA9IGd1aS5hZGQoUkVOREVST1BUSU9OUywgJ0RhdGEnLCBbICdVUycsICdLT1InIF0gKTtcblxuXHQgICAgdmFyIENsdXN0ZXJzR3JwICAgICAgPSBndWkuYWRkRm9sZGVyKCdDbHVzdGVycycpO1xuXHRcdHZhciBDbHVzdGVySGlkZU5vZGVzICAgPSBDbHVzdGVyc0dycC5hZGQoUkVOREVST1BUSU9OUywgJ0hpZGVOb2RlcycpO1xuXHRcdHZhciBDbHVzdGVySGlkZU5hbWVzICAgPSBDbHVzdGVyc0dycC5hZGQoUkVOREVST1BUSU9OUywgJ0hpZGVOYW1lcycpO1xuXG5cdFx0dmFyIE1lcmdlUGF0aEdycCAgICAgICA9IGd1aS5hZGRGb2xkZXIoJ01lcmdlUGF0aHMnKTtcblx0XHR2YXIgTWVyZ2VQYXRoSGlkZU5vZGVzID0gTWVyZ2VQYXRoR3JwLmFkZChSRU5ERVJPUFRJT05TLCAnSGlkZU5vZGVzJyk7XG5cdFx0dmFyIE1lcmdlUGF0aEhpZGVOYW1lcyA9IE1lcmdlUGF0aEdycC5hZGQoUkVOREVST1BUSU9OUywgJ0hpZGVOYW1lcycpO1xuXG5cdFx0RGF0YVR5cGUub25GaW5pc2hDaGFuZ2UoZnVuY3Rpb24odmFsKSB7XG5cdFx0XHRpZiAodmFsID09ICdVUycpe1xuXG5cdFx0XHRcdGRhdGFNYW5hZ2VyLnN0YXJ0KCdVUycpO1xuXHRcdFx0XHQkc2NvcGUuY2x1c3RlcmlkcyA9IFtcblx0XHRcdCAgICAgIHt2YWx1ZTogMSwgZGlzcGxheU5hbWU6ICcxJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDIsIGRpc3BsYXlOYW1lOiAnMid9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiAzLCBkaXNwbGF5TmFtZTogJzMnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogNCwgZGlzcGxheU5hbWU6ICc0J30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDUsIGRpc3BsYXlOYW1lOiAnNSd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiA2LCBkaXNwbGF5TmFtZTogJzYnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogNywgZGlzcGxheU5hbWU6ICc3J30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDgsIGRpc3BsYXlOYW1lOiAnOCd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiA5LCBkaXNwbGF5TmFtZTogJzknfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTAsIGRpc3BsYXlOYW1lOiAnMTAnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTEsIGRpc3BsYXlOYW1lOiAnMTEnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTIsIGRpc3BsYXlOYW1lOiAnMTInfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTMsIGRpc3BsYXlOYW1lOiAnMTMnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTQsIGRpc3BsYXlOYW1lOiAnMTQnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTUsIGRpc3BsYXlOYW1lOiAnMTUnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTYsIGRpc3BsYXlOYW1lOiAnMTYnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTcsIGRpc3BsYXlOYW1lOiAnTm90IENsdXN0ZXJlZCd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiAxOCwgZGlzcGxheU5hbWU6ICdBbGwnfVxuXHRcdFx0ICBcdF07XG5cdFx0XHQgIFx0aWYgKFBBR0VfTlVNLnZhbHVlID09IDEpIHtcblx0XHRcdCAgXHRcdCRzY29wZS5yZXNldENsdXN0ZXJzKCk7XG5cdFx0XHQgIFx0fVxuXHRcdFx0ICBcdGVsc2UgaWYgKFBBR0VfTlVNLnZhbHVlID09IDIpe1xuXHRcdFx0ICBcdFx0JHNjb3BlLnJlc2V0TWVyZ2VQYXRocygpO1xuXHRcdFx0ICBcdH1cblx0XHRcdCAgXHQkc2NvcGUubWVyZ2VQYXRoSWRzLnZhbHVlICA9IFwiYWN1dGUgbXlvY2FyZGlhbCBpbmZhcmN0aW9uXCI7XG5cdFx0XHQgIFx0JHNjb3BlLiRhcHBseSgpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiAodmFsID09ICdLT1InKXtcblx0XHRcdFx0ZGF0YU1hbmFnZXIuc3RhcnQoJ0tPUicpO1xuXHRcdFx0XHQkc2NvcGUuY2x1c3RlcmlkcyA9IFtcblx0XHRcdCAgICAgIHt2YWx1ZTogMCwgZGlzcGxheU5hbWU6ICcwJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDEsIGRpc3BsYXlOYW1lOiAnMSd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiAyLCBkaXNwbGF5TmFtZTogJzInfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMywgZGlzcGxheU5hbWU6ICdOb3QgQ2x1c3RlcmVkJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDQsIGRpc3BsYXlOYW1lOiAnQWxsJ31cblx0XHRcdCAgXHRdO1xuXHRcdFx0ICBcdGlmIChQQUdFX05VTS52YWx1ZSA9PSAxKXtcblx0XHRcdCAgXHRcdCRzY29wZS5yZXNldENsdXN0ZXJzKCk7XG5cdFx0XHQgIFx0fVxuXHRcdFx0ICBcdGVsc2UgaWYgKFBBR0VfTlVNLnZhbHVlID09IDIpe1xuXHRcdFx0ICBcdFx0JHNjb3BlLnJlc2V0TWVyZ2VQYXRocygpOyAgXG5cdFx0XHQgIFx0fVxuXHRcdFx0ICBcdCRzY29wZS5tZXJnZVBhdGhJZHMudmFsdWUgID0gXCJjaHJvbmljIHZpcmFsIGhlcGF0aXRpc1wiO1xuXHRcdFx0ICBcdCRzY29wZS4kYXBwbHkoKTtcblx0XHRcdH1cblx0XHR9KVxuXG5cdCAgICBDbHVzdGVySGlkZU5vZGVzLm9uRmluaXNoQ2hhbmdlKGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgXHRpZiAodmFsID09IHRydWUpIHtcblx0XHQgICAgICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci50b2dnbGVOb2RlVmlzaWJpbGl0eUJ5Q2x1c3RlcihmYWxzZSk7XG5cdCAgICBcdH1cblx0ICAgIFx0ZWxzZSB7XG5cdFx0ICAgICAgICBOb2RlTWFuYWdlckNsdXN0ZXIudG9nZ2xlTm9kZVZpc2liaWxpdHlCeUNsdXN0ZXIodHJ1ZSk7XG5cdCAgICBcdH1cblx0ICAgIH0pO1xuXG5cdCAgICBDbHVzdGVySGlkZU5hbWVzLm9uRmluaXNoQ2hhbmdlKGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgXHRpZiAodmFsID09IHRydWUpIHtcblx0XHQgICAgICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci50b2dnbGVOb2RlVGV4dFZpc2liaWxpdHlCeUNsdXN0ZXIoZmFsc2UpO1xuXHQgICAgXHR9XG5cdCAgICBcdGVsc2Uge1xuXHRcdCAgICAgICAgTm9kZU1hbmFnZXJDbHVzdGVyLnRvZ2dsZU5vZGVUZXh0VmlzaWJpbGl0eUJ5Q2x1c3Rlcih0cnVlKTtcblx0ICAgIFx0fVxuXHQgICAgfSk7XG5cblx0ICAgXHRNZXJnZVBhdGhIaWRlTm9kZXMub25GaW5pc2hDaGFuZ2UoZnVuY3Rpb24odmFsKSB7XG5cdCAgICBcdGlmICh2YWwgPT0gdHJ1ZSkge1xuXG5cdFx0ICAgICAgICBOb2RlTWFuYWdlck1lcmdlUGF0aHNbU0VMRUNURURfTUVSR0VQQVRISURdLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KGZhbHNlKTtcblxuXHQgICAgXHR9XG5cdCAgICBcdGVsc2Uge1xuXG5cdFx0ICAgICAgICBOb2RlTWFuYWdlck1lcmdlUGF0aHNbU0VMRUNURURfTUVSR0VQQVRISURdLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KHRydWUpO1xuXG5cdFx0ICAgIH1cblx0ICAgIH0pO1xuXG5cdCAgICBNZXJnZVBhdGhIaWRlTmFtZXMub25GaW5pc2hDaGFuZ2UoZnVuY3Rpb24odmFsKSB7XG5cdCAgICBcdGlmICh2YWwgPT0gdHJ1ZSkge1xuXG5cdFx0ICAgICAgICBOb2RlTWFuYWdlck1lcmdlUGF0aHNbU0VMRUNURURfTUVSR0VQQVRISURdLnRvZ2dsZU5vZGVUZXh0VmlzaWJpbGl0eShmYWxzZSk7XG5cblx0ICAgIFx0fVxuXHQgICAgXHRlbHNlIHtcblxuXHRcdCAgICAgICAgTm9kZU1hbmFnZXJNZXJnZVBhdGhzW1NFTEVDVEVEX01FUkdFUEFUSElEXS50b2dnbGVOb2RlVGV4dFZpc2liaWxpdHkodHJ1ZSk7XG5cblx0ICAgIFx0fVxuXHQgICAgfSk7XG5cblx0ICAgIGd1aS5hZGQoUkVOREVST1BUSU9OUywgJ1Jlc3RhcnQnKTtcblxuXHQgICAgLy8kKGd1aS5kb21FbGVtZW50KS5maW5kKFwiPnVsXCIpLnRvZ2dsZUNsYXNzKFwiY2xvc2VkXCIpOyAvLyBkYXQuZ3VpIGRlZmF1bHQgdG8gYmUgY2xvc2VkXG5cblx0fVxuICBcdHNldERhdGFHdWlJbml0aWFsaXplKCk7XG59KTsiLCJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpe1xuXHQkcm91dGVQcm92aWRlclxuXHQud2hlbignL21lcmdlcGF0aHMnLCBcblx0XHR7XG5cdFx0XHR0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvbWVyZ2VwYXRocy5odG1sJyxcblx0XHRcdGNvbnRyb2xsZXI6ICdNZXJnZVBhdGhDdHJsJ1xuXHRcdH0pXG5cdC53aGVuKCcvY2x1c3RlcnMnLCBcblx0XHR7XG5cdFx0XHR0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvY2x1c3RlcnMuaHRtbCcsXG5cdFx0XHRjb250cm9sbGVyOiAnQ2x1c3RlckN0cmwnXG5cdFx0fSlcblx0LndoZW4oJy9pbnRybycsIFxuXHRcdHtcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9pbnRyby5odG1sJyxcblx0XHRcdGNvbnRyb2xsZXI6ICdJbnRyb0N0cmwnXG5cdFx0fSlcblx0Lm90aGVyd2lzZShcblx0XHR7XG4gICBcdFx0XHRyZWRpcmVjdFRvOiAnL2ludHJvJ1xuXHRcdH0pO1xuXG59KTtcbiIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQ2x1c3RlckN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICR3aW5kb3cpe1xuXG4gIGZ1bmN0aW9uIHNldFBhZ2VOdW0oKXtcbiAgICBQQUdFX05VTS52YWx1ZSA9IDE7IC8vIDEgLSBjbHVzdGVyXG5cbiAgICBpZiAoYkNhbnZhc0xvYWRlZClcbiAgICAgICQoJyNvcHRpb25zLWNsdXN0ZXJzJykuY3NzKCd2aXNpYmlsaXR5JywgJ3Zpc2libGUnKTtcbiAgfVxuICBzZXRQYWdlTnVtKCk7XG5cbiAgJHNjb3BlLnNlbGVjdGVkaWQgPSB7IHZhbHVlIDogU0VMRUNURURfQ0xVU1RFUiB9O1xuXG5cbiAgZnVuY3Rpb24gc2V0VmlzaWJpbGl0eSgpe1xuICAgICQoJy5kYXRhLXZpc2liaWxpdHknKS5hZGRDbGFzcygnYWN0aXZlJyk7XG4gIH1cbiAgc2V0VmlzaWJpbGl0eSgpO1xuXG5cbiAgLy8gcmVzZXQgYW5pbWF0aW9uLlxuICAkKCcjYnRuLXJlc2V0LWNsdXN0ZXJzJykuY2xpY2soZnVuY3Rpb24oKSB7XG5cbiAgICAkc2NvcGUucmVzZXRDbHVzdGVycygpO1xuXG4gIH0pO1xuXG5cbiAgJHNjb3BlLnVwZGF0ZU1lYW5BZ2UoKTtcbiAgLypcbiAgLy9zZXQgaW5pdGlhbCBzdGF0ZS4gIGV4YW1wbGUgb2YgY2hlY2sgYm94IGV2ZW50XG4gICQoJyNjaGVja2JveC1oaWRlLW5vZGVzLWNsdXN0ZXJzJykuY2hhbmdlKGZ1bmN0aW9uKCkge1xuICAgICAgaWYoJCh0aGlzKS5pcyhcIjpjaGVja2VkXCIpKSB7XG4gICAgICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci50b2dnbGVOb2RlVmlzaWJpbGl0eSh0cnVlKTtcbiAgICAgIH1cbiAgICAgIGVsc2VcbiAgICAgIHtcbiAgICAgICAgTm9kZU1hbmFnZXJDbHVzdGVyLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KGZhbHNlKTtcbiAgICAgIH1cbiAgfSk7XG4gICovXG5cbiAgJCgnI2NsdXN0ZXJpZCcpLmNoYW5nZShmdW5jdGlvbigpe1xuXG4gICAgdmFyIGNsdXN0ZXJpZCA9ICQoJyNjbHVzdGVyaWQnKS52YWwoKTtcblxuICAgIFNFTEVDVEVEX0NMVVNURVIgPSBjbHVzdGVyaWQ7XG5cbiAgICAkc2NvcGUuc2V0Q2x1c3RlcklEKGNsdXN0ZXJpZCk7XG5cbiAgfSlcblxuXG59KTsiLCJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0ludHJvQ3RybCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdyl7XG5cblx0ZnVuY3Rpb24gc2V0UGFnZU51bSgpe1xuICAgIFx0UEFHRV9OVU0udmFsdWUgPSAwO1xuICBcdH1cbiAgXHRzZXRQYWdlTnVtKCk7XG5cblxuXHRmdW5jdGlvbiBzZXRWaXNpYmlsaXR5KCl7XG5cdFx0JCgnLmRhdGEtdmlzaWJpbGl0eScpLnJlbW92ZUNsYXNzKCdhY3RpdmUnKTtcblx0fVxuXHRzZXRWaXNpYmlsaXR5KCk7XG5cbn0pOyIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignTWVyZ2VQYXRoQ3RybCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdyl7XG5cbiAgZnVuY3Rpb24gc2V0UGFnZU51bSgpe1xuXG4gICAgUEFHRV9OVU0udmFsdWUgPSAyO1xuICAgIC8vJHNjb3BlLnJlc2V0TWVyZ2VQYXRocygpO1xuICAgIFxuICAgIGlmIChiQ2FudmFzTG9hZGVkKVxuICAgICAgJCgnI29wdGlvbnMtbWVyZ2VwYXRocycpLmNzcygndmlzaWJpbGl0eScsICd2aXNpYmxlJyk7XG5cbiAgfVxuICBzZXRQYWdlTnVtKCk7XG5cbiAgZnVuY3Rpb24gc2V0VmlzaWJpbGl0eSgpe1xuXG4gICAgJCgnLmRhdGEtdmlzaWJpbGl0eScpLmFkZENsYXNzKCdhY3RpdmUnKTtcblxuICB9XG4gIHNldFZpc2liaWxpdHkoKTtcblxuXG4gIC8vIHJlc2V0IGFuaW1hdGlvbi5cbiAgJCgnI2J0bi1yZXNldC1tZXJnZXBhdGhzJykuY2xpY2soZnVuY3Rpb24oKSB7XG5cbiAgICAkc2NvcGUucmVzZXRNZXJnZVBhdGhzKCk7IFxuXG4gIH0pO1xuXG5cbiAgJCgnI2J0bi1ydW4tbWVyZ2VwYXRocycpLmNsaWNrKGZ1bmN0aW9uKCkge1xuXG4gICAgdmFyIGlucHV0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJ0ZXh0aW5mby1tZXJnZXBhdGhpZHNcIikudmFsdWU7XG5cbiAgICAvLyBkZWFsIHdpdGggaW5wdXQgdG8gZmluZCBtZXJnZXBhdGghXG4gICAgdHJ5IHtcblxuICAgICAgdmFyIG1lcmdlUGF0aElkID0gcGFyc2VJbnQoaW5wdXQpO1xuICAgICAgaWYgKGlzTmFOKG1lcmdlUGF0aElkKSl7XG5cbiAgICAgICAgdmFyIGxvd2VyQ2FzZWREaXNlYXNlTmFtZSA9IGlucHV0LnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBNRVJHRVBBVEhfSU5JVE5PREVfUkVGLmxlbmd0aDsgaSsrKXtcblxuICAgICAgICAgIHZhciBuYW1lID0gTUVSR0VQQVRIX0lOSVROT0RFX1JFRltpXTtcblxuICAgICAgICAgIGlmIChuYW1lID09IGxvd2VyQ2FzZWREaXNlYXNlTmFtZSl7XG5cbiAgICAgICAgICAgIGlucHV0ID0gaTtcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZWxlY3RlZCBkaXNlYXNlIGZvcicsIGxvd2VyQ2FzZWREaXNlYXNlTmFtZSwgJyBpcyBpZDonLCBpKTtcbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgICAgfSBcblxuICAgICAgICB9XG5cbiAgICAgIH1cbiAgICB9XG4gICAgY2F0Y2goZXJyKSB7XG4gICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgICRzY29wZS5jbGVhbk1lcmdlUGF0aHMoKTtcblxuICAgIFNFTEVDVEVEX01FUkdFUEFUSElEID0gaW5wdXQ7XG4gICAgXG4gICAgY29uc29sZS5sb2coaW5wdXQpO1xuXG4gICAgJHNjb3BlLm1lcmdlUGF0aElkcy52YWx1ZSA9IE1FUkdFUEFUSF9JTklUTk9ERV9SRUZbaW5wdXRdO1xuICAgICRzY29wZS4kYXBwbHkoKTtcblxuICAgICRzY29wZS5yZXNldE1lcmdlUGF0aHMoKTtcblxuICB9KVxuXG4gIC8vc2V0IGluaXRpYWwgc3RhdGUuXG4gIC8qXG4gICQoJyNjaGVja2JveC1oaWRlLW5vZGVzLW1lcmdlcGF0aHMnKS5jaGFuZ2UoZnVuY3Rpb24oKSB7XG4gICAgICBpZigkKHRoaXMpLmlzKFwiOmNoZWNrZWRcIikpIHtcblxuICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBOb2RlTWFuYWdlck1lcmdlUGF0aHMubGVuZ3RoOyBpKyspe1xuXG4gICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBTRUxFQ1RFRF9NRVJHRVBBVEhJRFMubGVuZ3RoOyBqKyspe1xuXG4gICAgICAgICAgICBpZiAoU0VMRUNURURfTUVSR0VQQVRISURTW2pdID09PSBpKVxuICAgICAgICAgICAgICBOb2RlTWFuYWdlck1lcmdlUGF0aHNbaV0udG9nZ2xlTm9kZVZpc2liaWxpdHkodHJ1ZSk7XG5cbiAgICAgICAgICB9XG4gICAgICAgICAgXG4gICAgICAgICB9XG4gICAgICAgIFxuICAgICAgfVxuICAgICAgZWxzZVxuICAgICAge1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTm9kZU1hbmFnZXJNZXJnZVBhdGhzLmxlbmd0aDsgaSsrKXtcblxuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgU0VMRUNURURfTUVSR0VQQVRISURTLmxlbmd0aDsgaisrKXtcblxuICAgICAgICAgICAgaWYgKFNFTEVDVEVEX01FUkdFUEFUSElEU1tqXSA9PT0gaSlcbiAgICAgICAgICAgICAgTm9kZU1hbmFnZXJNZXJnZVBhdGhzW2ldLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KGZhbHNlKTtcblxuICAgICAgICAgIH1cblxuICAgICAgICAgfVxuXG4gICAgICB9XG4gIH0pO1xuXG4gIC8vc2V0IGluaXRpYWwgc3RhdGUuXG4gICQoJyNjaGVja2JveC1oaWRlLW5hbWVzLW1lcmdlcGF0aHMnKS5jaGFuZ2UoZnVuY3Rpb24oKSB7XG4gICAgICBpZigkKHRoaXMpLmlzKFwiOmNoZWNrZWRcIikpIHtcblxuICAgICAgICBOb2RlTWFuYWdlck1lcmdlUGF0aHNbU0VMRUNURURfTUVSR0VQQVRISURdLnRvZ2dsZU5vZGVUZXh0VmlzaWJpbGl0eSh0cnVlKTtcbiAgICAgICAgXG4gICAgICB9XG4gICAgICBlbHNlXG4gICAgICB7XG5cbiAgICAgICAgTm9kZU1hbmFnZXJNZXJnZVBhdGhzW1NFTEVDVEVEX01FUkdFUEFUSElEXS50b2dnbGVOb2RlVGV4dFZpc2liaWxpdHkoZmFsc2UpO1xuXG4gICAgICAgICAgfVxuXG4gICAgICAgICB9XG5cbiAgICAgIH1cbiAgfSk7XG4qL1xuICBcbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==