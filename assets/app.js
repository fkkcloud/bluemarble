angular.module("app",["ngRoute","duScroll","infinite-scroll"]),angular.module("app").controller("ApplicationCtrl",["$rootScope","$scope","$window","UserSvc",function(e,o,t,n){o.pageId={post:0,register:1,login:2,account:3},o.navCollapsed=!0,o.collapse=function(){o.navCollapsed=!0},o.moveToCurrentLocation=function(){function e(e){if(o.currentPageId==o.pageId.post){var t=e.coords;window.localStorage.latitude=t.latitude,window.localStorage.longitude=t.longitude;var n=new google.maps.LatLng(t.latitude,t.longitude);google.maps.event.trigger(o.map,"heading_changed",n),o.map.panTo(n),o.map.setZoom(15)}}function t(e){console.warn("ERROR("+e.code+"): "+e.message)}navigator.geolocation.getCurrentPosition(e,t),swal({title:"",text:"Moving to current location..",timer:1500,showConfirmButton:!1})},o.logout=function(){o.collapse(),o.currentUser=void 0,n.logout(),swal("","Successfully logged out")},e.$on("login",function(e,t){o.currentUser=t}),o.$on("loc",function(e,t){console.log(t);var n=t.lat(),a=t.lng();o.postLocation={lat:n,lon:a},console.log(o.postLocation)}),o.$on("pagechange",function(e,t){o.currentPageId=t}),o.$on("place",function(e,t){o.$$phase||o.$apply(function(){o.sexPlaceAutocompleted=t})}),o.$on("mapInit",function(e,t){o.map=t}),n.remainLogin()}]),angular.module("app").config(["$routeProvider",function(e){e.when("/",{controller:"PostsCtrl",templateUrl:"/templates/posts.html"}).when("/register",{controller:"RegisterCtrl",templateUrl:"/templates/register.html"}).when("/login",{controller:"LoginCtrl",templateUrl:"/templates/login.html"}).when("/account",{controller:"AccountCtrl",templateUrl:"/templates/account.html"})}]),angular.module("app").directive("appMap",["PostsSvc","UtilSvc","$timeout","$compile",function(e,o,t,n){var a=function(o,t,a){function l(e){for(var o,t=0;o=S[t];t++)o.setMap(null);S=[];var o=new google.maps.Marker({position:e,map:f,icon:w});S.push(o)}function r(e){if(o.currentUser){v&&v.close();var t=new google.maps.Geocoder;o.$emit("loc",e),l(e),t.geocode({latLng:e},function(e,t){try{o.$emit("place",e[1].formatted_address)}catch(n){console.log(n),swal("","Location does not exists"),o.$emit("place","Location does not exists")}})}}function s(){var t=void 0;e.fetchAll().success(function(e){t=e;for(var a=0;a<t.length;a++){var l=t[a];if(!L[a]||L[a].post._id!=l._id){var r=angular.fromJson(l.sexLocation),s=new google.maps.LatLng(r.lat,r.lon),i={position:s,map:f,title:"Sex"},c=new google.maps.Marker(i);L.push({marker:c,post:l});var g=o,p=g.$new(!0),u=function(e,o){return function(){void 0!==v&&v.close(),p.content=o.sexTarget.substring(0,24),p.age=o.userAge;var t='<div> <strong class="post-content">"'+p.content+'..."</strong>   <span class="post-content-age">Danger Rate -  '+p.age+"/100</span></div>",a=n(t)(p),l={content:a[0],pixelOffset:new google.maps.Size(0,0),disableAutoPan:!0};v=new google.maps.InfoWindow(l),v.open(f,e)}}(c,l);u(),google.maps.event.addListener(c,"click",function(e,o){return function(){void 0!==v&&v.close(),p.content=o.sexTarget.substring(0,24),p.age=o.userAge;var t='<div> <strong class="post-content">"'+p.content+'"...</strong>   <span class="post-content-age">Joy Rate -  '+p.age+"</span></div>",a=n(t)(p),l={content:a[0],pixelOffset:new google.maps.Size(0,0),disableAutoPan:!0};v=new google.maps.InfoWindow(l),v.open(f,e)}}(c,l))}}})}function i(){var e=document.getElementById("pac-input"),o=document.getElementById("btn-curr");f.controls[google.maps.ControlPosition.TOP_LEFT].push(e),f.controls[google.maps.ControlPosition.TOP_RIGHT].push(o);var t=new google.maps.places.SearchBox(e);google.maps.event.addListener(t,"places_changed",function(){var e=t.getPlaces();if(0!=e.length){var o=e[0];r(o.geometry.location),window.localStorage.latitude=o.geometry.location.latitude,window.localStorage.longitude=o.geometry.location.longitude,f.panTo(o.geometry.location)}})}function c(){google.maps.event.addListener(f,"click",function(e){r(e.latLng)})}function g(){google.maps.event.addListener(f,"heading_changed",function(e){r(e)})}function p(){google.maps.event.addListener(f,"center_changed",function(){window.localStorage.latitude=f.getCenter().lat(),window.localStorage.longitude=f.getCenter().lng()})}function u(){google.maps.event.addListener(f,"maptypeid_changed",function(){s()})}function d(){var e=[{featureType:"administrative",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"administrative",elementType:"labels.text.fill",stylers:[{color:"#439aa5"}]},{featureType:"administrative.locality",elementType:"all",stylers:[{color:"#32485c"},{visibility:"simplified"}]},{featureType:"administrative.neighborhood",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"landscape.natural",elementType:"all",stylers:[{color:"#e9dddb"}]},{featureType:"landscape.natural.terrain",elementType:"geometry",stylers:[{visibility:"off"}]},{featureType:"poi",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"poi.park",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#c4e661"}]},{featureType:"poi.park",elementType:"labels",stylers:[{visibility:"off"}]},{featureType:"road.highway",elementType:"geometry.fill",stylers:[{color:"#e9dddb"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#32485c"},{weight:"0.7"}]},{featureType:"road.arterial",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"road.arterial",elementType:"geometry.fill",stylers:[{color:"#e9dddb"}]},{featureType:"road.arterial",elementType:"geometry.stroke",stylers:[{color:"#32485c"},{weight:"0.25"}]},{featureType:"road.arterial",elementType:"labels.icon",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"all",stylers:[{visibility:"off"}]},{featureType:"road.local",elementType:"geometry.fill",stylers:[{color:"#e9dddb"}]},{featureType:"road.local",elementType:"geometry.stroke",stylers:[{color:"#ef798e"},{weight:"0.5"},{visibility:"off"}]},{featureType:"transit",elementType:"all",stylers:[{visibility:"on"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#ef798e"}]},{featureType:"transit.line",elementType:"geometry.fill",stylers:[{weight:"2.06"}]},{featureType:"transit.line",elementType:"geometry.stroke",stylers:[{weight:"10.00"}]},{featureType:"transit.line",elementType:"labels.text.stroke",stylers:[{weight:"0.01"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{visibility:"on"},{weight:"10.00"},{color:"#439aa5"}]},{featureType:"water",elementType:"labels",stylers:[{visibility:"on"},{color:"#32485c"},{weight:"0.85"}]}],o={name:"Custom Style"},t=new google.maps.StyledMapType(e,o);f.mapTypes.set(y,t)}function m(){void 0===f&&(f=new google.maps.Map(t[0],T)),d(),u(),o.$emit("mapInit",f),c(),i(),p(),g(),s()}var f,y="custom_style",w=({url:"https://catchme.ifyoucan.com/images/pictures/IYC_Icons/IYC_Location_Icon_Small.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(1,1)},{url:"http://www.clker.com/cliparts/U/P/j/M/I/i/x-mark-yellow-md.png",size:new google.maps.Size(100,100),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)}),h=new google.maps.LatLng(34.06148453403353,-118.2785067220459);isNaN(window.localStorage.latitude)||isNaN(window.localStorage.longitude)||(h=new google.maps.LatLng(window.localStorage.latitude,window.localStorage.longitude));var v,T={center:h,zoom:12,MapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:!1,streetViewControl:!1,mapTypeControl:!1,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,y]},mapTypeId:y},S=[],L=[];m()};return{restrict:"A",template:'<div id="map-canvas"></div>',replace:!0,link:a}}]),angular.module("app").service("UtilSvc",function(){var e=this;e.deg2rad=function(e){return e*(Math.PI/180)},e.getDistanceFromLatLonInKm=function(o,t,n,a){var l=6371,r=e.deg2rad(n-o),s=e.deg2rad(a-t),i=Math.sin(r/2)*Math.sin(r/2)+Math.cos(e.deg2rad(o))*Math.cos(e.deg2rad(n))*Math.sin(s/2)*Math.sin(s/2),c=2*Math.atan2(Math.sqrt(i),Math.sqrt(1-i)),g=l*c;return g}}),angular.module("app").controller("PostsCtrl",["$scope","PostsSvc","$window","$document",function(e,o,t,n){e.$emit("pagechange",e.pageId.post),e.posts=[];var a=0,l=10;e.moveToLoc=function(o){var t=e.posts[o],a=angular.fromJson(t.sexLocation),l=new google.maps.LatLng(a.lat,a.lon);e.map.panTo(l),e.map.setZoom(16);var r=0,s=480;n.scrollTop(r,s).then(function(){console&&console.log("You just scrolled to the top!")})},e.addPost=function(){var t=e.sexPlaceAutocompleted,n=e.postLocation;console.log("location:"+n.lat+","+n.lon+"\n place:"+t);var a=JSON.stringify(n);console.log(e.sexTime),o.create({userName:void 0,userAge:void 0,sexPlace:t,sexTime:e.sexTime,sexTarget:e.sexTarget,sexLocation:a}).success(function(o){google.maps.event.trigger(e.map,"maptypeid_changed"),e.posts.unshift(o),e.sexTime=null,e.sexTarget=null}).error(function(e,o){401==o?swal("Log-in failed","Please log in","error"):swal("Post failed","Please complete the from correctly","error")})},e.requestFetch=function(){o.fetch(a,l).success(function(o){a++,console.log("Posts have been loaded successfully for front page"),e.posts=e.posts.concat(o)})},e.requestFetch()}]),angular.module("app").service("PostsSvc",["$http",function(e){this.fetchAll=function(){return e.get("/api/posts")},this.fetch=function(o,t){var n="/api/posts/"+o+"?perpage="+t;return e.get(n)},this.create=function(o){return e.post("/api/posts",o)}}]),angular.module("app").controller("AccountCtrl",["$scope","$location","UserSvc",function(e,o,t){e.$emit("pagechange",e.pageId.account),e.changePassword=function(e,n){t.changePassword(e,n).then(function(){swal("","Password have been changed","success"),o.path("/")},function(e){401==e.status?swal("","Original password is wrong.","error"):swal("","Can not change password.","error")})}}]),angular.module("app").controller("LoginCtrl",["$rootScope","$scope","$location","UserSvc",function(e,o,t,n){o.$emit("pagechange",o.pageId.login),o.login=function(o,a){n.login(o,a).then(function(o){t.path("/"),e.$emit("login",o)},function(e){swal("Log-in failed!","Password/ID wrong","error")})}}]),angular.module("app").controller("RegisterCtrl",["$scope","$location","UserSvc",function(e,o,t){e.$emit("pagechange",e.pageId.register),e.register=function(n,a,l,r){t.register(n,a,l,r).then(function(t){swal("OK!","Successfully registered","success"),o.path("/"),e.$emit("login",t)},function(e){swal("Register failed!","Username already exists","error")})}}]),angular.module("app").service("UserSvc",["$http","$rootScope",function(e,o){var t=this;t.getUser=function(){return e.get("/api/users",{headers:{"X-Auth":e.defaults.headers.common["X-Auth"]}}).then(function(e){return e.data},function(e){currentUser=void 0})},t.remainLogin=function(){if(console.log("Token:",localStorage.getItem("token")),console.log("Application has been launched"),"undefined"!=window.localStorage.getItem("token")&&"null"!=window.localStorage.getItem("token")&&window.localStorage.getItem("token")){e.defaults.headers.common["X-Auth"]=window.localStorage.getItem("token"),console.log("Remain Login in process..");t.getUser().then(function(e){o.$emit("login",e)},function(e){console.log(e),currentUser=void 0})}},t.changePassword=function(o,t){return e.get("/api/users",{headers:{"X-Auth":e.defaults.headers.common["X-Auth"]}}).then(function(n){return e.post("/api/users/password_change",{password:t,newPassword:o,username:n.data.userName})})},t.login=function(o,n){return e.post("/api/sessions",{username:o,password:n}).then(function(o){return window.localStorage.token=o.data,e.defaults.headers.common["X-Auth"]=o.data,t.getUser()})},t.register=function(o,n,a,l){return e.post("/api/users",{userName:o,password:n,userdob:a,sexPos:l}).then(function(){return t.login(o,n)})},t.logout=function(){window.localStorage.longitude=void 0,window.localStorage.latitude=void 0,window.localStorage.token=void 0,e.defaults.headers.common["X-Auth"]=void 0}}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJtYXAvbWFwLmRpcmVjdGl2ZS5qcyIsIm1hcC91dGlsLnN2Yy5qcyIsInBvc3RzL3Bvc3RzLmN0cmwuanMiLCJwb3N0cy9wb3N0cy5zdmMuanMiLCJ1c2VyL2FjY291bnQuY3RybC5qcyIsInVzZXIvbG9naW4uY3RybC5qcyIsImFwcC5qcyIsInVzZXIvcmVnaXN0ZXIuY3RybC5qcyIsInVzZXIvdXNlci5zdmMuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkcm9vdFNjb3BlIiwiJHNjb3BlIiwiJHdpbmRvdyIsIlVzZXJTdmMiLCJwYWdlSWQiLCJwb3N0IiwicmVnaXN0ZXIiLCJsb2dpbiIsImFjY291bnQiLCJuYXZDb2xsYXBzZWQiLCJjb2xsYXBzZSIsIm1vdmVUb0N1cnJlbnRMb2NhdGlvbiIsImdldEN1cnJMb2NTdWNjZXNzIiwicG9zIiwiY3VycmVudFBhZ2VJZCIsImNyZCIsImNvb3JkcyIsIndpbmRvdyIsImxvY2FsU3RvcmFnZSIsImxhdGl0dWRlIiwibG9uZ2l0dWRlIiwiZ29vZ2xlTG9jIiwiZ29vZ2xlIiwibWFwcyIsIkxhdExuZyIsImV2ZW50IiwidHJpZ2dlciIsIm1hcCIsInBhblRvIiwic2V0Wm9vbSIsImdldEN1cnJMb2NFcnJvciIsImVyciIsImNvbnNvbGUiLCJ3YXJuIiwiY29kZSIsIm1lc3NhZ2UiLCJuYXZpZ2F0b3IiLCJnZW9sb2NhdGlvbiIsImdldEN1cnJlbnRQb3NpdGlvbiIsInN3YWwiLCJ0aXRsZSIsInRleHQiLCJ0aW1lciIsInNob3dDb25maXJtQnV0dG9uIiwibG9nb3V0IiwiY3VycmVudFVzZXIiLCJ1bmRlZmluZWQiLCIkb24iLCJfIiwidXNlciIsImxvY2F0aW9uIiwibG9nIiwibGF0IiwibG9uIiwibG5nIiwicG9zdExvY2F0aW9uIiwicGxhY2UiLCIkJHBoYXNlIiwiJGFwcGx5Iiwic2V4UGxhY2VBdXRvY29tcGxldGVkIiwicmVtYWluTG9naW4iLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsImRpcmVjdGl2ZSIsIlBvc3RzU3ZjIiwiVXRpbFN2YyIsIiR0aW1lb3V0IiwiJGNvbXBpbGUiLCJsaW5rIiwic2NvcGUiLCJlbGVtZW50IiwiYXR0cnMiLCJkcmF3SGVscGVyTWFya2VyIiwibWFya2VyIiwiaSIsImhlbHBlck1hcmtlcnMiLCJzZXRNYXAiLCJNYXJrZXIiLCJwb3NpdGlvbiIsImljb24iLCJpbWFnZVRhcmdldCIsInB1c2giLCJkcmF3QW5kU2V0UGxhY2UiLCJpbmZvV2luZG93IiwiY2xvc2UiLCJnZW9jb2RlciIsIkdlb2NvZGVyIiwiJGVtaXQiLCJnZW9jb2RlIiwibGF0TG5nIiwicmVzdWx0cyIsInN0YXR1cyIsImZvcm1hdHRlZF9hZGRyZXNzIiwiZHJhd1Bvc3RNYXJrZXJzIiwicG9zdHMiLCJmZXRjaEFsbCIsInN1Y2Nlc3MiLCJyZXNwb25zZSIsImxlbmd0aCIsIm1hcmtlcnMiLCJfaWQiLCJmcm9tSnNvbiIsInNleExvY2F0aW9uIiwibWFya2VyT3B0aW9ucyIsInBhcmVudCIsImNoaWxkIiwiJG5ldyIsIm9wZW5XaW5kb3ciLCJjb250ZW50Iiwic2V4VGFyZ2V0Iiwic3Vic3RyaW5nIiwiYWdlIiwidXNlckFnZSIsImh0bWwiLCJjb21waWxlZCIsImluZm9XaW5kb3dPcHRpb25zIiwicGl4ZWxPZmZzZXQiLCJTaXplIiwiZGlzYWJsZUF1dG9QYW4iLCJJbmZvV2luZG93Iiwib3BlbiIsImFkZExpc3RlbmVyIiwic2V0U2VhcmNoQm94IiwiaW5wdXQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY3VyckxvY0J0biIsImNvbnRyb2xzIiwiQ29udHJvbFBvc2l0aW9uIiwiVE9QX0xFRlQiLCJUT1BfUklHSFQiLCJzZWFyY2hCb3giLCJwbGFjZXMiLCJTZWFyY2hCb3giLCJnZXRQbGFjZXMiLCJnZW9tZXRyeSIsInNldENsaWNrTWFwIiwic2V0TW92ZVRvQ3VycmVudExvY2F0aW9uIiwic2V0Q2VudGVyQ2hhbmdlZCIsImdldENlbnRlciIsInNldExvYWRQb3N0TWFya2VycyIsInNldFN0eWxlRm9yTWFwIiwiZmVhdHVyZU9wdHMiLCJmZWF0dXJlVHlwZSIsImVsZW1lbnRUeXBlIiwic3R5bGVycyIsInZpc2liaWxpdHkiLCJjb2xvciIsIndlaWdodCIsInN0eWxlZE1hcE9wdGlvbnMiLCJuYW1lIiwiY3VzdG9tTWFwVHlwZSIsIlN0eWxlZE1hcFR5cGUiLCJtYXBUeXBlcyIsInNldCIsIkNMT1VEX01BUF9JRCIsImluaXRNYXAiLCJNYXAiLCJtYXBPcHRpb25zIiwidXJsIiwic2l6ZSIsIm9yaWdpbiIsIlBvaW50IiwiYW5jaG9yIiwic2NhbGVkU2l6ZSIsImluaXRpYWxNYXBDZW50ZXIiLCJpc05hTiIsImNlbnRlciIsInpvb20iLCJNYXBUeXBlSWQiLCJST0FETUFQIiwic2Nyb2xsd2hlZWwiLCJzdHJlZXRWaWV3Q29udHJvbCIsIm1hcFR5cGVDb250cm9sIiwibWFwVHlwZUNvbnRyb2xPcHRpb25zIiwibWFwVHlwZUlkcyIsIm1hcFR5cGVJZCIsInJlc3RyaWN0IiwidGVtcGxhdGUiLCJyZXBsYWNlIiwic2VydmljZSIsInN2YyIsInRoaXMiLCJkZWcycmFkIiwiZGVnIiwiTWF0aCIsIlBJIiwiZ2V0RGlzdGFuY2VGcm9tTGF0TG9uSW5LbSIsImxhdDEiLCJsb24xIiwibGF0MiIsImxvbjIiLCJSIiwiZExhdCIsImRMb24iLCJhIiwic2luIiwiY29zIiwiYyIsImF0YW4yIiwic3FydCIsImQiLCIkZG9jdW1lbnQiLCJfcGFnZSIsIl9wZXJQYWdlIiwibW92ZVRvTG9jIiwiaWQiLCJ0b3AiLCJkdXJhdGlvbiIsInNjcm9sbFRvcCIsInRoZW4iLCJhZGRQb3N0IiwibG9jYXRpb25KU09OIiwiSlNPTiIsInN0cmluZ2lmeSIsInNleFRpbWUiLCJjcmVhdGUiLCJ1c2VyTmFtZSIsInNleFBsYWNlIiwidW5zaGlmdCIsImVycm9yIiwiZGF0YSIsInJlcXVlc3RGZXRjaCIsImZldGNoIiwiY29uY2F0IiwiJGh0dHAiLCJnZXQiLCJwYWdlIiwicGVycGFnZSIsIiRsb2NhdGlvbiIsImNoYW5nZVBhc3N3b3JkIiwibmV3UGFzc3dvcmQiLCJwYXNzd29yZCIsInBhdGgiLCJ1c2VybmFtZSIsInVzZXJkb2IiLCJzZXhwb3MiLCJnZXRVc2VyIiwiaGVhZGVycyIsIlgtQXV0aCIsImRlZmF1bHRzIiwiY29tbW9uIiwiZ2V0SXRlbSIsInRva2VuIiwic2V4UG9zIl0sIm1hcHBpbmdzIjoiQUFDQUEsUUFBQUMsT0FBQSxPQUNBLFVBQ0EsV0FDQSxvQkNIQUQsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLG1CQUFBLGFBQUEsU0FBQSxVQUFBLFVBQUEsU0FBQUMsRUFBQUMsRUFBQUMsRUFBQUMsR0FDQUYsRUFBQUcsUUFDQUMsS0FBQSxFQUNBQyxTQUFBLEVBQ0FDLE1BQUEsRUFDQUMsUUFBQSxHQUdBUCxFQUFBUSxjQUFBLEVBQ0FSLEVBQUFTLFNBQUEsV0FDQVQsRUFBQVEsY0FBQSxHQUlBUixFQUFBVSxzQkFBQSxXQUNBLFFBQUFDLEdBQUFDLEdBRUEsR0FBQVosRUFBQWEsZUFBQWIsRUFBQUcsT0FBQUMsS0FBQSxDQUdBLEdBQUFVLEdBQUFGLEVBQUFHLE1BRUFDLFFBQUFDLGFBQUFDLFNBQUFKLEVBQUFJLFNBQ0FGLE9BQUFDLGFBQUFFLFVBQUFMLEVBQUFLLFNBS0EsSUFBQUMsR0FBQSxHQUFBQyxRQUFBQyxLQUFBQyxPQUFBVCxFQUFBSSxTQUFBSixFQUFBSyxVQUVBRSxRQUFBQyxLQUFBRSxNQUFBQyxRQUFBekIsRUFBQTBCLElBQUEsa0JBQUFOLEdBRUFwQixFQUFBMEIsSUFBQUMsTUFBQVAsR0FDQXBCLEVBQUEwQixJQUFBRSxRQUFBLEtBR0EsUUFBQUMsR0FBQUMsR0FDQUMsUUFBQUMsS0FBQSxTQUFBRixFQUFBRyxLQUFBLE1BQUFILEVBQUFJLFNBSUFDLFVBQUFDLFlBQUFDLG1CQUFBMUIsRUFBQWtCLEdBRUFTLE1BQUFDLE1B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SUMsV0FLTnlJLEVBQUVpRCxlQUFhLFNBQUFDLEVBQUFDLEdBQ2QsTUFBRVAsR0FBUUMsSUFBSSxjQUViWSxTQUFVQyxTQUFVZCxFQUFNZSxTQUFTRixRQUFRRyxPQUFPLGFBRWxEL0IsS0FBSyxTQUFTbkssR0FDZCxNQUFPa0wsR0FBTTlOLEtBQUssOEJBRW5CcU8sU0FBYUEsRUFDYkQsWUFBQUEsRUFDQ0csU0FBVTNMLEVBQVU4SyxLQUFBSixjQVN0QnBDLEVBQUloTCxNQUFRLFNBQVNxTyxFQUFVRixHQUM5QixNQUFPUCxHQUFNOU4sS0FBSyxpQkFFakJ1TyxTQUFVQSxFQUNWRixTQUFVQSxJQUVWdEIsS0FBSyxTQUFVakgsR0FHaEIsTUFGRGxGLFFBQUlDLGFBQWlCbU8sTUFBQWxKLEVBQVU0SCxLQUM5QkksRUFBT2UsU0FBTUYsUUFBS0csT0FBQSxVQUFBaEosRUFBQTRILEtBQ2xCeEMsRUFBQXdELGFBSUR4RCxFQUFFakwsU0FBSyxTQUFVc08sRUFBU0YsRUFBQUcsRUFBQUMsR0FDekIsTUFBQ1gsR0FBTzlOLEtBQUEsY0FFUHNOLFNBQU9pQixFQUNQRixTQUFVQSxFQUNWRyxRQUFVQSxFQUNWUyxPQUFVUixJQUVYMUIsS0FBQSxXQUNBLE1BQUE3QixHQUFBaEwsTUFBQXFPLEVBQUFGLE1BSURuRCxFQUFFM0ksT0FBVSxXQUNYM0IsT0FBT0MsYUFBYUUsVUFBWTBCLE9BQ2hDN0IsT0FBTUMsYUFBV0MsU0FBQTJCLE9BQ2pCN0IsT0FBQ0MsYUFBaUJtTyxNQUFVdk0sT0FDNUJxTCxFQUFNZSxTQUFTRixRQUFRRyxPQUFPLFVBQVlyTSIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG5cdCduZ1JvdXRlJyxcblx0J2R1U2Nyb2xsJyxcblx0J2luZmluaXRlLXNjcm9sbCdcbl0pO1xuIiwiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBcHBsaWNhdGlvbkN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICR3aW5kb3csIFVzZXJTdmMpe1xuXHQkc2NvcGUucGFnZUlkID0geyBcblx0XHRwb3N0ICAgICA6IDAsXG5cdFx0cmVnaXN0ZXIgOiAxLFxuXHRcdGxvZ2luICAgIDogMixcblx0XHRhY2NvdW50ICA6IDMsIFxuXHR9O1xuXG5cdCRzY29wZS5uYXZDb2xsYXBzZWQgPSB0cnVlO1xuXHQkc2NvcGUuY29sbGFwc2UgPSBmdW5jdGlvbigpe1xuXHRcdCRzY29wZS5uYXZDb2xsYXBzZWQgPSB0cnVlO1xuXHR9O1xuXG5cdC8qIG1vdmUgdG8gY3VycmVudCBsb2NhdGlvbiAqL1xuXHQkc2NvcGUubW92ZVRvQ3VycmVudExvY2F0aW9uID0gZnVuY3Rpb24oKXtcblx0XHRmdW5jdGlvbiBnZXRDdXJyTG9jU3VjY2Vzcyhwb3MpIHtcbiAgICAgICAgICAgIC8qIG1ha2Ugc3VyZSB0byBjaGVjayB3ZSBhcmUgb24gcG9zdCBwYWdlIHdpdGggbWFwIGZpcnN0ICovXG4gICAgICAgICAgICBpZiAoJHNjb3BlLmN1cnJlbnRQYWdlSWQgIT0gJHNjb3BlLnBhZ2VJZC5wb3N0KVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgdmFyIGNyZCA9IHBvcy5jb29yZHM7XG5cbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgPSBjcmQubGF0aXR1ZGU7XG4gICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IGNyZC5sb25naXR1ZGU7XG5cbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ0xhdGl0dWRlIDogJyArIGNyZC5sYXRpdHVkZSk7XG4gICAgICAgICAgICAvL2NvbnNvbGUubG9nKCdMb25naXR1ZGU6ICcgKyBjcmQubG9uZ2l0dWRlKTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ01vcmUgb3IgbGVzcyAnICsgY3JkLmFjY3VyYWN5ICsgJyBtZXRlcnMuJyk7XG4gICAgICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhjcmQubGF0aXR1ZGUsIGNyZC5sb25naXR1ZGUpO1xuXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5tYXAsICdoZWFkaW5nX2NoYW5nZWQnLCBnb29nbGVMb2MpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAkc2NvcGUubWFwLnBhblRvKGdvb2dsZUxvYylcbiAgICAgICAgICAgICRzY29wZS5tYXAuc2V0Wm9vbSgxNSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRDdXJyTG9jRXJyb3IoZXJyKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oJ0VSUk9SKCcgKyBlcnIuY29kZSArICcpOiAnICsgZXJyLm1lc3NhZ2UpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogaW5pdCBtYXAgYW5kIHBsYWNlIHNvbWUgbWFya2Vycywgc28gZXZlcnl0aGluZyBzdGFydCB3aXRoIHRoaXMgZnVuY3Rpb24uICovXG4gICAgICAgIG5hdmlnYXRvci5nZW9sb2NhdGlvbi5nZXRDdXJyZW50UG9zaXRpb24oZ2V0Q3VyckxvY1N1Y2Nlc3MsIGdldEN1cnJMb2NFcnJvcik7XG5cbiAgICAgICAgc3dhbCh7ICAgdGl0bGU6IFwiXCIsICAgdGV4dDogXCJNb3ZpbmcgdG8gY3VycmVudCBsb2NhdGlvbi4uXCIsICAgdGltZXI6IDE1MDAsICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlIH0pO1xuXHR9O1xuXG5cdCRzY29wZS5sb2dvdXQgPSBmdW5jdGlvbigpe1xuXHRcdCRzY29wZS5jb2xsYXBzZSgpO1xuXG5cdFx0JHNjb3BlLmN1cnJlbnRVc2VyID0gdW5kZWZpbmVkO1xuXG5cdFx0VXNlclN2Yy5sb2dvdXQoKTtcblxuXHRcdHN3YWwoJycsXCJTdWNjZXNzZnVsbHkgbG9nZ2VkIG91dFwiKTtcblx0fTtcblxuXHQvKiB1c2luZyByb290U2NvcGUgc28gdGhhdCBVc2VyU3ZjIGNhbiBlbWl0IGEgYnJvYWRjYXN0ICovXG5cdCRyb290U2NvcGUuJG9uKCdsb2dpbicsIGZ1bmN0aW9uKF8sIHVzZXIpe1xuXHRcdCRzY29wZS5jdXJyZW50VXNlciA9IHVzZXI7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ2xvYycsIGZ1bmN0aW9uKF8sIGxvY2F0aW9uKXtcblx0XHRjb25zb2xlLmxvZyhsb2NhdGlvbik7XG5cdFx0dmFyIGxhdCA9IGxvY2F0aW9uLmxhdCgpO1xuXHRcdHZhciBsb24gPSBsb2NhdGlvbi5sbmcoKTtcblx0XHQkc2NvcGUucG9zdExvY2F0aW9uID0ge1xuXHRcdFx0bGF0OiBsYXQsXG5cdFx0XHRsb246IGxvblxuXHRcdH07XG5cdFx0Y29uc29sZS5sb2coJHNjb3BlLnBvc3RMb2NhdGlvbik7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3BhZ2VjaGFuZ2UnLCBmdW5jdGlvbihfLCBwYWdlSWQpe1xuXHRcdCRzY29wZS5jdXJyZW50UGFnZUlkID0gcGFnZUlkO1xuXHR9KTtcblxuXHQkc2NvcGUuJG9uKCdwbGFjZScsIGZ1bmN0aW9uKF8sIHBsYWNlKXtcblx0XHQvLyBGb3JjaW5nIHRoZSB1cGRhdGUgd2l0aCAkYXBwbHkoKSBtZXRob2Qgb24gJHNjb3BlXG5cdFx0Ly8gcHJvYmxlbSByZWxhdGVkIG5vdGU6IGh0dHA6Ly93d3cuamVmZnJ5aG91c2VyLmNvbS9pbmRleC5jZm0vMjAxNC82LzIvSG93LWRvLUktcnVuLWNvZGUtd2hlbi1hLXZhcmlhYmxlLWNoYW5nZXMtd2l0aC1Bbmd1bGFySlNcblx0XHRpZighJHNjb3BlLiQkcGhhc2UpIHsgLy8gY2hlY2sgaWYgYSAkZGlnZXN0IGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3MgYnkgY2hlY2tpbmcgJHNjb3BlLiQkcGhhc2UuXG5cdFx0XHQkc2NvcGUuJGFwcGx5KGZ1bmN0aW9uKCl7XG5cdFx0XHRcdFx0JHNjb3BlLnNleFBsYWNlQXV0b2NvbXBsZXRlZCA9IHBsYWNlO1xuXHRcdFx0XHR9XG5cdFx0XHQpO1xuXHRcdH1cblxuXHR9KTtcblxuXHQkc2NvcGUuJG9uKCdtYXBJbml0JywgZnVuY3Rpb24oXywgbWFwKXtcblx0XHQkc2NvcGUubWFwID0gbWFwO1xuXHR9KTtcblxuXHRVc2VyU3ZjLnJlbWFpbkxvZ2luKCk7XG59KTsiLCJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbmZpZyhmdW5jdGlvbiAoJHJvdXRlUHJvdmlkZXIpe1xuXHQkcm91dGVQcm92aWRlclxuXHQud2hlbignLycsIFxuXHRcdHtcblx0XHRcdGNvbnRyb2xsZXI6ICdQb3N0c0N0cmwnLCBcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9wb3N0cy5odG1sJ1xuXHRcdH0pXG5cdC53aGVuKCcvcmVnaXN0ZXInLCBcblx0XHR7XG5cdFx0XHRjb250cm9sbGVyOiAnUmVnaXN0ZXJDdHJsJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9yZWdpc3Rlci5odG1sJ1xuXHRcdH0pXG5cdC53aGVuKCcvbG9naW4nLFxuXHRcdHtcblx0XHRcdGNvbnRyb2xsZXI6ICdMb2dpbkN0cmwnLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL2xvZ2luLmh0bWwnXG5cdFx0fSlcblx0LndoZW4oJy9hY2NvdW50Jyxcblx0XHR7XG5cdFx0XHRjb250cm9sbGVyOiAnQWNjb3VudEN0cmwnLFxuXHRcdFx0dGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL2FjY291bnQuaHRtbCdcblx0XHR9KVxuXHQvLyBSZWRpcmVjdCB0byB0aGUgcm9vdCBwYWdlLlxuXHQvKlxuXHQub3RoZXJ3aXNlKFxuXHRcdHtcbiAgIFx0XHRcdHJlZGlyZWN0VG86ICcvJ1xuXHRcdH0pOyovXG59KTtcbiIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdhcHBNYXAnLCBmdW5jdGlvbihQb3N0c1N2YywgVXRpbFN2YywgJHRpbWVvdXQsICRjb21waWxlKSB7XG4gICAgLy8gZGlyZWN0aXZlIGxpbmsgZnVuY3Rpb25cbiAgICB2YXIgbGluayA9IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICB2YXIgbWFwO1xuXG4gICAgICAgIHZhciBDTE9VRF9NQVBfSUQgPSAnY3VzdG9tX3N0eWxlJzsgLy8gbWFwIHN0eWxlXG4gICAgICAgIFxuICAgICAgICB2YXIgaW1hZ2VQb3N0ID0ge1xuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9jYXRjaG1lLmlmeW91Y2FuLmNvbS9pbWFnZXMvcGljdHVyZXMvSVlDX0ljb25zL0lZQ19Mb2NhdGlvbl9JY29uX1NtYWxsLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxLCAxKVxuICAgICAgICB9O1xuXG4gICAgICAgICB2YXIgaW1hZ2VUYXJnZXQgPSB7XG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vd3d3LmNsa2VyLmNvbS9jbGlwYXJ0cy9VL1Avai9NL0kvaS94LW1hcmsteWVsbG93LW1kLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgyNSwgMjUpXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gbWFwIGNvbmZpZ1xuICAgICAgICAvL2NvbnNvbGUubG9nKCd3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlICcsIHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgKTtcblxuICAgICAgICB2YXIgaW5pdGlhbE1hcENlbnRlciA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoMzQuMDYxNDg0NTM0MDMzNTMsIC0xMTguMjc4NTA2NzIyMDQ1OSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWlzTmFOKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUpICYmICFpc05hTih3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGluaXRpYWxNYXBDZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUsIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY29uc29sZS5sb2coJ3dpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgJywgd2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSApO1xuICAgICAgICBcbiAgICAgICAgLy9jb25zb2xlLmxvZyhpbml0aWFsTWFwQ2VudGVyKTtcblxuICAgICAgICB2YXIgbWFwT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICBjZW50ZXIgICAgICA6IGluaXRpYWxNYXBDZW50ZXIsXG4gICAgICAgICAgICAgICAgem9vbSAgICAgICAgOiAxMixcbiAgICAgICAgICAgICAgICBNYXBUeXBlSWQgICA6IGdvb2dsZS5tYXBzLk1hcFR5cGVJZC5ST0FETUFQLFxuICAgICAgICAgICAgICAgIHNjcm9sbHdoZWVsIDogZmFsc2UsXG4gICAgICAgICAgICAgICAgc3RyZWV0Vmlld0NvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG1hcFR5cGVDb250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBtYXBUeXBlQ29udHJvbE9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICBtYXBUeXBlSWRzOiBbZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVAsIENMT1VEX01BUF9JRF1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBtYXBUeXBlSWQ6IENMT1VEX01BUF9JRFxuICAgICAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIC8vIGRyYXcgbWFwIHdpdGggaGVscGVyIG1hcmtlcnNcbiAgICAgICAgdmFyIGhlbHBlck1hcmtlcnMgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gZHJhd0hlbHBlck1hcmtlcihsb2NhdGlvbil7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWFya2VyOyBtYXJrZXIgPSBoZWxwZXJNYXJrZXJzW2ldOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbiwgXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VUYXJnZXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaGVscGVyTWFya2Vycy5wdXNoKG1hcmtlcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVIZWxwZXJNYXJrZXIoKXtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBtYXJrZXI7IG1hcmtlciA9IGhlbHBlck1hcmtlcnNbaV07IGkrKykge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoZWxwZXJNYXJrZXJzID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIG9ubHkgZW5hYmxlIHdoZW4gbG9nZ2VkIGluXG4gICAgICAgICAgICBpZiAoIXNjb3BlLmN1cnJlbnRVc2VyKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgaWYgKGluZm9XaW5kb3cpXG4gICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5jbG9zZSgpO1xuXG4gICAgICAgICAgICB2YXIgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGxvY2F0aW9uIGluZm9yKGxvbixsYXQpXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnbG9jJywgbG9jYXRpb24pO1xuXG4gICAgICAgICAgICBkcmF3SGVscGVyTWFya2VyKGxvY2F0aW9uKTtcblxuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IHBsYWNlIGZvcm1hdHRlZF9hZGRyZXNzIGFuZCBkcmF3IGljb25cbiAgICAgICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoIHsgJ2xhdExuZyc6IGxvY2F0aW9uIH0sIGZ1bmN0aW9uKHJlc3VsdHMsIHN0YXR1cykge1xuICAgICAgICAgICAgICAgIC8vIGFzIHVzZXIgY2xpY2tzIG9uIHRoZSBtYXAsXG4gICAgICAgICAgICAgICAgLy8gd2UgaGF2ZSB0byBzYXZlIHRoZSBmb3JtYXR0ZWQgYWRkcmVzcyBpbiAkc2NvcGUgYW5kXG4gICAgICAgICAgICAgICAgLy8gaXQgd2lsbCBiZSB1c2VkIHRocm91Z2ggcG9zdHMuY3RybFxuICAgICAgICAgICAgICAgIC8vIGVtaXQgYnJvYWRjYXNlICdwbGFjZScgYW5kIHNlbmQgdGhpcyB0byBhcHBsaWNhdGlvbi5jdHJsXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGZvcm1hdHRlZF9hZGRyZXNzXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdwbGFjZScsIHJlc3VsdHNbMV0uZm9ybWF0dGVkX2FkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2goZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHN3YWwoXCJcIixcIkxvY2F0aW9uIGRvZXMgbm90IGV4aXN0c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3BsYWNlJywgXCJMb2NhdGlvbiBkb2VzIG5vdCBleGlzdHNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAgLy8gcGxhY2UgYSBtYXJrZXIgYW5kIGluZm9XaW5kb3dcbiAgICAgICAgdmFyIGluZm9XaW5kb3c7XG4gICAgICAgIHZhciBtYXJrZXJzID0gW107XG5cbiAgICAgICAgZnVuY3Rpb24gZHJhd1Bvc3RNYXJrZXJzKCkge1xuICAgICAgICAgICAgdmFyIHBvc3RzID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgUG9zdHNTdmMuZmV0Y2hBbGwoKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHBvc3RzID0gcmVzcG9uc2U7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvc3RzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvc3QgPSBwb3N0c1tpXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAobWFya2Vyc1tpXSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFya2Vyc1tpXS5wb3N0Ll9pZCA9PSBwb3N0Ll9pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy9pZiAoIXBvc3QuaGFzT3duUHJvcGVydHkoJ3NleExvY2F0aW9uJykpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IGFuZ3VsYXIuZnJvbUpzb24ocG9zdC5zZXhMb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBnb29nbGVMb2MsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIlNleFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy9pY29uOiBpbWFnZVBvc3RcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcihtYXJrZXJPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIG1hcmtlciB0byBhcnJheVxuICAgICAgICAgICAgICAgICAgICBtYXJrZXJzLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyOiBtYXJrZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdCAgOiBwb3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gc2NvcGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IHBhcmVudC4kbmV3KHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBvcGVuV2luZG93ID0gKGZ1bmN0aW9uKG1hcmtlciwgcG9zdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNsb3NlIHdpbmRvdyBpZiBub3QgdW5kZWZpbmVkXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mb1dpbmRvdyAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZC5jb250ZW50ID0gcG9zdC5zZXhUYXJnZXQuc3Vic3RyaW5nKDAsIDI0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZC5hZ2UgPSBwb3N0LnVzZXJBZ2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9ICc8ZGl2PiA8c3Ryb25nIGNsYXNzPVwicG9zdC1jb250ZW50XCI+XCInICsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuY29udGVudCArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcuLi5cIjwvc3Ryb25nPiAgIDxzcGFuIGNsYXNzPVwicG9zdC1jb250ZW50LWFnZVwiPkRhbmdlciBSYXRlIC0gICcgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZC5hZ2UgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcvMTAwPC9zcGFuPjwvZGl2Pic7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21waWxlZCA9ICRjb21waWxlKGh0bWwpKGNoaWxkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgd2luZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3dPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb21waWxlZFswXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpeGVsT2Zmc2V0OiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgwLCAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZUF1dG9QYW46IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coaW5mb1dpbmRvd09wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cub3BlbihtYXAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pKG1hcmtlciwgcG9zdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgb3BlbldpbmRvdygpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gbW91c2Ugb3ZlciB0byB2aWV3IHRoZSBwb3N0IGluZm9ybWF0aW9uIC0gY2xvc3VyZVxuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsIChmdW5jdGlvbihtYXJrZXIsIHBvc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjbG9zZSB3aW5kb3cgaWYgbm90IHVuZGVmaW5lZFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm9XaW5kb3cgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuY29udGVudCA9IHBvc3Quc2V4VGFyZ2V0LnN1YnN0cmluZygwLCAyNCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuYWdlID0gcG9zdC51c2VyQWdlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSAnPGRpdj4gPHN0cm9uZyBjbGFzcz1cInBvc3QtY29udGVudFwiPlwiJyArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLmNvbnRlbnQgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXCIuLi48L3N0cm9uZz4gICA8c3BhbiBjbGFzcz1cInBvc3QtY29udGVudC1hZ2VcIj5Kb3kgUmF0ZSAtICAnICsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuYWdlICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9zcGFuPjwvZGl2Pic7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21waWxlZCA9ICRjb21waWxlKGh0bWwpKGNoaWxkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgd2luZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3dPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb21waWxlZFswXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpeGVsT2Zmc2V0OiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgwLCAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZUF1dG9QYW46IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coaW5mb1dpbmRvd09wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cub3BlbihtYXAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pKG1hcmtlciwgcG9zdCkpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdXNlIG91dCB0byBjbG9zZSB0aGUgcG9zdCBpbmZvIHdpbmRvd1xuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdtb3VzZW91dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvV2luZG93KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7Ki9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZVBvc3RNYXJrZXIoKXtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBtYXJrZXI7IG1hcmtlciA9IG1hcmtlcnNbaV07IGkrKykge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXJrZXJzID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRTZWFyY2hCb3goKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgdGhlIHNlYXJjaCBib3ggYW5kIGxpbmsgaXQgdG8gdGhlIFVJIGVsZW1lbnQuXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhYy1pbnB1dCcpKTsgLy8gQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9ICBcbiAgICAgICAgICAgIHZhciBjdXJyTG9jQnRuID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tY3VycicpKTsgICAgICBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX0xFRlRdLnB1c2goaW5wdXQpO1xuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5UT1BfUklHSFRdLnB1c2goY3VyckxvY0J0bik7XG5cbiAgICAgICAgICAgIHZhciBzZWFyY2hCb3ggPSBuZXcgZ29vZ2xlLm1hcHMucGxhY2VzLlNlYXJjaEJveCgoaW5wdXQpKTsgLy8gQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9IFxuXG4gICAgICAgICAgICAvLyBMaXN0ZW4gZm9yIHRoZSBldmVudCBmaXJlZCB3aGVuIHRoZSB1c2VyIHNlbGVjdHMgYW4gaXRlbSBmcm9tIHRoZVxuICAgICAgICAgICAgLy8gcGljayBsaXN0LiBSZXRyaWV2ZSB0aGUgbWF0Y2hpbmcgcGxhY2VzIGZvciB0aGF0IGl0ZW0uXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihzZWFyY2hCb3gsICdwbGFjZXNfY2hhbmdlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBwbGFjZXMgPSBzZWFyY2hCb3guZ2V0UGxhY2VzKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAocGxhY2VzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gdGFrZSBvbmx5IDEgc3BvdFxuICAgICAgICAgICAgICAgIHZhciBwbGFjZSA9IHBsYWNlc1swXTtcblxuICAgICAgICAgICAgICAgIC8vIHdoZW4gc2VhcmNoIGhhcHBlbnMsIGxvY2F0aW9uIHdpbGwgYmUgdXBkYXRlZCBhcyB3ZWxsIGZvciBwb3N0XG4gICAgICAgICAgICAgICAgLy8gc2NvcGUuJGVtaXQoJ3BsYWNlJywgcGxhY2UuZm9ybWF0dGVkX2FkZHJlc3MpO1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG5cbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubGF0aXR1ZGU7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sb25naXR1ZGU7XG5cbiAgICAgICAgICAgICAgICBtYXAucGFuVG8ocGxhY2UuZ2VvbWV0cnkubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgIC8vbWFwLnNldFpvb20oMTYpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRDbGlja01hcCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGNsaWNrIGV2ZW50IG9uIG1hcFxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShldmVudC5sYXRMbmcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRNb3ZlVG9DdXJyZW50TG9jYXRpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBjbGljayBldmVudCBvbiBtYXBcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2hlYWRpbmdfY2hhbmdlZCcsIGZ1bmN0aW9uKGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgZHJhd0FuZFNldFBsYWNlKGxvY2F0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2VudGVyQ2hhbmdlZCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2NlbnRlcl9jaGFuZ2VkJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gbWFwLmdldENlbnRlcigpLmxhdCgpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlID0gbWFwLmdldENlbnRlcigpLmxuZygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgZnVuY3Rpb24gc2V0TG9hZFBvc3RNYXJrZXJzKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gbWFudWFsbHkgcmVsb2FkIG1hcmtlcnNcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ21hcHR5cGVpZF9jaGFuZ2VkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmVIZWxwZXJNYXJrZXIoKTtcbiAgICAgICAgICAgICAgICAvL3JlbW92ZVBvc3RNYXJrZXIoKTtcblxuICAgICAgICAgICAgICAgIGRyYXdQb3N0TWFya2VycygpOyBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0U3R5bGVGb3JNYXAoKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgZmVhdHVyZU9wdHMgPSBbe1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzQzOWFhNVwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhZG1pbmlzdHJhdGl2ZS5sb2NhbGl0eVwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzMyNDg1Y1wifSx7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlLm5laWdoYm9yaG9vZFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJsYW5kc2NhcGUubmF0dXJhbFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2U5ZGRkYlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJsYW5kc2NhcGUubmF0dXJhbC50ZXJyYWluXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaVwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pLnBhcmtcIixcImVsZW1lbnRUeXBlXCI6XCJhbGxcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pLnBhcmtcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjYzRlNjYxXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaS5wYXJrXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkLmhpZ2h3YXlcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZTlkZGRiXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuaGlnaHdheVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzMyNDg1Y1wifSx7XCJ3ZWlnaHRcIjpcIjAuN1wifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkLmFydGVyaWFsXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZTlkZGRiXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiMzMjQ4NWNcIn0se1wid2VpZ2h0XCI6XCIwLjI1XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNlOWRkZGJcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2VmNzk4ZVwifSx7XCJ3ZWlnaHRcIjpcIjAuNVwifSx7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2VmNzk4ZVwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcIndlaWdodFwiOlwiMi4wNlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wid2VpZ2h0XCI6XCIxMC4wMFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wid2VpZ2h0XCI6XCIwLjAxXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifSx7XCJ3ZWlnaHRcIjpcIjEwLjAwXCJ9LHtcImNvbG9yXCI6XCIjNDM5YWE1XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9uXCJ9LHtcImNvbG9yXCI6XCIjMzI0ODVjXCJ9LHtcIndlaWdodFwiOlwiMC44NVwifV19XTtcblxuICAgICAgICAgICAgdmFyIHN0eWxlZE1hcE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0N1c3RvbSBTdHlsZSdcbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGN1c3RvbU1hcFR5cGUgPSBuZXcgZ29vZ2xlLm1hcHMuU3R5bGVkTWFwVHlwZShmZWF0dXJlT3B0cywgc3R5bGVkTWFwT3B0aW9ucyk7XG4gICAgICAgICAgICBtYXAubWFwVHlwZXMuc2V0KENMT1VEX01BUF9JRCwgY3VzdG9tTWFwVHlwZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbml0IHRoZSBtYXBcbiAgICAgICAgZnVuY3Rpb24gaW5pdE1hcCgpIHtcbiAgICAgICAgICAgIGlmIChtYXAgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZWxlbWVudFswXSwgbWFwT3B0aW9ucyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNldFN0eWxlRm9yTWFwKCk7XG5cbiAgICAgICAgICAgIHNldExvYWRQb3N0TWFya2VycygpO1xuXG4gICAgICAgICAgICAvLyBicm9hZGNhc3QgdG8gc2VuZCBtYXAgdG8gYXBwbGljYXRpb24gY3RybFxuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ21hcEluaXQnLCBtYXApO1xuXG4gICAgICAgICAgICBzZXRDbGlja01hcCgpO1xuXG4gICAgICAgICAgICBzZXRTZWFyY2hCb3goKTtcblxuICAgICAgICAgICAgc2V0Q2VudGVyQ2hhbmdlZCgpO1xuXG4gICAgICAgICAgICBzZXRNb3ZlVG9DdXJyZW50TG9jYXRpb24oKTtcblxuICAgICAgICAgICAgZHJhd1Bvc3RNYXJrZXJzKCk7XG4gICAgICAgIH0gXG5cbiAgICAgICAgaW5pdE1hcCgpO1xuXG4gICAgICAgIC8qXG4gICAgICAgIGZ1bmN0aW9uIGdldEN1cnJMb2NTdWNjZXNzKHBvcykge1xuICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHRvIGNoZWNrIHdlIGFyZSBvbiBwb3N0IHBhZ2Ugd2l0aCBtYXAgZmlyc3RcbiAgICAgICAgICAgIGlmIChzY29wZS5jdXJyZW50UGFnZUlkICE9IHNjb3BlLnBhZ2VJZC5wb3N0KVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgc3dhbCh7ICAgXG4gICAgICAgICAgICAgICAgdGl0bGU6IFwiV2UgZm91bmQgeW91IVwiLCAgIFxuICAgICAgICAgICAgICAgIHRleHQ6IFwiRG8geW91IHdhbnQgdG8gbW92ZSB0byB5b3VyIGxvY2F0aW9uPyFcIiwgICBcbiAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLCAgIFxuICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogJyMwMEIyRUUnLCAgIFxuICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiBcIlllcywgbW92ZSBtZSFcIiwgICBcbiAgICAgICAgICAgICAgICBjbG9zZU9uQ29uZmlybTogZmFsc2UgLFxuICAgICAgICAgICAgfSwgXG4gICAgICAgICAgICBmdW5jdGlvbigpeyAgXG4gICAgICAgICAgICAgICAgc3dhbCh7dGl0bGU6IFwiXCIsIHRleHQ6IFwiWW91IGhhdmUgYmVlbiBtb3ZlZCFcIiwgdGltZXI6IDgwMCwgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBpZiB1c2VyIHdhbnRzIHRvIG1vdmUsIGxldCBpdCBoYXBwZW4hXG4gICAgICAgICAgICAgICAgdmFyIGNyZCA9IHBvcy5jb29yZHM7XG5cbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gY3JkLmxhdGl0dWRlO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlID0gY3JkLmxvbmdpdHVkZTtcblxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ0xhdGl0dWRlIDogJyArIGNyZC5sYXRpdHVkZSk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnTG9uZ2l0dWRlOiAnICsgY3JkLmxvbmdpdHVkZSk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnTW9yZSBvciBsZXNzICcgKyBjcmQuYWNjdXJhY3kgKyAnIG1ldGVycy4nKTtcbiAgICAgICAgICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhjcmQubGF0aXR1ZGUsIGNyZC5sb25naXR1ZGUpO1xuXG4gICAgICAgICAgICAgICAgZHJhd0FuZFNldFBsYWNlKGdvb2dsZUxvYyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbWFwLnBhblRvKGdvb2dsZUxvYylcbiAgICAgICAgICAgICAgICBtYXAuc2V0Wm9vbSgxNSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEN1cnJMb2NFcnJvcihlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRVJST1IoJyArIGVyci5jb2RlICsgJyk6ICcgKyBlcnIubWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbml0IG1hcCBhbmQgcGxhY2Ugc29tZSBtYXJrZXJzLCBzbyBldmVyeXRoaW5nIHN0YXJ0IHdpdGggdGhpcyBmdW5jdGlvbi5cbiAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihnZXRDdXJyTG9jU3VjY2VzcywgZ2V0Q3VyckxvY0Vycm9yKTtcblxuICAgICAgICAvLyBzd2FsKHsgICB0aXRsZTogXCJcIiwgICB0ZXh0OiBcIkdldHRpbmcgY3VycmVudCBsb2NhdGlvbi4uXCIsICAgdGltZXI6IDIwMDAsICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlIH0pO1xuICAgICAgICAqL1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IGlkPVwibWFwLWNhbnZhc1wiPjwvZGl2PicsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIGxpbms6IGxpbmtcbiAgICB9O1xufSk7XG5cbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1V0aWxTdmMnLCBmdW5jdGlvbigpe1xuXHR2YXIgc3ZjID0gdGhpcztcblxuXHRzdmMuZGVnMnJhZCA9IGZ1bmN0aW9uKGRlZykge1xuXHQgIHJldHVybiBkZWcgKiAoTWF0aC5QSS8xODApO1xuXHR9O1xuXG5cdHN2Yy5nZXREaXN0YW5jZUZyb21MYXRMb25JbkttID0gZnVuY3Rpb24gKGxhdDEsbG9uMSxsYXQyLGxvbjIpIHtcblx0ICB2YXIgUiA9IDYzNzE7XG5cdCAgdmFyIGRMYXQgPSBzdmMuZGVnMnJhZChsYXQyLWxhdDEpO1xuXHQgIHZhciBkTG9uID0gc3ZjLmRlZzJyYWQobG9uMi1sb24xKTsgXG5cdCAgdmFyIGEgPSBcblx0ICAgIE1hdGguc2luKGRMYXQvMikgKiBNYXRoLnNpbihkTGF0LzIpICtcblx0ICAgIE1hdGguY29zKHN2Yy5kZWcycmFkKGxhdDEpKSAqIE1hdGguY29zKHN2Yy5kZWcycmFkKGxhdDIpKSAqIFxuXHQgICAgTWF0aC5zaW4oZExvbi8yKSAqIE1hdGguc2luKGRMb24vMilcblx0ICAgIDsgXG5cdCAgdmFyIGMgPSAyICogTWF0aC5hdGFuMihNYXRoLnNxcnQoYSksIE1hdGguc3FydCgxLWEpKTsgXG5cdCAgdmFyIGQgPSBSICogYztcblx0ICByZXR1cm4gZDtcblx0fTtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxyLmNvbnRyb2xsZXIoJ1Bvc3RzQ3RybCcsIGZ1bmN0aW9uICgkc2NvcGUsIFBvc3RzU3ZjLCAkd2luZG93LCAkZG9jdW1lbnQpe1xyXHJcdC8qIGVtaXQgYnJvYWRjYXN0IGZvciBjdXJyZW50IHBhZ2VJZCAqL1xyXHQkc2NvcGUuJGVtaXQoJ3BhZ2VjaGFuZ2UnLCAkc2NvcGUucGFnZUlkLnBvc3QpO1xyXHJcdCRzY29wZS5wb3N0cyA9IFtdO1xyXHJcdHZhciBfcGFnZSA9IDA7XHJcdHZhciBfcGVyUGFnZSA9IDEwO1xyXHJcdC8qIG1vdmUgdG8gcG9zdCdzIGxvY2F0aW9uICovXHJcdCRzY29wZS5tb3ZlVG9Mb2MgPSBmdW5jdGlvbihpZCl7XHJcdFx0dmFyIHBvc3QgPSAoJHNjb3BlLnBvc3RzW2lkXSk7XHJcclx0XHR2YXIgbG9jYXRpb24gPSBhbmd1bGFyLmZyb21Kc29uKHBvc3Quc2V4TG9jYXRpb24pO1xyXHRcdHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcclxyXHRcdCRzY29wZS5tYXAucGFuVG8oZ29vZ2xlTG9jKTtcclx0XHQkc2NvcGUubWFwLnNldFpvb20oMTYpO1xyXHJcdFx0LyogdXNpbmcgYW5ndWxhci1zY3JvbGwgdG8gbW92ZSB0byB0aGUgdG9wIHNtb290aGx5ICovXHJcdFx0dmFyIHRvcCA9IDA7XHIgICAgXHR2YXIgZHVyYXRpb24gPSA0ODA7XHIgICAgXHQkZG9jdW1lbnQuc2Nyb2xsVG9wKHRvcCwgZHVyYXRpb24pLnRoZW4oZnVuY3Rpb24oKSB7XHIgICAgIFx0XHRjb25zb2xlICYmIGNvbnNvbGUubG9nKCdZb3UganVzdCBzY3JvbGxlZCB0byB0aGUgdG9wIScpO1xyICAgIFx0fSk7XHJcclx0XHQvKiR3aW5kb3cuc2Nyb2xsKDAsIDApOyovXHJcdH07XHJcclx0JHNjb3BlLmFkZFBvc3QgPSBmdW5jdGlvbigpIHtcclx0XHQvKiBnZXQgYXV0b2NvbXBsZXRlZCBwbGFjZSBhbmQgcmVzZXQoc2V0IHRvIHVuZGVmaW5lZCkgKi9cclx0XHR2YXIgcGxhY2UgPSAkc2NvcGUuc2V4UGxhY2VBdXRvY29tcGxldGVkO1xyXHRcdHZhciBsb2NhdGlvbiA9ICRzY29wZS5wb3N0TG9jYXRpb247XHJcclx0XHRjb25zb2xlLmxvZyhcImxvY2F0aW9uOlwiICsgbG9jYXRpb24ubGF0ICsgJywnICsgbG9jYXRpb24ubG9uICsgJ1xcbiBwbGFjZTonICsgcGxhY2UpO1xyXHRcdHZhciBsb2NhdGlvbkpTT04gPSBKU09OLnN0cmluZ2lmeShsb2NhdGlvbik7XHJcclx0XHRjb25zb2xlLmxvZygkc2NvcGUuc2V4VGltZSk7XHJcclx0XHRQb3N0c1N2Yy5jcmVhdGUoXHJcdFx0e1xyXHRcdFx0dXNlck5hbWU6IHVuZGVmaW5lZCxcclx0XHRcdHVzZXJBZ2U6ICB1bmRlZmluZWQsXHJcdFx0XHRzZXhQbGFjZTogcGxhY2UsXHJcdFx0XHRzZXhUaW1lOiAgJHNjb3BlLnNleFRpbWUsXHJcdFx0XHRzZXhUYXJnZXQ6ICRzY29wZS5zZXhUYXJnZXQsXHJcdFx0XHRzZXhMb2NhdGlvbjogbG9jYXRpb25KU09OXHJcdFx0fSlcclx0XHQuc3VjY2VzcyhmdW5jdGlvbihwb3N0KXtcclx0XHRcdC8qXHJcdFx0XHR2YXIgbXNnID0gXCJZb3Ugd2FudGVkIHRvIGhhdmUgc2V4IHdpdGggXCIgKyBcclx0XHRcdHBvc3Quc2V4VGFyZ2V0O1xyXHRcdFx0c3dhbChcIkdyZWF0IVwiLCBtc2csIFwic3VjY2Vzc1wiKTtcclxyXHRcdFx0LyogbWFudWFsbHkgcmVsb2FkIG1hcmtlcnMgXHJcdFx0XHR1c2luZyBtYXB0eXBlaWQgc2luY2UgaXRzIG1vc3QgbGVhc3QgdXNlZCBldmVudCwgLSBraW5kIG9mIGhhY2t5IHdheSB0byBkbyBpdFxyXHRcdFx0Ki9cclx0XHRcdGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIoJHNjb3BlLm1hcCwgJ21hcHR5cGVpZF9jaGFuZ2VkJyk7XHJcclx0XHRcdCRzY29wZS5wb3N0cy51bnNoaWZ0KHBvc3QpO1xyXHJcdFx0XHQvKiByZXNldCBpbnB1dCBmb3JtcyAqL1xyXHRcdFx0JHNjb3BlLnNleFRpbWUgID0gbnVsbDtcclx0XHRcdCRzY29wZS5zZXhUYXJnZXQgPSBudWxsO1xyXHRcdH0pXHJcdFx0LmVycm9yKGZ1bmN0aW9uKGRhdGEsIHN0YXR1cyl7XHJcdFx0XHRpZiAoc3RhdHVzID09IDQwMSlcclx0XHRcdHtcclx0XHRcdFx0c3dhbChcIkxvZy1pbiBmYWlsZWRcIiwgXCJQbGVhc2UgbG9nIGluXCIsIFwiZXJyb3JcIik7XHJcdFx0XHR9XHJcdFx0XHRlbHNlXHJcdFx0XHR7XHJcdFx0XHRcdHN3YWwoXCJQb3N0IGZhaWxlZFwiLCBcIlBsZWFzZSBjb21wbGV0ZSB0aGUgZnJvbSBjb3JyZWN0bHlcIiwgXCJlcnJvclwiKTtcclx0XHRcdH1cclx0XHR9KTtcclx0fTtcclxyXHQkc2NvcGUucmVxdWVzdEZldGNoID0gZnVuY3Rpb24oKSB7XHJcdFx0UG9zdHNTdmMuZmV0Y2goX3BhZ2UsIF9wZXJQYWdlKVxyXHRcdC5zdWNjZXNzKGZ1bmN0aW9uKHBvc3RzKXtcclx0XHRcdF9wYWdlKys7XHJcdFx0XHRjb25zb2xlLmxvZygnUG9zdHMgaGF2ZSBiZWVuIGxvYWRlZCBzdWNjZXNzZnVsbHkgZm9yIGZyb250IHBhZ2UnKTtcclx0XHRcdCRzY29wZS5wb3N0cyA9ICRzY29wZS5wb3N0cy5jb25jYXQocG9zdHMpO1xyXHRcdH0pO1xyXHR9O1xyXHJcdCRzY29wZS5yZXF1ZXN0RmV0Y2goKTtccn0pO1xyIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnUG9zdHNTdmMnLCBmdW5jdGlvbigkaHR0cCl7XG5cdHRoaXMuZmV0Y2hBbGwgPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJyk7XG5cdH07XG5cblx0dGhpcy5mZXRjaCA9IGZ1bmN0aW9uKHBhZ2UsIHBlcnBhZ2Upe1xuXHRcdHZhciB1cmwgPSAnL2FwaS9wb3N0cy8nICsgcGFnZSArICc/cGVycGFnZT0nICsgcGVycGFnZTtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KHVybCk7XG5cdH07XG5cblx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbihwb3N0KXtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHR9O1xufSk7IiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQWNjb3VudEN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRsb2NhdGlvbiwgVXNlclN2Yyl7XG5cdC8qIGVtaXQgYnJvYWRjYXN0IGZvciBjdXJyZW50IHBhZ2VJZCAqL1xuXHQkc2NvcGUuJGVtaXQoJ3BhZ2VjaGFuZ2UnLCAkc2NvcGUucGFnZUlkLmFjY291bnQpO1xuXG5cdCRzY29wZS5jaGFuZ2VQYXNzd29yZCA9IGZ1bmN0aW9uKG5ld1Bhc3N3b3JkLCBwYXNzd29yZCl7XG5cdFx0VXNlclN2Yy5jaGFuZ2VQYXNzd29yZChuZXdQYXNzd29yZCwgcGFzc3dvcmQpXG5cdFx0LnRoZW4oXG5cdFx0XHRmdW5jdGlvbigpe1xuXHRcdFx0XHRzd2FsKCcnLCBcIlBhc3N3b3JkIGhhdmUgYmVlbiBjaGFuZ2VkXCIsIFwic3VjY2Vzc1wiKTtcblx0XHRcdFx0JGxvY2F0aW9uLnBhdGgoJy8nKTtcblx0XHRcdH0sXG5cdFx0XHRmdW5jdGlvbihlcnIpe1xuXHRcdFx0XHRpZiAoZXJyLnN0YXR1cyA9PSA0MDEpXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRzd2FsKCcnLCBcIk9yaWdpbmFsIHBhc3N3b3JkIGlzIHdyb25nLlwiLCBcImVycm9yXCIpO1x0XG5cdFx0XHRcdH1cblx0XHRcdFx0ZWxzZVxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0c3dhbCgnJywgXCJDYW4gbm90IGNoYW5nZSBwYXNzd29yZC5cIixcImVycm9yXCIpO1xuXHRcdFx0XHR9XG5cdFx0XHR9XG5cdFx0KTtcblx0fTtcbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0xvZ2luQ3RybCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJGxvY2F0aW9uLCBVc2VyU3ZjKXtcblx0JHNjb3BlLiRlbWl0KCdwYWdlY2hhbmdlJywgJHNjb3BlLnBhZ2VJZC5sb2dpbik7XG5cblx0Ly8gVXNlclN2Y+yEnOu5hOyKpOydmCBsb2dpbu2VqOyImOyXkOyEnCDrsJvsnYAg7Jyg7KCA7KCV67O066W8XG5cdC8vIOy1nOyDgeychCDsvZjtirjroaTrn6zsnbggQXBwbGljYXRpb25DdHJs7J2YICRzY29wZeuhnCDqsJLsnYQg67O064K06riwIOychO2VnCDsoITtjIzrpbwg67O064K464ukLlxuXHQkc2NvcGUubG9naW4gPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQpe1xuXHRcdFVzZXJTdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKVxuXHRcdC50aGVuKGZ1bmN0aW9uICh1c2VyKXtcblx0XHRcdCRsb2NhdGlvbi5wYXRoKCcvJyk7XG5cdFx0XHQkcm9vdFNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpO1xuXHRcdH0sXG5cdFx0ZnVuY3Rpb24gKGVycm9yKXtcblx0XHRcdHN3YWwoXCJMb2ctaW4gZmFpbGVkIVwiLCBcIlBhc3N3b3JkL0lEIHdyb25nXCIsIFwiZXJyb3JcIik7XG5cdFx0fSk7XG5cdFx0Lyogb3IgaXQgY2FuIGJlIHRoaXNcblx0XHQuY2F0Y2goZnVuY3Rpb24gKCl7XG5cdFx0XHRhbGVydChcIklEIG9yIFBhc3N3b3JkIGlzIHdyb25nLlwiKTtcblx0XHR9KTtcblx0XHQqL1xuXHR9O1xufSk7XG4iLCJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG5cdCduZ1JvdXRlJyxcblx0J2R1U2Nyb2xsJyxcblx0J2luZmluaXRlLXNjcm9sbCdcbl0pO1xuXG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ0FwcGxpY2F0aW9uQ3RybCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdywgVXNlclN2Yyl7XG5cdCRzY29wZS5wYWdlSWQgPSB7IFxuXHRcdHBvc3QgICAgIDogMCxcblx0XHRyZWdpc3RlciA6IDEsXG5cdFx0bG9naW4gICAgOiAyLFxuXHRcdGFjY291bnQgIDogMywgXG5cdH07XG5cblx0JHNjb3BlLm5hdkNvbGxhcHNlZCA9IHRydWU7XG5cdCRzY29wZS5jb2xsYXBzZSA9IGZ1bmN0aW9uKCl7XG5cdFx0JHNjb3BlLm5hdkNvbGxhcHNlZCA9IHRydWU7XG5cdH07XG5cblx0LyogbW92ZSB0byBjdXJyZW50IGxvY2F0aW9uICovXG5cdCRzY29wZS5tb3ZlVG9DdXJyZW50TG9jYXRpb24gPSBmdW5jdGlvbigpe1xuXHRcdGZ1bmN0aW9uIGdldEN1cnJMb2NTdWNjZXNzKHBvcykge1xuICAgICAgICAgICAgLyogbWFrZSBzdXJlIHRvIGNoZWNrIHdlIGFyZSBvbiBwb3N0IHBhZ2Ugd2l0aCBtYXAgZmlyc3QgKi9cbiAgICAgICAgICAgIGlmICgkc2NvcGUuY3VycmVudFBhZ2VJZCAhPSAkc2NvcGUucGFnZUlkLnBvc3QpXG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICB2YXIgY3JkID0gcG9zLmNvb3JkcztcblxuICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSA9IGNyZC5sYXRpdHVkZTtcbiAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlID0gY3JkLmxvbmdpdHVkZTtcblxuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnTGF0aXR1ZGUgOiAnICsgY3JkLmxhdGl0dWRlKTtcbiAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ0xvbmdpdHVkZTogJyArIGNyZC5sb25naXR1ZGUpO1xuICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnTW9yZSBvciBsZXNzICcgKyBjcmQuYWNjdXJhY3kgKyAnIG1ldGVycy4nKTtcbiAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGNyZC5sYXRpdHVkZSwgY3JkLmxvbmdpdHVkZSk7XG5cbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LnRyaWdnZXIoJHNjb3BlLm1hcCwgJ2hlYWRpbmdfY2hhbmdlZCcsIGdvb2dsZUxvYyk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgICRzY29wZS5tYXAucGFuVG8oZ29vZ2xlTG9jKVxuICAgICAgICAgICAgJHNjb3BlLm1hcC5zZXRab29tKDE1KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEN1cnJMb2NFcnJvcihlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRVJST1IoJyArIGVyci5jb2RlICsgJyk6ICcgKyBlcnIubWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbml0IG1hcCBhbmQgcGxhY2Ugc29tZSBtYXJrZXJzLCBzbyBldmVyeXRoaW5nIHN0YXJ0IHdpdGggdGhpcyBmdW5jdGlvbi4gKi9cbiAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihnZXRDdXJyTG9jU3VjY2VzcywgZ2V0Q3VyckxvY0Vycm9yKTtcblxuICAgICAgICBzd2FsKHsgICB0aXRsZTogXCJcIiwgICB0ZXh0OiBcIk1vdmluZyB0byBjdXJyZW50IGxvY2F0aW9uLi5cIiwgICB0aW1lcjogMTUwMCwgICBzaG93Q29uZmlybUJ1dHRvbjogZmFsc2UgfSk7XG5cdH07XG5cblx0JHNjb3BlLmxvZ291dCA9IGZ1bmN0aW9uKCl7XG5cdFx0JHNjb3BlLmNvbGxhcHNlKCk7XG5cblx0XHQkc2NvcGUuY3VycmVudFVzZXIgPSB1bmRlZmluZWQ7XG5cblx0XHRVc2VyU3ZjLmxvZ291dCgpO1xuXG5cdFx0c3dhbCgnJyxcIlN1Y2Nlc3NmdWxseSBsb2dnZWQgb3V0XCIpO1xuXHR9O1xuXG5cdC8qIHVzaW5nIHJvb3RTY29wZSBzbyB0aGF0IFVzZXJTdmMgY2FuIGVtaXQgYSBicm9hZGNhc3QgKi9cblx0JHJvb3RTY29wZS4kb24oJ2xvZ2luJywgZnVuY3Rpb24oXywgdXNlcil7XG5cdFx0JHNjb3BlLmN1cnJlbnRVc2VyID0gdXNlcjtcblx0fSk7XG5cblx0JHNjb3BlLiRvbignbG9jJywgZnVuY3Rpb24oXywgbG9jYXRpb24pe1xuXHRcdGNvbnNvbGUubG9nKGxvY2F0aW9uKTtcblx0XHR2YXIgbGF0ID0gbG9jYXRpb24ubGF0KCk7XG5cdFx0dmFyIGxvbiA9IGxvY2F0aW9uLmxuZygpO1xuXHRcdCRzY29wZS5wb3N0TG9jYXRpb24gPSB7XG5cdFx0XHRsYXQ6IGxhdCxcblx0XHRcdGxvbjogbG9uXG5cdFx0fTtcblx0XHRjb25zb2xlLmxvZygkc2NvcGUucG9zdExvY2F0aW9uKTtcblx0fSk7XG5cblx0JHNjb3BlLiRvbigncGFnZWNoYW5nZScsIGZ1bmN0aW9uKF8sIHBhZ2VJZCl7XG5cdFx0JHNjb3BlLmN1cnJlbnRQYWdlSWQgPSBwYWdlSWQ7XG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ3BsYWNlJywgZnVuY3Rpb24oXywgcGxhY2Upe1xuXHRcdC8vIEZvcmNpbmcgdGhlIHVwZGF0ZSB3aXRoICRhcHBseSgpIG1ldGhvZCBvbiAkc2NvcGVcblx0XHQvLyBwcm9ibGVtIHJlbGF0ZWQgbm90ZTogaHR0cDovL3d3dy5qZWZmcnlob3VzZXIuY29tL2luZGV4LmNmbS8yMDE0LzYvMi9Ib3ctZG8tSS1ydW4tY29kZS13aGVuLWEtdmFyaWFibGUtY2hhbmdlcy13aXRoLUFuZ3VsYXJKU1xuXHRcdGlmKCEkc2NvcGUuJCRwaGFzZSkgeyAvLyBjaGVjayBpZiBhICRkaWdlc3QgaXMgYWxyZWFkeSBpbiBwcm9ncmVzcyBieSBjaGVja2luZyAkc2NvcGUuJCRwaGFzZS5cblx0XHRcdCRzY29wZS4kYXBwbHkoZnVuY3Rpb24oKXtcblx0XHRcdFx0XHQkc2NvcGUuc2V4UGxhY2VBdXRvY29tcGxldGVkID0gcGxhY2U7XG5cdFx0XHRcdH1cblx0XHRcdCk7XG5cdFx0fVxuXG5cdH0pO1xuXG5cdCRzY29wZS4kb24oJ21hcEluaXQnLCBmdW5jdGlvbihfLCBtYXApe1xuXHRcdCRzY29wZS5tYXAgPSBtYXA7XG5cdH0pO1xuXG5cdFVzZXJTdmMucmVtYWluTG9naW4oKTtcbn0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb25maWcoZnVuY3Rpb24gKCRyb3V0ZVByb3ZpZGVyKXtcblx0JHJvdXRlUHJvdmlkZXJcblx0LndoZW4oJy8nLCBcblx0XHR7XG5cdFx0XHRjb250cm9sbGVyOiAnUG9zdHNDdHJsJywgXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvcG9zdHMuaHRtbCdcblx0XHR9KVxuXHQud2hlbignL3JlZ2lzdGVyJywgXG5cdFx0e1xuXHRcdFx0Y29udHJvbGxlcjogJ1JlZ2lzdGVyQ3RybCcsXG5cdFx0XHR0ZW1wbGF0ZVVybDogJy90ZW1wbGF0ZXMvcmVnaXN0ZXIuaHRtbCdcblx0XHR9KVxuXHQud2hlbignL2xvZ2luJyxcblx0XHR7XG5cdFx0XHRjb250cm9sbGVyOiAnTG9naW5DdHJsJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9sb2dpbi5odG1sJ1xuXHRcdH0pXG5cdC53aGVuKCcvYWNjb3VudCcsXG5cdFx0e1xuXHRcdFx0Y29udHJvbGxlcjogJ0FjY291bnRDdHJsJyxcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9hY2NvdW50Lmh0bWwnXG5cdFx0fSlcblx0Ly8gUmVkaXJlY3QgdG8gdGhlIHJvb3QgcGFnZS5cblx0Lypcblx0Lm90aGVyd2lzZShcblx0XHR7XG4gICBcdFx0XHRyZWRpcmVjdFRvOiAnLydcblx0XHR9KTsqL1xufSk7XG5cblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uZGlyZWN0aXZlKCdhcHBNYXAnLCBmdW5jdGlvbihQb3N0c1N2YywgVXRpbFN2YywgJHRpbWVvdXQsICRjb21waWxlKSB7XG4gICAgLy8gZGlyZWN0aXZlIGxpbmsgZnVuY3Rpb25cbiAgICB2YXIgbGluayA9IGZ1bmN0aW9uKHNjb3BlLCBlbGVtZW50LCBhdHRycykge1xuICAgICAgICB2YXIgbWFwO1xuXG4gICAgICAgIHZhciBDTE9VRF9NQVBfSUQgPSAnY3VzdG9tX3N0eWxlJzsgLy8gbWFwIHN0eWxlXG4gICAgICAgIFxuICAgICAgICB2YXIgaW1hZ2VQb3N0ID0ge1xuICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9jYXRjaG1lLmlmeW91Y2FuLmNvbS9pbWFnZXMvcGljdHVyZXMvSVlDX0ljb25zL0lZQ19Mb2NhdGlvbl9JY29uX1NtYWxsLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxLCAxKVxuICAgICAgICB9O1xuXG4gICAgICAgICB2YXIgaW1hZ2VUYXJnZXQgPSB7XG4gICAgICAgICAgICB1cmw6ICdodHRwOi8vd3d3LmNsa2VyLmNvbS9jbGlwYXJ0cy9VL1Avai9NL0kvaS94LW1hcmsteWVsbG93LW1kLnBuZycsXG4gICAgICAgICAgICBzaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgxMDAsIDEwMCksXG4gICAgICAgICAgICBvcmlnaW46IG5ldyBnb29nbGUubWFwcy5Qb2ludCgwLCAwKSxcbiAgICAgICAgICAgIGFuY2hvcjogbmV3IGdvb2dsZS5tYXBzLlBvaW50KDE3LCAzNCksXG4gICAgICAgICAgICBzY2FsZWRTaXplOiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgyNSwgMjUpXG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gbWFwIGNvbmZpZ1xuICAgICAgICAvL2NvbnNvbGUubG9nKCd3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlICcsIHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgKTtcblxuICAgICAgICB2YXIgaW5pdGlhbE1hcENlbnRlciA9IG5ldyBnb29nbGUubWFwcy5MYXRMbmcoMzQuMDYxNDg0NTM0MDMzNTMsIC0xMTguMjc4NTA2NzIyMDQ1OSk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIWlzTmFOKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUpICYmICFpc05hTih3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGluaXRpYWxNYXBDZW50ZXIgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKHdpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUsIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vY29uc29sZS5sb2coJ3dpbmRvdy5sb2NhbFN0b3JhZ2UubGF0aXR1ZGUgJywgd2luZG93LmxvY2FsU3RvcmFnZS5sYXRpdHVkZSApO1xuICAgICAgICBcbiAgICAgICAgLy9jb25zb2xlLmxvZyhpbml0aWFsTWFwQ2VudGVyKTtcblxuICAgICAgICB2YXIgbWFwT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICBjZW50ZXIgICAgICA6IGluaXRpYWxNYXBDZW50ZXIsXG4gICAgICAgICAgICAgICAgem9vbSAgICAgICAgOiAxMixcbiAgICAgICAgICAgICAgICBNYXBUeXBlSWQgICA6IGdvb2dsZS5tYXBzLk1hcFR5cGVJZC5ST0FETUFQLFxuICAgICAgICAgICAgICAgIHNjcm9sbHdoZWVsIDogZmFsc2UsXG4gICAgICAgICAgICAgICAgc3RyZWV0Vmlld0NvbnRyb2w6IGZhbHNlLFxuICAgICAgICAgICAgICAgIG1hcFR5cGVDb250cm9sOiBmYWxzZSxcbiAgICAgICAgICAgICAgICBtYXBUeXBlQ29udHJvbE9wdGlvbnM6IHtcbiAgICAgICAgICAgICAgICAgICAgICBtYXBUeXBlSWRzOiBbZ29vZ2xlLm1hcHMuTWFwVHlwZUlkLlJPQURNQVAsIENMT1VEX01BUF9JRF1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBtYXBUeXBlSWQ6IENMT1VEX01BUF9JRFxuICAgICAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIC8vIGRyYXcgbWFwIHdpdGggaGVscGVyIG1hcmtlcnNcbiAgICAgICAgdmFyIGhlbHBlck1hcmtlcnMgPSBbXTtcbiAgICAgICAgZnVuY3Rpb24gZHJhd0hlbHBlck1hcmtlcihsb2NhdGlvbil7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMCwgbWFya2VyOyBtYXJrZXIgPSBoZWxwZXJNYXJrZXJzW2ldOyBpKyspIHtcbiAgICAgICAgICAgICAgICBtYXJrZXIuc2V0TWFwKG51bGwpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaGVscGVyTWFya2VycyA9IFtdO1xuICAgICAgICAgICAgdmFyIG1hcmtlciA9IG5ldyBnb29nbGUubWFwcy5NYXJrZXIoe1xuICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBsb2NhdGlvbiwgXG4gICAgICAgICAgICAgICAgbWFwOiBtYXAsXG4gICAgICAgICAgICAgICAgaWNvbjogaW1hZ2VUYXJnZXRcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaGVscGVyTWFya2Vycy5wdXNoKG1hcmtlcik7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVIZWxwZXJNYXJrZXIoKXtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBtYXJrZXI7IG1hcmtlciA9IGhlbHBlck1hcmtlcnNbaV07IGkrKykge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBoZWxwZXJNYXJrZXJzID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkcmF3QW5kU2V0UGxhY2UobG9jYXRpb24pXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIG9ubHkgZW5hYmxlIHdoZW4gbG9nZ2VkIGluXG4gICAgICAgICAgICBpZiAoIXNjb3BlLmN1cnJlbnRVc2VyKVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgaWYgKGluZm9XaW5kb3cpXG4gICAgICAgICAgICAgICAgaW5mb1dpbmRvdy5jbG9zZSgpO1xuXG4gICAgICAgICAgICB2YXIgZ2VvY29kZXIgPSBuZXcgZ29vZ2xlLm1hcHMuR2VvY29kZXIoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGxvY2F0aW9uIGluZm9yKGxvbixsYXQpXG4gICAgICAgICAgICBzY29wZS4kZW1pdCgnbG9jJywgbG9jYXRpb24pO1xuXG4gICAgICAgICAgICBkcmF3SGVscGVyTWFya2VyKGxvY2F0aW9uKTtcblxuICAgICAgICAgICAgLy8gYnJvYWRjYXN0IHBsYWNlIGZvcm1hdHRlZF9hZGRyZXNzIGFuZCBkcmF3IGljb25cbiAgICAgICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoIHsgJ2xhdExuZyc6IGxvY2F0aW9uIH0sIGZ1bmN0aW9uKHJlc3VsdHMsIHN0YXR1cykge1xuICAgICAgICAgICAgICAgIC8vIGFzIHVzZXIgY2xpY2tzIG9uIHRoZSBtYXAsXG4gICAgICAgICAgICAgICAgLy8gd2UgaGF2ZSB0byBzYXZlIHRoZSBmb3JtYXR0ZWQgYWRkcmVzcyBpbiAkc2NvcGUgYW5kXG4gICAgICAgICAgICAgICAgLy8gaXQgd2lsbCBiZSB1c2VkIHRocm91Z2ggcG9zdHMuY3RybFxuICAgICAgICAgICAgICAgIC8vIGVtaXQgYnJvYWRjYXNlICdwbGFjZScgYW5kIHNlbmQgdGhpcyB0byBhcHBsaWNhdGlvbi5jdHJsXG4gICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgLy8gYnJvYWRjYXN0IGZvcm1hdHRlZF9hZGRyZXNzXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRlbWl0KCdwbGFjZScsIHJlc3VsdHNbMV0uZm9ybWF0dGVkX2FkZHJlc3MpO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgY2F0Y2goZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgICAgICAgICAgICAgICAgIHN3YWwoXCJcIixcIkxvY2F0aW9uIGRvZXMgbm90IGV4aXN0c1wiKTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ3BsYWNlJywgXCJMb2NhdGlvbiBkb2VzIG5vdCBleGlzdHNcIik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICAgLy8gcGxhY2UgYSBtYXJrZXIgYW5kIGluZm9XaW5kb3dcbiAgICAgICAgdmFyIGluZm9XaW5kb3c7XG4gICAgICAgIHZhciBtYXJrZXJzID0gW107XG5cbiAgICAgICAgZnVuY3Rpb24gZHJhd1Bvc3RNYXJrZXJzKCkge1xuICAgICAgICAgICAgdmFyIHBvc3RzID0gdW5kZWZpbmVkO1xuICAgICAgICAgICAgUG9zdHNTdmMuZmV0Y2hBbGwoKVxuICAgICAgICAgICAgLnN1Y2Nlc3MoZnVuY3Rpb24ocmVzcG9uc2Upe1xuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocmVzcG9uc2UpO1xuICAgICAgICAgICAgICAgIHBvc3RzID0gcmVzcG9uc2U7XG5cbiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHBvc3RzLmxlbmd0aDsgaSsrKVxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHBvc3QgPSBwb3N0c1tpXTtcblxuICAgICAgICAgICAgICAgICAgICBpZiAobWFya2Vyc1tpXSl7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAobWFya2Vyc1tpXS5wb3N0Ll9pZCA9PSBwb3N0Ll9pZClcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy9pZiAoIXBvc3QuaGFzT3duUHJvcGVydHkoJ3NleExvY2F0aW9uJykpXG4gICAgICAgICAgICAgICAgICAgIC8vICAgIGNvbnRpbnVlO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBsb2NhdGlvbiA9IGFuZ3VsYXIuZnJvbUpzb24ocG9zdC5zZXhMb2NhdGlvbik7XG4gICAgICAgICAgICAgICAgICAgIHZhciBnb29nbGVMb2MgPSBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGxvY2F0aW9uLmxhdCwgbG9jYXRpb24ubG9uKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyT3B0aW9ucyA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiBnb29nbGVMb2MsXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXA6IG1hcCxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlOiBcIlNleFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgLy9pY29uOiBpbWFnZVBvc3RcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcihtYXJrZXJPcHRpb25zKTtcbiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIG1hcmtlciB0byBhcnJheVxuICAgICAgICAgICAgICAgICAgICBtYXJrZXJzLnB1c2goXG4gICAgICAgICAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbWFya2VyOiBtYXJrZXIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zdCAgOiBwb3N0XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgcGFyZW50ID0gc2NvcGU7XG4gICAgICAgICAgICAgICAgICAgIHZhciBjaGlsZCA9IHBhcmVudC4kbmV3KHRydWUpO1xuXG4gICAgICAgICAgICAgICAgICAgIHZhciBvcGVuV2luZG93ID0gKGZ1bmN0aW9uKG1hcmtlciwgcG9zdCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNsb3NlIHdpbmRvdyBpZiBub3QgdW5kZWZpbmVkXG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoaW5mb1dpbmRvdyAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZC5jb250ZW50ID0gcG9zdC5zZXhUYXJnZXQuc3Vic3RyaW5nKDAsIDI0KTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZC5hZ2UgPSBwb3N0LnVzZXJBZ2U7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9ICc8ZGl2PiA8c3Ryb25nIGNsYXNzPVwicG9zdC1jb250ZW50XCI+XCInICsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuY29udGVudCArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcuLi5cIjwvc3Ryb25nPiAgIDxzcGFuIGNsYXNzPVwicG9zdC1jb250ZW50LWFnZVwiPkRhbmdlciBSYXRlIC0gICcgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjaGlsZC5hZ2UgK1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICcvMTAwPC9zcGFuPjwvZGl2Pic7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21waWxlZCA9ICRjb21waWxlKGh0bWwpKGNoaWxkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgd2luZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3dPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb21waWxlZFswXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpeGVsT2Zmc2V0OiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgwLCAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZUF1dG9QYW46IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coaW5mb1dpbmRvd09wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cub3BlbihtYXAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pKG1hcmtlciwgcG9zdCk7XG5cbiAgICAgICAgICAgICAgICAgICAgb3BlbldpbmRvdygpO1xuXG5cbiAgICAgICAgICAgICAgICAgICAgLy8gbW91c2Ugb3ZlciB0byB2aWV3IHRoZSBwb3N0IGluZm9ybWF0aW9uIC0gY2xvc3VyZVxuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdjbGljaycsIChmdW5jdGlvbihtYXJrZXIsIHBvc3QpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjbG9zZSB3aW5kb3cgaWYgbm90IHVuZGVmaW5lZFxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGluZm9XaW5kb3cgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93LmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuY29udGVudCA9IHBvc3Quc2V4VGFyZ2V0LnN1YnN0cmluZygwLCAyNCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuYWdlID0gcG9zdC51c2VyQWdlO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSAnPGRpdj4gPHN0cm9uZyBjbGFzcz1cInBvc3QtY29udGVudFwiPlwiJyArIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLmNvbnRlbnQgKyBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnXCIuLi48L3N0cm9uZz4gICA8c3BhbiBjbGFzcz1cInBvc3QtY29udGVudC1hZ2VcIj5Kb3kgUmF0ZSAtICAnICsgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2hpbGQuYWdlICtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9zcGFuPjwvZGl2Pic7XG5cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21waWxlZCA9ICRjb21waWxlKGh0bWwpKGNoaWxkKTtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBuZXcgd2luZG93XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGluZm9XaW5kb3dPcHRpb25zID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50OiBjb21waWxlZFswXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBpeGVsT2Zmc2V0OiBuZXcgZ29vZ2xlLm1hcHMuU2l6ZSgwLCAwKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzYWJsZUF1dG9QYW46IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbmZvV2luZG93ID0gbmV3IGdvb2dsZS5tYXBzLkluZm9XaW5kb3coaW5mb1dpbmRvd09wdGlvbnMpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cub3BlbihtYXAsIG1hcmtlcik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pKG1hcmtlciwgcG9zdCkpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIG1vdXNlIG91dCB0byBjbG9zZSB0aGUgcG9zdCBpbmZvIHdpbmRvd1xuICAgICAgICAgICAgICAgICAgICAvKlxuICAgICAgICAgICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihtYXJrZXIsICdtb3VzZW91dCcsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbmZvV2luZG93KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluZm9XaW5kb3cuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7Ki9cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZVBvc3RNYXJrZXIoKXtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwLCBtYXJrZXI7IG1hcmtlciA9IG1hcmtlcnNbaV07IGkrKykge1xuICAgICAgICAgICAgICAgIG1hcmtlci5zZXRNYXAobnVsbCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBtYXJrZXJzID0gW107XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRTZWFyY2hCb3goKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBDcmVhdGUgdGhlIHNlYXJjaCBib3ggYW5kIGxpbmsgaXQgdG8gdGhlIFVJIGVsZW1lbnQuXG4gICAgICAgICAgICB2YXIgaW5wdXQgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3BhYy1pbnB1dCcpKTsgLy8gQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9ICBcbiAgICAgICAgICAgIHZhciBjdXJyTG9jQnRuID0gKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdidG4tY3VycicpKTsgICAgICBcbiAgICAgICAgICAgIG1hcC5jb250cm9sc1tnb29nbGUubWFwcy5Db250cm9sUG9zaXRpb24uVE9QX0xFRlRdLnB1c2goaW5wdXQpO1xuICAgICAgICAgICAgbWFwLmNvbnRyb2xzW2dvb2dsZS5tYXBzLkNvbnRyb2xQb3NpdGlvbi5UT1BfUklHSFRdLnB1c2goY3VyckxvY0J0bik7XG5cbiAgICAgICAgICAgIHZhciBzZWFyY2hCb3ggPSBuZXcgZ29vZ2xlLm1hcHMucGxhY2VzLlNlYXJjaEJveCgoaW5wdXQpKTsgLy8gQHR5cGUge0hUTUxJbnB1dEVsZW1lbnR9IFxuXG4gICAgICAgICAgICAvLyBMaXN0ZW4gZm9yIHRoZSBldmVudCBmaXJlZCB3aGVuIHRoZSB1c2VyIHNlbGVjdHMgYW4gaXRlbSBmcm9tIHRoZVxuICAgICAgICAgICAgLy8gcGljayBsaXN0LiBSZXRyaWV2ZSB0aGUgbWF0Y2hpbmcgcGxhY2VzIGZvciB0aGF0IGl0ZW0uXG4gICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcihzZWFyY2hCb3gsICdwbGFjZXNfY2hhbmdlZCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBwbGFjZXMgPSBzZWFyY2hCb3guZ2V0UGxhY2VzKCk7XG5cbiAgICAgICAgICAgICAgICBpZiAocGxhY2VzLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgLy8gdGFrZSBvbmx5IDEgc3BvdFxuICAgICAgICAgICAgICAgIHZhciBwbGFjZSA9IHBsYWNlc1swXTtcblxuICAgICAgICAgICAgICAgIC8vIHdoZW4gc2VhcmNoIGhhcHBlbnMsIGxvY2F0aW9uIHdpbGwgYmUgdXBkYXRlZCBhcyB3ZWxsIGZvciBwb3N0XG4gICAgICAgICAgICAgICAgLy8gc2NvcGUuJGVtaXQoJ3BsYWNlJywgcGxhY2UuZm9ybWF0dGVkX2FkZHJlc3MpO1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbik7XG5cbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gcGxhY2UuZ2VvbWV0cnkubG9jYXRpb24ubGF0aXR1ZGU7XG4gICAgICAgICAgICAgICAgd2luZG93LmxvY2FsU3RvcmFnZS5sb25naXR1ZGUgPSBwbGFjZS5nZW9tZXRyeS5sb2NhdGlvbi5sb25naXR1ZGU7XG5cbiAgICAgICAgICAgICAgICBtYXAucGFuVG8ocGxhY2UuZ2VvbWV0cnkubG9jYXRpb24pO1xuICAgICAgICAgICAgICAgIC8vbWFwLnNldFpvb20oMTYpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRDbGlja01hcCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIC8vIGNsaWNrIGV2ZW50IG9uIG1hcFxuICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIobWFwLCAnY2xpY2snLCBmdW5jdGlvbihldmVudCkge1xuICAgICAgICAgICAgICAgIGRyYXdBbmRTZXRQbGFjZShldmVudC5sYXRMbmcpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRNb3ZlVG9DdXJyZW50TG9jYXRpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICAvLyBjbGljayBldmVudCBvbiBtYXBcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2hlYWRpbmdfY2hhbmdlZCcsIGZ1bmN0aW9uKGxvY2F0aW9uKSB7XG4gICAgICAgICAgICAgICAgZHJhd0FuZFNldFBsYWNlKGxvY2F0aW9uKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0Q2VudGVyQ2hhbmdlZCgpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ2NlbnRlcl9jaGFuZ2VkJywgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gbWFwLmdldENlbnRlcigpLmxhdCgpO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlID0gbWFwLmdldENlbnRlcigpLmxuZygpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgZnVuY3Rpb24gc2V0TG9hZFBvc3RNYXJrZXJzKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gbWFudWFsbHkgcmVsb2FkIG1hcmtlcnNcbiAgICAgICAgICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcCwgJ21hcHR5cGVpZF9jaGFuZ2VkJywgZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgLy9yZW1vdmVIZWxwZXJNYXJrZXIoKTtcbiAgICAgICAgICAgICAgICAvL3JlbW92ZVBvc3RNYXJrZXIoKTtcblxuICAgICAgICAgICAgICAgIGRyYXdQb3N0TWFya2VycygpOyBcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2V0U3R5bGVGb3JNYXAoKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgZmVhdHVyZU9wdHMgPSBbe1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzLnRleHQuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzQzOWFhNVwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJhZG1pbmlzdHJhdGl2ZS5sb2NhbGl0eVwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzMyNDg1Y1wifSx7XCJ2aXNpYmlsaXR5XCI6XCJzaW1wbGlmaWVkXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcImFkbWluaXN0cmF0aXZlLm5laWdoYm9yaG9vZFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJsYW5kc2NhcGUubmF0dXJhbFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2U5ZGRkYlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJsYW5kc2NhcGUubmF0dXJhbC50ZXJyYWluXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnlcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib2ZmXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaVwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pLnBhcmtcIixcImVsZW1lbnRUeXBlXCI6XCJhbGxcIixcInN0eWxlcnNcIjpbe1widmlzaWJpbGl0eVwiOlwib25cIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicG9pLnBhcmtcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjYzRlNjYxXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInBvaS5wYXJrXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9mZlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkLmhpZ2h3YXlcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZTlkZGRiXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuaGlnaHdheVwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiIzMyNDg1Y1wifSx7XCJ3ZWlnaHRcIjpcIjAuN1wifV19LHtcImZlYXR1cmVUeXBlXCI6XCJyb2FkLmFydGVyaWFsXCIsXCJlbGVtZW50VHlwZVwiOlwiYWxsXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9uXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcImNvbG9yXCI6XCIjZTlkZGRiXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiMzMjQ4NWNcIn0se1wid2VpZ2h0XCI6XCIwLjI1XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcInJvYWQuYXJ0ZXJpYWxcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMuaWNvblwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LmZpbGxcIixcInN0eWxlcnNcIjpbe1wiY29sb3JcIjpcIiNlOWRkZGJcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwicm9hZC5sb2NhbFwiLFwiZWxlbWVudFR5cGVcIjpcImdlb21ldHJ5LnN0cm9rZVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2VmNzk4ZVwifSx7XCJ3ZWlnaHRcIjpcIjAuNVwifSx7XCJ2aXNpYmlsaXR5XCI6XCJvZmZcIn1dfSx7XCJmZWF0dXJlVHlwZVwiOlwidHJhbnNpdFwiLFwiZWxlbWVudFR5cGVcIjpcImFsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeVwiLFwic3R5bGVyc1wiOlt7XCJjb2xvclwiOlwiI2VmNzk4ZVwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5maWxsXCIsXCJzdHlsZXJzXCI6W3tcIndlaWdodFwiOlwiMi4wNlwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJnZW9tZXRyeS5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wid2VpZ2h0XCI6XCIxMC4wMFwifV19LHtcImZlYXR1cmVUeXBlXCI6XCJ0cmFuc2l0LmxpbmVcIixcImVsZW1lbnRUeXBlXCI6XCJsYWJlbHMudGV4dC5zdHJva2VcIixcInN0eWxlcnNcIjpbe1wid2VpZ2h0XCI6XCIwLjAxXCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwiZ2VvbWV0cnkuZmlsbFwiLFwic3R5bGVyc1wiOlt7XCJ2aXNpYmlsaXR5XCI6XCJvblwifSx7XCJ3ZWlnaHRcIjpcIjEwLjAwXCJ9LHtcImNvbG9yXCI6XCIjNDM5YWE1XCJ9XX0se1wiZmVhdHVyZVR5cGVcIjpcIndhdGVyXCIsXCJlbGVtZW50VHlwZVwiOlwibGFiZWxzXCIsXCJzdHlsZXJzXCI6W3tcInZpc2liaWxpdHlcIjpcIm9uXCJ9LHtcImNvbG9yXCI6XCIjMzI0ODVjXCJ9LHtcIndlaWdodFwiOlwiMC44NVwifV19XTtcblxuICAgICAgICAgICAgdmFyIHN0eWxlZE1hcE9wdGlvbnMgPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0N1c3RvbSBTdHlsZSdcbiAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgdmFyIGN1c3RvbU1hcFR5cGUgPSBuZXcgZ29vZ2xlLm1hcHMuU3R5bGVkTWFwVHlwZShmZWF0dXJlT3B0cywgc3R5bGVkTWFwT3B0aW9ucyk7XG4gICAgICAgICAgICBtYXAubWFwVHlwZXMuc2V0KENMT1VEX01BUF9JRCwgY3VzdG9tTWFwVHlwZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbml0IHRoZSBtYXBcbiAgICAgICAgZnVuY3Rpb24gaW5pdE1hcCgpIHtcbiAgICAgICAgICAgIGlmIChtYXAgPT09IHZvaWQgMCkge1xuICAgICAgICAgICAgICAgIG1hcCA9IG5ldyBnb29nbGUubWFwcy5NYXAoZWxlbWVudFswXSwgbWFwT3B0aW9ucyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHNldFN0eWxlRm9yTWFwKCk7XG5cbiAgICAgICAgICAgIHNldExvYWRQb3N0TWFya2VycygpO1xuXG4gICAgICAgICAgICAvLyBicm9hZGNhc3QgdG8gc2VuZCBtYXAgdG8gYXBwbGljYXRpb24gY3RybFxuICAgICAgICAgICAgc2NvcGUuJGVtaXQoJ21hcEluaXQnLCBtYXApO1xuXG4gICAgICAgICAgICBzZXRDbGlja01hcCgpO1xuXG4gICAgICAgICAgICBzZXRTZWFyY2hCb3goKTtcblxuICAgICAgICAgICAgc2V0Q2VudGVyQ2hhbmdlZCgpO1xuXG4gICAgICAgICAgICBzZXRNb3ZlVG9DdXJyZW50TG9jYXRpb24oKTtcblxuICAgICAgICAgICAgZHJhd1Bvc3RNYXJrZXJzKCk7XG4gICAgICAgIH0gXG5cbiAgICAgICAgaW5pdE1hcCgpO1xuXG4gICAgICAgIC8qXG4gICAgICAgIGZ1bmN0aW9uIGdldEN1cnJMb2NTdWNjZXNzKHBvcykge1xuICAgICAgICAgICAgLy8gbWFrZSBzdXJlIHRvIGNoZWNrIHdlIGFyZSBvbiBwb3N0IHBhZ2Ugd2l0aCBtYXAgZmlyc3RcbiAgICAgICAgICAgIGlmIChzY29wZS5jdXJyZW50UGFnZUlkICE9IHNjb3BlLnBhZ2VJZC5wb3N0KVxuICAgICAgICAgICAgICAgIHJldHVybjtcblxuICAgICAgICAgICAgc3dhbCh7ICAgXG4gICAgICAgICAgICAgICAgdGl0bGU6IFwiV2UgZm91bmQgeW91IVwiLCAgIFxuICAgICAgICAgICAgICAgIHRleHQ6IFwiRG8geW91IHdhbnQgdG8gbW92ZSB0byB5b3VyIGxvY2F0aW9uPyFcIiwgICBcbiAgICAgICAgICAgICAgICBzaG93Q2FuY2VsQnV0dG9uOiB0cnVlLCAgIFxuICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25Db2xvcjogJyMwMEIyRUUnLCAgIFxuICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiBcIlllcywgbW92ZSBtZSFcIiwgICBcbiAgICAgICAgICAgICAgICBjbG9zZU9uQ29uZmlybTogZmFsc2UgLFxuICAgICAgICAgICAgfSwgXG4gICAgICAgICAgICBmdW5jdGlvbigpeyAgXG4gICAgICAgICAgICAgICAgc3dhbCh7dGl0bGU6IFwiXCIsIHRleHQ6IFwiWW91IGhhdmUgYmVlbiBtb3ZlZCFcIiwgdGltZXI6IDgwMCwgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlfSk7XG5cbiAgICAgICAgICAgICAgICAvLyBpZiB1c2VyIHdhbnRzIHRvIG1vdmUsIGxldCBpdCBoYXBwZW4hXG4gICAgICAgICAgICAgICAgdmFyIGNyZCA9IHBvcy5jb29yZHM7XG5cbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gY3JkLmxhdGl0dWRlO1xuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhbFN0b3JhZ2UubG9uZ2l0dWRlID0gY3JkLmxvbmdpdHVkZTtcblxuICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2coJ0xhdGl0dWRlIDogJyArIGNyZC5sYXRpdHVkZSk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnTG9uZ2l0dWRlOiAnICsgY3JkLmxvbmdpdHVkZSk7XG4gICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygnTW9yZSBvciBsZXNzICcgKyBjcmQuYWNjdXJhY3kgKyAnIG1ldGVycy4nKTtcbiAgICAgICAgICAgICAgICB2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhjcmQubGF0aXR1ZGUsIGNyZC5sb25naXR1ZGUpO1xuXG4gICAgICAgICAgICAgICAgZHJhd0FuZFNldFBsYWNlKGdvb2dsZUxvYyk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgbWFwLnBhblRvKGdvb2dsZUxvYylcbiAgICAgICAgICAgICAgICBtYXAuc2V0Wm9vbSgxNSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEN1cnJMb2NFcnJvcihlcnIpIHtcbiAgICAgICAgICAgIGNvbnNvbGUud2FybignRVJST1IoJyArIGVyci5jb2RlICsgJyk6ICcgKyBlcnIubWVzc2FnZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBpbml0IG1hcCBhbmQgcGxhY2Ugc29tZSBtYXJrZXJzLCBzbyBldmVyeXRoaW5nIHN0YXJ0IHdpdGggdGhpcyBmdW5jdGlvbi5cbiAgICAgICAgbmF2aWdhdG9yLmdlb2xvY2F0aW9uLmdldEN1cnJlbnRQb3NpdGlvbihnZXRDdXJyTG9jU3VjY2VzcywgZ2V0Q3VyckxvY0Vycm9yKTtcblxuICAgICAgICAvLyBzd2FsKHsgICB0aXRsZTogXCJcIiwgICB0ZXh0OiBcIkdldHRpbmcgY3VycmVudCBsb2NhdGlvbi4uXCIsICAgdGltZXI6IDIwMDAsICAgc2hvd0NvbmZpcm1CdXR0b246IGZhbHNlIH0pO1xuICAgICAgICAqL1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcmVzdHJpY3Q6ICdBJyxcbiAgICAgICAgdGVtcGxhdGU6ICc8ZGl2IGlkPVwibWFwLWNhbnZhc1wiPjwvZGl2PicsXG4gICAgICAgIHJlcGxhY2U6IHRydWUsXG4gICAgICAgIGxpbms6IGxpbmtcbiAgICB9O1xufSk7XG5cblxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnVXRpbFN2YycsIGZ1bmN0aW9uKCl7XG5cdHZhciBzdmMgPSB0aGlzO1xuXG5cdHN2Yy5kZWcycmFkID0gZnVuY3Rpb24oZGVnKSB7XG5cdCAgcmV0dXJuIGRlZyAqIChNYXRoLlBJLzE4MCk7XG5cdH07XG5cblx0c3ZjLmdldERpc3RhbmNlRnJvbUxhdExvbkluS20gPSBmdW5jdGlvbiAobGF0MSxsb24xLGxhdDIsbG9uMikge1xuXHQgIHZhciBSID0gNjM3MTtcblx0ICB2YXIgZExhdCA9IHN2Yy5kZWcycmFkKGxhdDItbGF0MSk7XG5cdCAgdmFyIGRMb24gPSBzdmMuZGVnMnJhZChsb24yLWxvbjEpOyBcblx0ICB2YXIgYSA9IFxuXHQgICAgTWF0aC5zaW4oZExhdC8yKSAqIE1hdGguc2luKGRMYXQvMikgK1xuXHQgICAgTWF0aC5jb3Moc3ZjLmRlZzJyYWQobGF0MSkpICogTWF0aC5jb3Moc3ZjLmRlZzJyYWQobGF0MikpICogXG5cdCAgICBNYXRoLnNpbihkTG9uLzIpICogTWF0aC5zaW4oZExvbi8yKVxuXHQgICAgOyBcblx0ICB2YXIgYyA9IDIgKiBNYXRoLmF0YW4yKE1hdGguc3FydChhKSwgTWF0aC5zcXJ0KDEtYSkpOyBcblx0ICB2YXIgZCA9IFIgKiBjO1xuXHQgIHJldHVybiBkO1xuXHR9O1xufSk7XG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcci5jb250cm9sbGVyKCdQb3N0c0N0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBQb3N0c1N2YywgJHdpbmRvdywgJGRvY3VtZW50KXtcclxyXHQvKiBlbWl0IGJyb2FkY2FzdCBmb3IgY3VycmVudCBwYWdlSWQgKi9cclx0JHNjb3BlLiRlbWl0KCdwYWdlY2hhbmdlJywgJHNjb3BlLnBhZ2VJZC5wb3N0KTtcclxyXHQkc2NvcGUucG9zdHMgPSBbXTtcclxyXHR2YXIgX3BhZ2UgPSAwO1xyXHR2YXIgX3BlclBhZ2UgPSAxMDtcclxyXHQvKiBtb3ZlIHRvIHBvc3QncyBsb2NhdGlvbiAqL1xyXHQkc2NvcGUubW92ZVRvTG9jID0gZnVuY3Rpb24oaWQpe1xyXHRcdHZhciBwb3N0ID0gKCRzY29wZS5wb3N0c1tpZF0pO1xyXHJcdFx0dmFyIGxvY2F0aW9uID0gYW5ndWxhci5mcm9tSnNvbihwb3N0LnNleExvY2F0aW9uKTtcclx0XHR2YXIgZ29vZ2xlTG9jID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZyhsb2NhdGlvbi5sYXQsIGxvY2F0aW9uLmxvbik7XHJcclx0XHQkc2NvcGUubWFwLnBhblRvKGdvb2dsZUxvYyk7XHJcdFx0JHNjb3BlLm1hcC5zZXRab29tKDE2KTtcclxyXHRcdC8qIHVzaW5nIGFuZ3VsYXItc2Nyb2xsIHRvIG1vdmUgdG8gdGhlIHRvcCBzbW9vdGhseSAqL1xyXHRcdHZhciB0b3AgPSAwO1xyICAgIFx0dmFyIGR1cmF0aW9uID0gNDgwO1xyICAgIFx0JGRvY3VtZW50LnNjcm9sbFRvcCh0b3AsIGR1cmF0aW9uKS50aGVuKGZ1bmN0aW9uKCkge1xyICAgICBcdFx0Y29uc29sZSAmJiBjb25zb2xlLmxvZygnWW91IGp1c3Qgc2Nyb2xsZWQgdG8gdGhlIHRvcCEnKTtcciAgICBcdH0pO1xyXHJcdFx0Lyokd2luZG93LnNjcm9sbCgwLCAwKTsqL1xyXHR9O1xyXHJcdCRzY29wZS5hZGRQb3N0ID0gZnVuY3Rpb24oKSB7XHJcdFx0LyogZ2V0IGF1dG9jb21wbGV0ZWQgcGxhY2UgYW5kIHJlc2V0KHNldCB0byB1bmRlZmluZWQpICovXHJcdFx0dmFyIHBsYWNlID0gJHNjb3BlLnNleFBsYWNlQXV0b2NvbXBsZXRlZDtcclx0XHR2YXIgbG9jYXRpb24gPSAkc2NvcGUucG9zdExvY2F0aW9uO1xyXHJcdFx0Y29uc29sZS5sb2coXCJsb2NhdGlvbjpcIiArIGxvY2F0aW9uLmxhdCArICcsJyArIGxvY2F0aW9uLmxvbiArICdcXG4gcGxhY2U6JyArIHBsYWNlKTtcclx0XHR2YXIgbG9jYXRpb25KU09OID0gSlNPTi5zdHJpbmdpZnkobG9jYXRpb24pO1xyXHJcdFx0Y29uc29sZS5sb2coJHNjb3BlLnNleFRpbWUpO1xyXHJcdFx0UG9zdHNTdmMuY3JlYXRlKFxyXHRcdHtcclx0XHRcdHVzZXJOYW1lOiB1bmRlZmluZWQsXHJcdFx0XHR1c2VyQWdlOiAgdW5kZWZpbmVkLFxyXHRcdFx0c2V4UGxhY2U6IHBsYWNlLFxyXHRcdFx0c2V4VGltZTogICRzY29wZS5zZXhUaW1lLFxyXHRcdFx0c2V4VGFyZ2V0OiAkc2NvcGUuc2V4VGFyZ2V0LFxyXHRcdFx0c2V4TG9jYXRpb246IGxvY2F0aW9uSlNPTlxyXHRcdH0pXHJcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24ocG9zdCl7XHJcdFx0XHQvKlxyXHRcdFx0dmFyIG1zZyA9IFwiWW91IHdhbnRlZCB0byBoYXZlIHNleCB3aXRoIFwiICsgXHJcdFx0XHRwb3N0LnNleFRhcmdldDtcclx0XHRcdHN3YWwoXCJHcmVhdCFcIiwgbXNnLCBcInN1Y2Nlc3NcIik7XHJcclx0XHRcdC8qIG1hbnVhbGx5IHJlbG9hZCBtYXJrZXJzIFxyXHRcdFx0dXNpbmcgbWFwdHlwZWlkIHNpbmNlIGl0cyBtb3N0IGxlYXN0IHVzZWQgZXZlbnQsIC0ga2luZCBvZiBoYWNreSB3YXkgdG8gZG8gaXRcclx0XHRcdCovXHJcdFx0XHRnb29nbGUubWFwcy5ldmVudC50cmlnZ2VyKCRzY29wZS5tYXAsICdtYXB0eXBlaWRfY2hhbmdlZCcpO1xyXHJcdFx0XHQkc2NvcGUucG9zdHMudW5zaGlmdChwb3N0KTtcclxyXHRcdFx0LyogcmVzZXQgaW5wdXQgZm9ybXMgKi9cclx0XHRcdCRzY29wZS5zZXhUaW1lICA9IG51bGw7XHJcdFx0XHQkc2NvcGUuc2V4VGFyZ2V0ID0gbnVsbDtcclx0XHR9KVxyXHRcdC5lcnJvcihmdW5jdGlvbihkYXRhLCBzdGF0dXMpe1xyXHRcdFx0aWYgKHN0YXR1cyA9PSA0MDEpXHJcdFx0XHR7XHJcdFx0XHRcdHN3YWwoXCJMb2ctaW4gZmFpbGVkXCIsIFwiUGxlYXNlIGxvZyBpblwiLCBcImVycm9yXCIpO1xyXHRcdFx0fVxyXHRcdFx0ZWxzZVxyXHRcdFx0e1xyXHRcdFx0XHRzd2FsKFwiUG9zdCBmYWlsZWRcIiwgXCJQbGVhc2UgY29tcGxldGUgdGhlIGZyb20gY29ycmVjdGx5XCIsIFwiZXJyb3JcIik7XHJcdFx0XHR9XHJcdFx0fSk7XHJcdH07XHJcclx0JHNjb3BlLnJlcXVlc3RGZXRjaCA9IGZ1bmN0aW9uKCkge1xyXHRcdFBvc3RzU3ZjLmZldGNoKF9wYWdlLCBfcGVyUGFnZSlcclx0XHQuc3VjY2VzcyhmdW5jdGlvbihwb3N0cyl7XHJcdFx0XHRfcGFnZSsrO1xyXHRcdFx0Y29uc29sZS5sb2coJ1Bvc3RzIGhhdmUgYmVlbiBsb2FkZWQgc3VjY2Vzc2Z1bGx5IGZvciBmcm9udCBwYWdlJyk7XHJcdFx0XHQkc2NvcGUucG9zdHMgPSAkc2NvcGUucG9zdHMuY29uY2F0KHBvc3RzKTtcclx0XHR9KTtcclx0fTtcclxyXHQkc2NvcGUucmVxdWVzdEZldGNoKCk7XHJ9KTtcclxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uc2VydmljZSgnUG9zdHNTdmMnLCBmdW5jdGlvbigkaHR0cCl7XG5cdHRoaXMuZmV0Y2hBbGwgPSBmdW5jdGlvbigpIHtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3Bvc3RzJyk7XG5cdH07XG5cblx0dGhpcy5mZXRjaCA9IGZ1bmN0aW9uKHBhZ2UsIHBlcnBhZ2Upe1xuXHRcdHZhciB1cmwgPSAnL2FwaS9wb3N0cy8nICsgcGFnZSArICc/cGVycGFnZT0nICsgcGVycGFnZTtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KHVybCk7XG5cdH07XG5cblx0dGhpcy5jcmVhdGUgPSBmdW5jdGlvbihwb3N0KXtcblx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9wb3N0cycsIHBvc3QpO1xuXHR9O1xufSk7XG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdBY2NvdW50Q3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCBVc2VyU3ZjKXtcblx0LyogZW1pdCBicm9hZGNhc3QgZm9yIGN1cnJlbnQgcGFnZUlkICovXG5cdCRzY29wZS4kZW1pdCgncGFnZWNoYW5nZScsICRzY29wZS5wYWdlSWQuYWNjb3VudCk7XG5cblx0JHNjb3BlLmNoYW5nZVBhc3N3b3JkID0gZnVuY3Rpb24obmV3UGFzc3dvcmQsIHBhc3N3b3JkKXtcblx0XHRVc2VyU3ZjLmNoYW5nZVBhc3N3b3JkKG5ld1Bhc3N3b3JkLCBwYXNzd29yZClcblx0XHQudGhlbihcblx0XHRcdGZ1bmN0aW9uKCl7XG5cdFx0XHRcdHN3YWwoJycsIFwiUGFzc3dvcmQgaGF2ZSBiZWVuIGNoYW5nZWRcIiwgXCJzdWNjZXNzXCIpO1xuXHRcdFx0XHQkbG9jYXRpb24ucGF0aCgnLycpO1xuXHRcdFx0fSxcblx0XHRcdGZ1bmN0aW9uKGVycil7XG5cdFx0XHRcdGlmIChlcnIuc3RhdHVzID09IDQwMSlcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHN3YWwoJycsIFwiT3JpZ2luYWwgcGFzc3dvcmQgaXMgd3JvbmcuXCIsIFwiZXJyb3JcIik7XHRcblx0XHRcdFx0fVxuXHRcdFx0XHRlbHNlXG5cdFx0XHRcdHtcblx0XHRcdFx0XHRzd2FsKCcnLCBcIkNhbiBub3QgY2hhbmdlIHBhc3N3b3JkLlwiLFwiZXJyb3JcIik7XG5cdFx0XHRcdH1cblx0XHRcdH1cblx0XHQpO1xuXHR9O1xufSk7XG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdMb2dpbkN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICRsb2NhdGlvbiwgVXNlclN2Yyl7XG5cdCRzY29wZS4kZW1pdCgncGFnZWNoYW5nZScsICRzY29wZS5wYWdlSWQubG9naW4pO1xuXG5cdC8vIFVzZXJTdmPshJzruYTsiqTsnZggbG9naW7tlajsiJjsl5DshJwg67Cb7J2AIOycoOyggOygleuztOulvFxuXHQvLyDstZzsg4HsnIQg7L2Y7Yq466Gk65+s7J24IEFwcGxpY2F0aW9uQ3RybOydmCAkc2NvcGXroZwg6rCS7J2EIOuztOuCtOq4sCDsnITtlZwg7KCE7YyM66W8IOuztOuCuOuLpC5cblx0JHNjb3BlLmxvZ2luID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkKXtcblx0XHRVc2VyU3ZjLmxvZ2luKHVzZXJuYW1lLCBwYXNzd29yZClcblx0XHQudGhlbihmdW5jdGlvbiAodXNlcil7XG5cdFx0XHQkbG9jYXRpb24ucGF0aCgnLycpO1xuXHRcdFx0JHJvb3RTY29wZS4kZW1pdCgnbG9naW4nLCB1c2VyKTtcblx0XHR9LFxuXHRcdGZ1bmN0aW9uIChlcnJvcil7XG5cdFx0XHRzd2FsKFwiTG9nLWluIGZhaWxlZCFcIiwgXCJQYXNzd29yZC9JRCB3cm9uZ1wiLCBcImVycm9yXCIpO1xuXHRcdH0pO1xuXHRcdC8qIG9yIGl0IGNhbiBiZSB0aGlzXG5cdFx0LmNhdGNoKGZ1bmN0aW9uICgpe1xuXHRcdFx0YWxlcnQoXCJJRCBvciBQYXNzd29yZCBpcyB3cm9uZy5cIik7XG5cdFx0fSk7XG5cdFx0Ki9cblx0fTtcbn0pO1xuXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdSZWdpc3RlckN0cmwnLCBmdW5jdGlvbigkc2NvcGUsICRsb2NhdGlvbiwgVXNlclN2Yyl7XG5cdCRzY29wZS4kZW1pdCgncGFnZWNoYW5nZScsICRzY29wZS5wYWdlSWQucmVnaXN0ZXIpO1xuXG5cdC8vIFVzZXJTdmPshJzruYTsiqTsnZggcmVnaXN0ZXLtlajsiJjsl5DshJwg67Cb7J2AIOycoOyggOygleuztOulvCAtIGFwaeyXkOyEnCDrs7TrgrTsoYzquLAg65WM66y47JeQIC5kYXRh66GcIOygkeq3vFxuXHQvLyDstZzsg4HsnIQg7L2Y7Yq466Gk65+s7J24IEFwcGxpY2F0aW9uQ3RybOydmCAkc2NvcGXroZwg6rCS7J2EIOuztOuCtOq4sCDsnITtlZwg7KCE7YyM66W8IOuztOuCuOuLpC5cblx0JHNjb3BlLnJlZ2lzdGVyID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkLCB1c2VyZG9iLCBzZXhwb3Mpe1xuXHRcdFVzZXJTdmMucmVnaXN0ZXIodXNlcm5hbWUsIHBhc3N3b3JkLCB1c2VyZG9iLCBzZXhwb3MpXG5cdFx0LnRoZW4oZnVuY3Rpb24gKHVzZXIpe1xuXHRcdFx0c3dhbChcIk9LIVwiLCBcIlN1Y2Nlc3NmdWxseSByZWdpc3RlcmVkXCIsIFwic3VjY2Vzc1wiKVxuXHRcdFx0JGxvY2F0aW9uLnBhdGgoJy8nKTtcblx0XHRcdCRzY29wZS4kZW1pdCgnbG9naW4nLCB1c2VyKTtcblx0XHR9LFxuXHRcdGZ1bmN0aW9uKGVycm9yKXtcblx0XHRcdHN3YWwoXCJSZWdpc3RlciBmYWlsZWQhXCIsIFwiVXNlcm5hbWUgYWxyZWFkeSBleGlzdHNcIiwgXCJlcnJvclwiKTtcblx0XHR9KTtcblx0fTtcdFxufSk7XG5cbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1VzZXJTdmMnLCBmdW5jdGlvbigkaHR0cCwgJHJvb3RTY29wZSl7XG5cdHZhciBzdmMgPSB0aGlzO1xuXG5cdC8vIHN2Yy50b2tlbiAodGhpcy50b2tlbikg6rCS7Jy866GcIC9hcGkvdXNlciDrpbwg7Zi47LacXG5cdHN2Yy5nZXRVc2VyID0gZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJywgXG5cdFx0e1xuXHRcdFx0aGVhZGVyczogeydYLUF1dGgnOiAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gfVxuXHRcdFx0Ly9oZWFkZXJzOiB7J1gtQXV0aCc6ICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXX1cblx0XHR9KVxuXHRcdC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcblx0XHRcdHJldHVybiByZXNwb25zZS5kYXRhOyAgLy8gLSBhcGnsl5DshJwg67O064K07KGM6riwIOuVjOusuOyXkCAuZGF0YeuhnCDsoJHqt7xcblx0XHR9LFxuXHRcdGZ1bmN0aW9uKGVycil7XG5cdFx0XHRjdXJyZW50VXNlciA9IHVuZGVmaW5lZDtcblx0XHR9KTtcblx0fTtcblxuXHQvLyBkZXNpZ25lZCB0byBiZSBjYWxsZWQgd2hlbiBhcHBsaWNhdGlvbiBsYXVuY2hlZFxuXHQvLyBmb3IgdGhlIHBlcnNvbnMgd2hvIHJlZnJlc2hlZCB0aGUgcGFnZSBidXQgZGlkIG5vdCBsb2dvdXQgLS0+IGl0IHdpbGwgYmUgc3RpbGwgbG9nZ2VkIGluIVxuXHRzdmMucmVtYWluTG9naW4gPSBmdW5jdGlvbigpe1xuXHRcdGNvbnNvbGUubG9nKFwiVG9rZW46XCIsIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpKTtcblx0XHRjb25zb2xlLmxvZyhcIkFwcGxpY2F0aW9uIGhhcyBiZWVuIGxhdW5jaGVkXCIpXG5cdFx0aWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSAhPSAndW5kZWZpbmVkJyAmJiBcblx0XHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSAhPSAnbnVsbCcgJiZcblx0XHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSApXG5cdFx0e1xuXHRcdFx0JGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpO1xuXG5cdFx0XHRjb25zb2xlLmxvZyhcIlJlbWFpbiBMb2dpbiBpbiBwcm9jZXNzLi5cIilcblx0XHRcdHZhciB1c2VyO1xuXHRcdFx0c3ZjLmdldFVzZXIoKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24odXNlcil7XG5cdFx0XHRcdCRyb290U2NvcGUuJGVtaXQoJ2xvZ2luJywgdXNlcik7XG5cdFx0XHR9LFxuXHRcdFx0ZnVuY3Rpb24oZXJyKXtcblx0XHRcdFx0Y29uc29sZS5sb2coZXJyKTtcblx0XHRcdFx0Y3VycmVudFVzZXIgPSB1bmRlZmluZWQ7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG5cblx0c3ZjLmNoYW5nZVBhc3N3b3JkID0gZnVuY3Rpb24obmV3UGFzc3dvcmQsIHBhc3N3b3JkKXtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJywgXG5cdFx0e1xuXHRcdFx0aGVhZGVyczogeydYLUF1dGgnOiAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gfVxuXHRcdH0pXG5cdFx0LnRoZW4oZnVuY3Rpb24odXNlcil7XG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS91c2Vycy9wYXNzd29yZF9jaGFuZ2UnLCBcblx0XHRcdHtcblx0XHRcdFx0cGFzc3dvcmQgICAgOiBwYXNzd29yZCxcblx0XHRcdFx0bmV3UGFzc3dvcmQgOiBuZXdQYXNzd29yZCxcblx0XHRcdFx0dXNlcm5hbWUgICAgOiB1c2VyLmRhdGEudXNlck5hbWVcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9O1xuXG5cdC8vIHNlc3Npb24g7J2EIOydtOyaqe2VtOyEnCwg7Yyo7Iqk7JuM65Oc6rCAIOydvOy5mO2VmOuKlOyngCDqsoDsgqztlZjqs6AsXG5cdC8vIOydvOy5mO2VmOuptCDrsJvsnYAgand0IGVuY29kZWTrkJwgdXNlcm5hbWUsIOymiSDthqDtgbDsnYQg6rCA7KeA6rOgLFxuXHQvLyB2YWzsnbTrnbzripQg67OA7IiY7JeQIOuEo+qzoCwg7J206rKD7J2YIOuNsOydtO2EsOulvCBzdmMudG9rZW7sl5Drj4Qg7KCA7J6l7ZWY6rOgLFxuXHQvLyBzdmMuZ2V0VXNlcu2VqOyImOulvCDtmLjstpztlZzri6QuXG5cdHN2Yy5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCl7XG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMnLCBcblx0XHR7XG5cdFx0XHR1c2VybmFtZTogdXNlcm5hbWUsIFxuXHRcdFx0cGFzc3dvcmQ6IHBhc3N3b3JkXG5cdFx0fSlcblx0XHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2Upe1xuXHRcdFx0d2luZG93LmxvY2FsU3RvcmFnZS50b2tlbiA9IHJlc3BvbnNlLmRhdGE7IC8vIGFwaeyXkOyEnCDrs7Trg4jquLDrlYzrrLjsl5AsIC5kYXRh66GcIOygkeq3vCAtIFRPRE9cblx0XHRcdCRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHJlc3BvbnNlLmRhdGE7IC8vIOuqqOuToCDsmpTssq3sl5Ag64yA7ZW0IO2VtOuLuSDtl6TrjZTrpbwg7KCE7Jet7Jy866GcIOu2meyehC5cblx0XHRcdHJldHVybiBzdmMuZ2V0VXNlcigpO1xuXHRcdH0pXG5cdH07XG5cblx0c3ZjLnJlZ2lzdGVyID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkLCB1c2VyZG9iLCBzZXhwb3Mpe1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywgXG5cdFx0e1xuXHRcdFx0dXNlck5hbWU6IHVzZXJuYW1lLFxuXHRcdFx0cGFzc3dvcmQ6IHBhc3N3b3JkLFxuXHRcdFx0dXNlcmRvYiA6IHVzZXJkb2IsXG5cdFx0XHRzZXhQb3MgIDogc2V4cG9zXG5cdFx0fSlcblx0XHQudGhlbihmdW5jdGlvbiAoKXtcblx0XHRcdHJldHVybiBzdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKTtcblx0XHR9KTtcblx0fTtcblxuXHRzdmMubG9nb3V0ID0gZnVuY3Rpb24oKXtcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IHVuZGVmaW5lZDtcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gdW5kZWZpbmVkO1xuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UudG9rZW4gPSB1bmRlZmluZWQ7XG5cdFx0JGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gdW5kZWZpbmVkOyAvLyDrqqjrk6Ag7JqU7LKt7JeQIOuMgO2VtCDtlbTri7kg7Zek642U66W8IOyghOyXreycvOuhnCDrtpnsnoQuXG5cdH1cbn0pOyIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ1JlZ2lzdGVyQ3RybCcsIGZ1bmN0aW9uKCRzY29wZSwgJGxvY2F0aW9uLCBVc2VyU3ZjKXtcblx0JHNjb3BlLiRlbWl0KCdwYWdlY2hhbmdlJywgJHNjb3BlLnBhZ2VJZC5yZWdpc3Rlcik7XG5cblx0Ly8gVXNlclN2Y+yEnOu5hOyKpOydmCByZWdpc3Rlcu2VqOyImOyXkOyEnCDrsJvsnYAg7Jyg7KCA7KCV67O066W8IC0gYXBp7JeQ7IScIOuztOuCtOyhjOq4sCDrlYzrrLjsl5AgLmRhdGHroZwg7KCR6re8XG5cdC8vIOy1nOyDgeychCDsvZjtirjroaTrn6zsnbggQXBwbGljYXRpb25DdHJs7J2YICRzY29wZeuhnCDqsJLsnYQg67O064K06riwIOychO2VnCDsoITtjIzrpbwg67O064K464ukLlxuXHQkc2NvcGUucmVnaXN0ZXIgPSBmdW5jdGlvbih1c2VybmFtZSwgcGFzc3dvcmQsIHVzZXJkb2IsIHNleHBvcyl7XG5cdFx0VXNlclN2Yy5yZWdpc3Rlcih1c2VybmFtZSwgcGFzc3dvcmQsIHVzZXJkb2IsIHNleHBvcylcblx0XHQudGhlbihmdW5jdGlvbiAodXNlcil7XG5cdFx0XHRzd2FsKFwiT0shXCIsIFwiU3VjY2Vzc2Z1bGx5IHJlZ2lzdGVyZWRcIiwgXCJzdWNjZXNzXCIpXG5cdFx0XHQkbG9jYXRpb24ucGF0aCgnLycpO1xuXHRcdFx0JHNjb3BlLiRlbWl0KCdsb2dpbicsIHVzZXIpO1xuXHRcdH0sXG5cdFx0ZnVuY3Rpb24oZXJyb3Ipe1xuXHRcdFx0c3dhbChcIlJlZ2lzdGVyIGZhaWxlZCFcIiwgXCJVc2VybmFtZSBhbHJlYWR5IGV4aXN0c1wiLCBcImVycm9yXCIpO1xuXHRcdH0pO1xuXHR9O1x0XG59KTtcbiIsImFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLnNlcnZpY2UoJ1VzZXJTdmMnLCBmdW5jdGlvbigkaHR0cCwgJHJvb3RTY29wZSl7XG5cdHZhciBzdmMgPSB0aGlzO1xuXG5cdC8vIHN2Yy50b2tlbiAodGhpcy50b2tlbikg6rCS7Jy866GcIC9hcGkvdXNlciDrpbwg7Zi47LacXG5cdHN2Yy5nZXRVc2VyID0gZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJywgXG5cdFx0e1xuXHRcdFx0aGVhZGVyczogeydYLUF1dGgnOiAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gfVxuXHRcdFx0Ly9oZWFkZXJzOiB7J1gtQXV0aCc6ICRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXX1cblx0XHR9KVxuXHRcdC50aGVuKGZ1bmN0aW9uKHJlc3BvbnNlKXtcblx0XHRcdHJldHVybiByZXNwb25zZS5kYXRhOyAgLy8gLSBhcGnsl5DshJwg67O064K07KGM6riwIOuVjOusuOyXkCAuZGF0YeuhnCDsoJHqt7xcblx0XHR9LFxuXHRcdGZ1bmN0aW9uKGVycil7XG5cdFx0XHRjdXJyZW50VXNlciA9IHVuZGVmaW5lZDtcblx0XHR9KTtcblx0fTtcblxuXHQvLyBkZXNpZ25lZCB0byBiZSBjYWxsZWQgd2hlbiBhcHBsaWNhdGlvbiBsYXVuY2hlZFxuXHQvLyBmb3IgdGhlIHBlcnNvbnMgd2hvIHJlZnJlc2hlZCB0aGUgcGFnZSBidXQgZGlkIG5vdCBsb2dvdXQgLS0+IGl0IHdpbGwgYmUgc3RpbGwgbG9nZ2VkIGluIVxuXHRzdmMucmVtYWluTG9naW4gPSBmdW5jdGlvbigpe1xuXHRcdGNvbnNvbGUubG9nKFwiVG9rZW46XCIsIGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpKTtcblx0XHRjb25zb2xlLmxvZyhcIkFwcGxpY2F0aW9uIGhhcyBiZWVuIGxhdW5jaGVkXCIpXG5cdFx0aWYgKHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSAhPSAndW5kZWZpbmVkJyAmJiBcblx0XHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSAhPSAnbnVsbCcgJiZcblx0XHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndG9rZW4nKSApXG5cdFx0e1xuXHRcdFx0JGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpO1xuXG5cdFx0XHRjb25zb2xlLmxvZyhcIlJlbWFpbiBMb2dpbiBpbiBwcm9jZXNzLi5cIilcblx0XHRcdHZhciB1c2VyO1xuXHRcdFx0c3ZjLmdldFVzZXIoKVxuXHRcdFx0LnRoZW4oZnVuY3Rpb24odXNlcil7XG5cdFx0XHRcdCRyb290U2NvcGUuJGVtaXQoJ2xvZ2luJywgdXNlcik7XG5cdFx0XHR9LFxuXHRcdFx0ZnVuY3Rpb24oZXJyKXtcblx0XHRcdFx0Y29uc29sZS5sb2coZXJyKTtcblx0XHRcdFx0Y3VycmVudFVzZXIgPSB1bmRlZmluZWQ7XG5cdFx0XHR9KTtcblx0XHR9XG5cdH07XG5cblx0c3ZjLmNoYW5nZVBhc3N3b3JkID0gZnVuY3Rpb24obmV3UGFzc3dvcmQsIHBhc3N3b3JkKXtcblx0XHRyZXR1cm4gJGh0dHAuZ2V0KCcvYXBpL3VzZXJzJywgXG5cdFx0e1xuXHRcdFx0aGVhZGVyczogeydYLUF1dGgnOiAkaHR0cC5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnWC1BdXRoJ10gfVxuXHRcdH0pXG5cdFx0LnRoZW4oZnVuY3Rpb24odXNlcil7XG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS91c2Vycy9wYXNzd29yZF9jaGFuZ2UnLCBcblx0XHRcdHtcblx0XHRcdFx0cGFzc3dvcmQgICAgOiBwYXNzd29yZCxcblx0XHRcdFx0bmV3UGFzc3dvcmQgOiBuZXdQYXNzd29yZCxcblx0XHRcdFx0dXNlcm5hbWUgICAgOiB1c2VyLmRhdGEudXNlck5hbWVcblx0XHRcdH0pO1xuXHRcdH0pO1xuXHR9O1xuXG5cdC8vIHNlc3Npb24g7J2EIOydtOyaqe2VtOyEnCwg7Yyo7Iqk7JuM65Oc6rCAIOydvOy5mO2VmOuKlOyngCDqsoDsgqztlZjqs6AsXG5cdC8vIOydvOy5mO2VmOuptCDrsJvsnYAgand0IGVuY29kZWTrkJwgdXNlcm5hbWUsIOymiSDthqDtgbDsnYQg6rCA7KeA6rOgLFxuXHQvLyB2YWzsnbTrnbzripQg67OA7IiY7JeQIOuEo+qzoCwg7J206rKD7J2YIOuNsOydtO2EsOulvCBzdmMudG9rZW7sl5Drj4Qg7KCA7J6l7ZWY6rOgLFxuXHQvLyBzdmMuZ2V0VXNlcu2VqOyImOulvCDtmLjstpztlZzri6QuXG5cdHN2Yy5sb2dpbiA9IGZ1bmN0aW9uKHVzZXJuYW1lLCBwYXNzd29yZCl7XG5cdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2Vzc2lvbnMnLCBcblx0XHR7XG5cdFx0XHR1c2VybmFtZTogdXNlcm5hbWUsIFxuXHRcdFx0cGFzc3dvcmQ6IHBhc3N3b3JkXG5cdFx0fSlcblx0XHQudGhlbihmdW5jdGlvbiAocmVzcG9uc2Upe1xuXHRcdFx0d2luZG93LmxvY2FsU3RvcmFnZS50b2tlbiA9IHJlc3BvbnNlLmRhdGE7IC8vIGFwaeyXkOyEnCDrs7Trg4jquLDrlYzrrLjsl5AsIC5kYXRh66GcIOygkeq3vCAtIFRPRE9cblx0XHRcdCRodHRwLmRlZmF1bHRzLmhlYWRlcnMuY29tbW9uWydYLUF1dGgnXSA9IHJlc3BvbnNlLmRhdGE7IC8vIOuqqOuToCDsmpTssq3sl5Ag64yA7ZW0IO2VtOuLuSDtl6TrjZTrpbwg7KCE7Jet7Jy866GcIOu2meyehC5cblx0XHRcdHJldHVybiBzdmMuZ2V0VXNlcigpO1xuXHRcdH0pXG5cdH07XG5cblx0c3ZjLnJlZ2lzdGVyID0gZnVuY3Rpb24odXNlcm5hbWUsIHBhc3N3b3JkLCB1c2VyZG9iLCBzZXhwb3Mpe1xuXHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3VzZXJzJywgXG5cdFx0e1xuXHRcdFx0dXNlck5hbWU6IHVzZXJuYW1lLFxuXHRcdFx0cGFzc3dvcmQ6IHBhc3N3b3JkLFxuXHRcdFx0dXNlcmRvYiA6IHVzZXJkb2IsXG5cdFx0XHRzZXhQb3MgIDogc2V4cG9zXG5cdFx0fSlcblx0XHQudGhlbihmdW5jdGlvbiAoKXtcblx0XHRcdHJldHVybiBzdmMubG9naW4odXNlcm5hbWUsIHBhc3N3b3JkKTtcblx0XHR9KTtcblx0fTtcblxuXHRzdmMubG9nb3V0ID0gZnVuY3Rpb24oKXtcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmxvbmdpdHVkZSA9IHVuZGVmaW5lZDtcblx0XHR3aW5kb3cubG9jYWxTdG9yYWdlLmxhdGl0dWRlID0gdW5kZWZpbmVkO1xuXHRcdHdpbmRvdy5sb2NhbFN0b3JhZ2UudG9rZW4gPSB1bmRlZmluZWQ7XG5cdFx0JGh0dHAuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ1gtQXV0aCddID0gdW5kZWZpbmVkOyAvLyDrqqjrk6Ag7JqU7LKt7JeQIOuMgO2VtCDtlbTri7kg7Zek642U66W8IOyghOyXreycvOuhnCDrtpnsnoQuXG5cdH1cbn0pOyJdLCJzb3VyY2VSb290IjoiL3NvdXJjZS8ifQ==