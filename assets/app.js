angular.module("app",["ngRoute"]),angular.module("app").controller("ApplicationCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){for(var e=0;18>e;e++)EdgeManagerCluster.hideAll(),NodeManagerCluster.hideAll()}function r(){for(var e=0;18>e;e++)EdgeManagerCluster.showAll(),NodeManagerCluster.showAll()}function s(){var e=function(){this.AdditiveColor=!0,this.Restart=function(){location.reload()},this.HideNodes=!1,this.HideNames=!1,this.Data="US"};RENDEROPTIONS=new e;var l=new dat.GUI,t=l.add(RENDEROPTIONS,"Data",["US","KOR"]),r=l.addFolder("Clusters"),s=r.add(RENDEROPTIONS,"HideNodes"),i=l.addFolder("MergePaths"),o=i.add(RENDEROPTIONS,"HideNodes"),n=i.add(RENDEROPTIONS,"HideNames");t.onFinishChange(function(e){"US"==e?(dataManager.start("US"),a.clusterids=[{value:1,displayName:"1"},{value:2,displayName:"2"},{value:3,displayName:"3"},{value:4,displayName:"4"},{value:5,displayName:"5"},{value:6,displayName:"6"},{value:7,displayName:"7"},{value:8,displayName:"8"},{value:9,displayName:"9"},{value:10,displayName:"10"},{value:11,displayName:"11"},{value:12,displayName:"12"},{value:13,displayName:"13"},{value:14,displayName:"14"},{value:15,displayName:"15"},{value:16,displayName:"16"},{value:17,displayName:"Not Clustered"},{value:18,displayName:"All"}],1==PAGE_NUM.value?a.resetClusters():2==PAGE_NUM.value&&a.resetMergePaths(),a.mergePathIds.value="acute myocardial infarction",a.$apply()):"KOR"==e&&(dataManager.start("KOR"),a.clusterids=[{value:0,displayName:"0"},{value:1,displayName:"1"},{value:2,displayName:"2"},{value:3,displayName:"Not Clustered"},{value:4,displayName:"All"}],1==PAGE_NUM.value?a.resetClusters():2==PAGE_NUM.value&&a.resetMergePaths(),a.mergePathIds.value="chronic viral hepatitis",a.$apply())}),s.onFinishChange(function(e){NodeManagerCluster.toggleNodeVisibility(1==e?!1:!0)}),o.onFinishChange(function(e){if(1==e)for(var a=0;a<NodeManagerMergePaths.length;a++)for(var l=0;l<SELECTED_MERGEPATHIDS.length;l++)SELECTED_MERGEPATHIDS[l]===a&&NodeManagerMergePaths[a].toggleNodeVisibility(!1);else for(var a=0;a<NodeManagerMergePaths.length;a++)for(var l=0;l<SELECTED_MERGEPATHIDS.length;l++)SELECTED_MERGEPATHIDS[l]===a&&NodeManagerMergePaths[a].toggleNodeVisibility(!0)}),n.onFinishChange(function(e){if(1==e)for(var a=0;a<NodeManagerMergePaths.length;a++)for(var l=0;l<SELECTED_MERGEPATHIDS.length;l++)SELECTED_MERGEPATHIDS[l]===a&&NodeManagerMergePaths[a].toggleNodeTextVisibility(!1);else for(var a=0;a<NodeManagerMergePaths.length;a++)for(var l=0;l<SELECTED_MERGEPATHIDS.length;l++)SELECTED_MERGEPATHIDS[l]===a&&NodeManagerMergePaths[a].toggleNodeTextVisibility(!0)}),l.add(RENDEROPTIONS,"Restart"),$(l.domElement).find(">ul").toggleClass("closed")}a.meanAge={value:0},a.mergePathIds={value:"acute myocardial infarction"},a.getMenuShow=function(){return a.show_menu},$(window).resize(function(){this.resizeTO&&clearTimeout(this.resizeTO),this.resizeTO=setTimeout(function(){$(this).trigger("resizeEnd")},200)}),$(window).bind("resizeEnd",function(){location.reload()}),a.clusterids=[{value:1,displayName:"1"},{value:2,displayName:"2"},{value:3,displayName:"3"},{value:4,displayName:"4"},{value:5,displayName:"5"},{value:6,displayName:"6"},{value:7,displayName:"7"},{value:8,displayName:"8"},{value:9,displayName:"9"},{value:10,displayName:"10"},{value:11,displayName:"11"},{value:12,displayName:"12"},{value:13,displayName:"13"},{value:14,displayName:"14"},{value:15,displayName:"15"},{value:16,displayName:"16"},{value:17,displayName:"Not Clustered"},{value:18,displayName:"All"}],a.cleanMergePaths=function(){NodeManagerMergePaths[SELECTED_MERGEPATHID].clean()},a.resetMergePaths=function(){FRAME.value=0,PAGE_NUM.value=2,TWEEN.removeAll(),NodeManagerMergePaths[SELECTED_MERGEPATHID].reset(),EdgeManagerMergePaths[SELECTED_MERGEPATHID].reset()},a.resetClusters=function(){FRAME.value=0,PAGE_NUM.value=1,a.meanAge.value=0,TWEEN.removeAll(),EdgeManagerCluster.reset(),NodeManagerCluster.reset(),a.setClusterID(SELECTED_CLUSTER),a.updateMeanAge()},a.setClusterID=function(e){return SELECTED_CLUSTER=e,e==NOT_CLUSTER_ID?(SELECTED_CLUSTER=NOT_CLUSTER_ID,t(),EdgeManagerCluster.toggleShowByCluster(NOT_CLUSTER_ID),void NodeManagerCluster.toggleShowByCluster(NOT_CLUSTER_ID)):e==ALL_CLUSTER_ID?void r():(t(),EdgeManagerCluster.toggleShowByCluster(SELECTED_CLUSTER),void NodeManagerCluster.toggleShowByCluster(SELECTED_CLUSTER))},a.updateMeanAge=function(){if(!(FRAME.value>620||1!=PAGE_NUM.value)){var e=mapRange([0,620],[35.4,90.5],FRAME.value);a.meanAge.value=Math.ceil(e),a.$apply(),requestAnimationFrame(a.updateMeanAge)}},s()}]),angular.module("app").config(["$routeProvider",function(e){e.when("/mergepaths",{templateUrl:"/templates/mergepaths.html",controller:"MergePathCtrl"}).when("/clusters",{templateUrl:"/templates/clusters.html",controller:"ClusterCtrl"}).when("/intro",{templateUrl:"/templates/intro.html",controller:"IntroCtrl"}).otherwise({redirectTo:"/intro"})}]),angular.module("app").controller("ClusterCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){PAGE_NUM.value=1,bCanvasLoaded&&$("#options-clusters").css("visibility","visible")}function r(){$(".data-visibility").addClass("active")}t(),a.selectedid={value:SELECTED_CLUSTER},r(),$("#btn-reset-clusters").click(function(){a.resetClusters()}),a.updateMeanAge(),$("#clusterid").change(function(){var e=$("#clusterid").val();a.setClusterID(e)})}]),angular.module("app").controller("IntroCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){PAGE_NUM.value=0}function r(){$(".data-visibility").removeClass("active")}t(),r()}]),angular.module("app").controller("MergePathCtrl",["$rootScope","$scope","$window",function(e,a,l){function t(){PAGE_NUM.value=2,bCanvasLoaded&&$("#options-mergepaths").css("visibility","visible")}function r(){$(".data-visibility").addClass("active")}t(),r(),$("#btn-reset-mergepaths").click(function(){a.resetMergePaths()}),$("#btn-run-mergepaths").click(function(){var e=document.getElementById("textinfo-mergepathids").value;try{var l=parseInt(e);if(isNaN(l))for(var t=e.toLowerCase(),r=0;r<MERGEPATH_INITNODE_REF.length;r++){var s=MERGEPATH_INITNODE_REF[r];if(s==t){e=r,console.log("selected disease for",t," is id:",r);break}}}catch(i){return void console.log(i)}a.cleanMergePaths(),SELECTED_MERGEPATHID=e,console.log(e),a.mergePathIds.value=MERGEPATH_INITNODE_REF[e],a.$apply(),a.resetMergePaths()})}]);
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm1vZHVsZS5qcyIsImFwcGxpY2F0aW9uLmN0cmwuanMiLCJyb3V0ZXMuanMiLCJDb250cm9sbGVycy9jbHVzdGVyLmN0cmwuanMiLCJDb250cm9sbGVycy9pbnRyby5jdHJsLmpzIiwiQ29udHJvbGxlcnMvbWVyZ2VwYXRoLmN0cmwuanMiXSwibmFtZXMiOlsiYW5ndWxhciIsIm1vZHVsZSIsImNvbnRyb2xsZXIiLCIkcm9vdFNjb3BlIiwiJHNjb3BlIiwiJHdpbmRvdyIsImNsZWFyQWxsQ2x1c3RlcnMiLCJpIiwiRWRnZU1hbmFnZXJDbHVzdGVyIiwiaGlkZUFsbCIsIk5vZGVNYW5hZ2VyQ2x1c3RlciIsInZpZXdBbGxDbHVzdGVycyIsInNob3dBbGwiLCJzZXREYXRhR3VpSW5pdGlhbGl6ZSIsInJlbmRlck9wdGlvbnNVSSIsInRoaXMiLCJBZGRpdGl2ZUNvbG9yIiwiUmVzdGFydCIsImxvY2F0aW9uIiwicmVsb2FkIiwiSGlkZU5vZGVzIiwiSGlkZU5hbWVzIiwiRGF0YSIsIlJFTkRFUk9QVElPTlMiLCJndWkiLCJkYXQiLCJHVUkiLCJEYXRhVHlwZSIsImFkZCIsIkNsdXN0ZXJzR3JwIiwiYWRkRm9sZGVyIiwiQ2x1c3RlckhpZGVOb2RlcyIsIk1lcmdlUGF0aEdycCIsIk1lcmdlUGF0aEhpZGVOb2RlcyIsIk1lcmdlUGF0aEhpZGVOYW1lcyIsIm9uRmluaXNoQ2hhbmdlIiwidmFsIiwiZGF0YU1hbmFnZXIiLCJzdGFydCIsImNsdXN0ZXJpZHMiLCJ2YWx1ZSIsImRpc3BsYXlOYW1lIiwiUEFHRV9OVU0iLCJyZXNldENsdXN0ZXJzIiwicmVzZXRNZXJnZVBhdGhzIiwibWVyZ2VQYXRoSWRzIiwiJGFwcGx5IiwidG9nZ2xlTm9kZVZpc2liaWxpdHkiLCJOb2RlTWFuYWdlck1lcmdlUGF0aHMiLCJsZW5ndGgiLCJqIiwiU0VMRUNURURfTUVSR0VQQVRISURTIiwidG9nZ2xlTm9kZVRleHRWaXNpYmlsaXR5IiwiJCIsImRvbUVsZW1lbnQiLCJmaW5kIiwidG9nZ2xlQ2xhc3MiLCJtZWFuQWdlIiwiZ2V0TWVudVNob3ciLCJzaG93X21lbnUiLCJ3aW5kb3ciLCJyZXNpemUiLCJyZXNpemVUTyIsImNsZWFyVGltZW91dCIsInNldFRpbWVvdXQiLCJ0cmlnZ2VyIiwiYmluZCIsImNsZWFuTWVyZ2VQYXRocyIsIlNFTEVDVEVEX01FUkdFUEFUSElEIiwiY2xlYW4iLCJGUkFNRSIsIlRXRUVOIiwicmVtb3ZlQWxsIiwicmVzZXQiLCJFZGdlTWFuYWdlck1lcmdlUGF0aHMiLCJzZXRDbHVzdGVySUQiLCJTRUxFQ1RFRF9DTFVTVEVSIiwidXBkYXRlTWVhbkFnZSIsImNsdXN0ZXJpZCIsIk5PVF9DTFVTVEVSX0lEIiwidG9nZ2xlU2hvd0J5Q2x1c3RlciIsIkFMTF9DTFVTVEVSX0lEIiwibmV3TWVhbkFnZSIsIm1hcFJhbmdlIiwiTWF0aCIsImNlaWwiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJjb25maWciLCIkcm91dGVQcm92aWRlciIsIndoZW4iLCJ0ZW1wbGF0ZVVybCIsIm90aGVyd2lzZSIsInJlZGlyZWN0VG8iLCJzZXRQYWdlTnVtIiwiYkNhbnZhc0xvYWRlZCIsImNzcyIsInNldFZpc2liaWxpdHkiLCJhZGRDbGFzcyIsInNlbGVjdGVkaWQiLCJjbGljayIsImNoYW5nZSIsInJlbW92ZUNsYXNzIiwiaW5wdXQiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwibWVyZ2VQYXRoSWQiLCJwYXJzZUludCIsImlzTmFOIiwibG93ZXJDYXNlZERpc2Vhc2VOYW1lIiwidG9Mb3dlckNhc2UiLCJNRVJHRVBBVEhfSU5JVE5PREVfUkVGIiwibmFtZSIsImNvbnNvbGUiLCJsb2ciLCJlcnIiXSwibWFwcGluZ3MiOiJBQUNBQSxRQUFBQyxPQUFBLE9BQ0EsWUNGQUQsUUFBQUMsT0FBQSxPQUNBQyxXQUFBLG1CQUFBLGFBQUEsU0FBQSxVQUFBLFNBQUFDLEVBQUFDLEVBQUFDLEdBOEdBLFFBQUFDLEtBQ0EsSUFBQSxHQUFBQyxHQUFBLEVBQUEsR0FBQUEsRUFB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RyxFQUVBLElBQUF3RyxHQUFBSCxFQUFBLENBRUFOLEVBQUEvRixFQUNBeUcsUUFBQUMsSUFBQSx1QkFBQUwsRUFBQSxVQUFBckcsRUFDQSxTQVFBLE1BQUEyRyxHQUVBLFdBREFGLFNBQUFDLElBQUFDLEdBSUE5RyxFQUFBK0Qsa0JBRUFDLHFCQUFBa0MsRUFFQVUsUUFBQUMsSUFBQVgsR0FFQWxHLEVBQUF5QyxhQUFBTCxNQUFBc0UsdUJBQUFSLEdBQ0FsRyxFQUFBMEMsU0FFQTFDLEVBQUF3QyIsImZpbGUiOiJhcHAuanMiLCJzb3VyY2VzQ29udGVudCI6WyJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXG5cdCduZ1JvdXRlJyxcbl0pO1xuIiwiYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29udHJvbGxlcignQXBwbGljYXRpb25DdHJsJywgZnVuY3Rpb24oJHJvb3RTY29wZSwgJHNjb3BlLCAkd2luZG93KXtcblxuXHQkc2NvcGUubWVhbkFnZSA9IHsgdmFsdWUgOiAwIH07XG5cdCRzY29wZS5tZXJnZVBhdGhJZHMgPSB7IHZhbHVlIDogXCJhY3V0ZSBteW9jYXJkaWFsIGluZmFyY3Rpb25cIn07XG5cblx0JHNjb3BlLmdldE1lbnVTaG93ID0gZnVuY3Rpb24oKXtcblx0XHRyZXR1cm4gJHNjb3BlLnNob3dfbWVudTtcblx0fVxuXG5cdC8vIGFzIHJlc2l6ZSwgcmUtaW5pdCBkYXRhc1xuXHQkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uKCkge1xuICAgIGlmKHRoaXMucmVzaXplVE8pIGNsZWFyVGltZW91dCh0aGlzLnJlc2l6ZVRPKTtcblx0ICAgIHRoaXMucmVzaXplVE8gPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuXHQgICAgICAgICQodGhpcykudHJpZ2dlcigncmVzaXplRW5kJyk7XG5cdCAgICB9LCAyMDApO1xuXHR9KTtcblxuXHQkKHdpbmRvdykuYmluZCgncmVzaXplRW5kJywgZnVuY3Rpb24oKSB7XG5cdCAgICAvL2RvIHNvbWV0aGluZywgd2luZG93IGhhc24ndCBjaGFuZ2VkIHNpemUgaW4gNTAwbXNcblx0ICAgIGxvY2F0aW9uLnJlbG9hZCgpO1xuXHR9KTtcblxuXHQkc2NvcGUuY2x1c3RlcmlkcyA9IFtcbiAgICAgIHt2YWx1ZTogMSwgZGlzcGxheU5hbWU6ICcxJ30sXG4gICAgICB7dmFsdWU6IDIsIGRpc3BsYXlOYW1lOiAnMid9LFxuICAgICAge3ZhbHVlOiAzLCBkaXNwbGF5TmFtZTogJzMnfSxcbiAgICAgIHt2YWx1ZTogNCwgZGlzcGxheU5hbWU6ICc0J30sXG4gICAgICB7dmFsdWU6IDUsIGRpc3BsYXlOYW1lOiAnNSd9LFxuICAgICAge3ZhbHVlOiA2LCBkaXNwbGF5TmFtZTogJzYnfSxcbiAgICAgIHt2YWx1ZTogNywgZGlzcGxheU5hbWU6ICc3J30sXG4gICAgICB7dmFsdWU6IDgsIGRpc3BsYXlOYW1lOiAnOCd9LFxuICAgICAge3ZhbHVlOiA5LCBkaXNwbGF5TmFtZTogJzknfSxcbiAgICAgIHt2YWx1ZTogMTAsIGRpc3BsYXlOYW1lOiAnMTAnfSxcbiAgICAgIHt2YWx1ZTogMTEsIGRpc3BsYXlOYW1lOiAnMTEnfSxcbiAgICAgIHt2YWx1ZTogMTIsIGRpc3BsYXlOYW1lOiAnMTInfSxcbiAgICAgIHt2YWx1ZTogMTMsIGRpc3BsYXlOYW1lOiAnMTMnfSxcbiAgICAgIHt2YWx1ZTogMTQsIGRpc3BsYXlOYW1lOiAnMTQnfSxcbiAgICAgIHt2YWx1ZTogMTUsIGRpc3BsYXlOYW1lOiAnMTUnfSxcbiAgICAgIHt2YWx1ZTogMTYsIGRpc3BsYXlOYW1lOiAnMTYnfSxcbiAgICAgIHt2YWx1ZTogMTcsIGRpc3BsYXlOYW1lOiAnTm90IENsdXN0ZXJlZCd9LFxuICAgICAge3ZhbHVlOiAxOCwgZGlzcGxheU5hbWU6ICdBbGwnfVxuICBcdF07XG5cblxuXG5cdCRzY29wZS5jbGVhbk1lcmdlUGF0aHMgPSBmdW5jdGlvbigpe1xuXG5cdFx0Tm9kZU1hbmFnZXJNZXJnZVBhdGhzW1NFTEVDVEVEX01FUkdFUEFUSElEXS5jbGVhbigpO1xuXG5cdH1cblxuXHQkc2NvcGUucmVzZXRNZXJnZVBhdGhzID0gZnVuY3Rpb24oKXtcblx0XHRGUkFNRS52YWx1ZSAgICA9IDA7XG5cdFx0UEFHRV9OVU0udmFsdWUgPSAyO1xuXG5cdFx0VFdFRU4ucmVtb3ZlQWxsKCk7IC8vIHJlc2V0IHR3ZWVuIGFuaW1hdGlvbnNcblxuXHRcdE5vZGVNYW5hZ2VyTWVyZ2VQYXRoc1tTRUxFQ1RFRF9NRVJHRVBBVEhJRF0ucmVzZXQoKTtcblx0XHRFZGdlTWFuYWdlck1lcmdlUGF0aHNbU0VMRUNURURfTUVSR0VQQVRISURdLnJlc2V0KCk7XG5cblx0fVxuXG5cdCRzY29wZS5yZXNldENsdXN0ZXJzID0gZnVuY3Rpb24oKXtcblxuICAgICAgXHRGUkFNRS52YWx1ZSAgICA9IDA7XG4gICAgICBcdFBBR0VfTlVNLnZhbHVlID0gMTtcblxuICAgICAgXHQkc2NvcGUubWVhbkFnZS52YWx1ZSA9IDA7XG5cbiAgICAgIFx0VFdFRU4ucmVtb3ZlQWxsKCk7IC8vIHJlc2V0IHR3ZWVuIGFuaW1hdGlvbnNcblxuICAgICAgXHRFZGdlTWFuYWdlckNsdXN0ZXIucmVzZXQoKTtcbiAgICAgIFx0Tm9kZU1hbmFnZXJDbHVzdGVyLnJlc2V0KCk7XG5cbiAgICAgIFx0JHNjb3BlLnNldENsdXN0ZXJJRChTRUxFQ1RFRF9DTFVTVEVSKTtcblxuICAgICAgXHQkc2NvcGUudXBkYXRlTWVhbkFnZSgpO1xuXHRcblx0fVxuXG5cdCRzY29wZS5zZXRDbHVzdGVySUQgPSBmdW5jdGlvbihjbHVzdGVyaWQpe1xuXG5cdCAgICBTRUxFQ1RFRF9DTFVTVEVSID0gY2x1c3RlcmlkO1xuXG5cdCAgICBpZiAoY2x1c3RlcmlkID09IE5PVF9DTFVTVEVSX0lEKXtcblxuXHQgICAgICAgIFNFTEVDVEVEX0NMVVNURVIgPSBOT1RfQ0xVU1RFUl9JRDtcblx0ICAgICAgICBcblx0ICAgICAgICBjbGVhckFsbENsdXN0ZXJzKCk7XG5cdCAgICAgICAgRWRnZU1hbmFnZXJDbHVzdGVyLnRvZ2dsZVNob3dCeUNsdXN0ZXIoTk9UX0NMVVNURVJfSUQpO1xuXHQgICAgICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci50b2dnbGVTaG93QnlDbHVzdGVyKE5PVF9DTFVTVEVSX0lEKTtcblxuXHQgICAgICAgIHJldHVybjtcblxuXHQgICAgfVxuXG5cdCAgICBpZiAoY2x1c3RlcmlkID09IEFMTF9DTFVTVEVSX0lEKXtcblxuXHQgICAgICAgIHZpZXdBbGxDbHVzdGVycygpOyBcblxuXHQgICAgICAgIHJldHVybjsgXG5cblx0ICAgIH1cblxuXHQgICAgY2xlYXJBbGxDbHVzdGVycygpO1xuXHQgICAgRWRnZU1hbmFnZXJDbHVzdGVyLnRvZ2dsZVNob3dCeUNsdXN0ZXIoU0VMRUNURURfQ0xVU1RFUik7XG5cdCAgICBOb2RlTWFuYWdlckNsdXN0ZXIudG9nZ2xlU2hvd0J5Q2x1c3RlcihTRUxFQ1RFRF9DTFVTVEVSKTtcblx0fVxuXG5cdC8vIGNsZWFyIGFsbCBjbHVzdGVyc1xuICBcdGZ1bmN0aW9uIGNsZWFyQWxsQ2x1c3RlcnMoKXsgLy8g7KeA6riIIOydtOqyjCBnbG9iYWzroZwg7KCV7J2Y65CcIOqyg+yduOuNsCwg7JWE66eI64+EIO2BtOuhnOylrOyWtCDslYjsl5Ag64Sj7Ja07IScLCDsnbQg7YyM7J28IOyViOyXkOyEnOunjCDqsIDriqXtlZwgbG9jYWwgc3BhY2XroZwg7Jiu6rKo7JW8IO2VoOuTr+yLtuuLpC5cblx0ICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMTg7IGkrKyl7XG5cblx0ICAgICAgRWRnZU1hbmFnZXJDbHVzdGVyLmhpZGVBbGwoKTtcblx0ICAgICAgTm9kZU1hbmFnZXJDbHVzdGVyLmhpZGVBbGwoKTtcblxuXHQgICAgfVxuXHR9XG5cblx0Ly8gY2xlYXIgYWxsIGNsdXN0ZXJzXG5cdGZ1bmN0aW9uIHZpZXdBbGxDbHVzdGVycygpe1xuXHQgICAgZm9yICh2YXIgaSA9IDA7IGkgPCAxODsgaSsrKXtcblxuXHQgICAgICBFZGdlTWFuYWdlckNsdXN0ZXIuc2hvd0FsbCgpO1xuXHQgICAgICBOb2RlTWFuYWdlckNsdXN0ZXIuc2hvd0FsbCgpO1xuXG5cdCAgICB9XG5cdH1cblxuXHQkc2NvcGUudXBkYXRlTWVhbkFnZSA9IGZ1bmN0aW9uKCl7XG5cdCAgICBpZiAoRlJBTUUudmFsdWUgPiA2MjAgfHwgUEFHRV9OVU0udmFsdWUgIT0gMSlcblx0ICAgICAgcmV0dXJuO1xuXG5cdCAgICB2YXIgbmV3TWVhbkFnZSA9IG1hcFJhbmdlKFswLCA2MjAuMF0sIFszNS40LCA5MC41XSwgRlJBTUUudmFsdWUpO1xuXHQgICAgJHNjb3BlLm1lYW5BZ2UudmFsdWUgPSBNYXRoLmNlaWwobmV3TWVhbkFnZSk7XG5cdCAgICAkc2NvcGUuJGFwcGx5KCk7XG5cdCAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoJHNjb3BlLnVwZGF0ZU1lYW5BZ2UpO1xuXHR9XG5cblx0ZnVuY3Rpb24gc2V0RGF0YUd1aUluaXRpYWxpemUoKXtcblxuXHQgICAgdmFyIHJlbmRlck9wdGlvbnNVSSA9IGZ1bmN0aW9uKCkge1xuXG5cdCAgICAgIHRoaXMuQWRkaXRpdmVDb2xvciA9IHRydWU7XG5cblx0ICAgICAgdGhpcy5SZXN0YXJ0ID0gZnVuY3Rpb24oKSB7IFxuXG5cdCAgICAgIFx0IC8vIHJlc3RhcnQgdGhlIHBhZ2Vcblx0ICAgICAgXHQgbG9jYXRpb24ucmVsb2FkKCk7XG5cblx0ICAgICAgfTtcblxuXHQgICAgICB0aGlzLkhpZGVOb2RlcyA9IGZhbHNlO1xuXG5cdCAgICAgIHRoaXMuSGlkZU5hbWVzID0gZmFsc2U7XG5cblx0ICAgICAgdGhpcy5EYXRhICAgICAgPSAnVVMnO1xuXHQgICAgfTtcblxuXHQgICAgUkVOREVST1BUSU9OUyBcdD0gbmV3IHJlbmRlck9wdGlvbnNVSSgpO1xuXHQgICAgdmFyIGd1aSAgXHRcdD0gbmV3IGRhdC5HVUkoKTtcblxuXHQgICAgdmFyIERhdGFUeXBlICAgICAgICAgPSBndWkuYWRkKFJFTkRFUk9QVElPTlMsICdEYXRhJywgWyAnVVMnLCAnS09SJyBdICk7XG5cblx0ICAgIHZhciBDbHVzdGVyc0dycCAgICAgID0gZ3VpLmFkZEZvbGRlcignQ2x1c3RlcnMnKTtcblx0XHR2YXIgQ2x1c3RlckhpZGVOb2RlcyA9IENsdXN0ZXJzR3JwLmFkZChSRU5ERVJPUFRJT05TLCAnSGlkZU5vZGVzJyk7XG5cblx0XHR2YXIgTWVyZ2VQYXRoR3JwICAgICAgID0gZ3VpLmFkZEZvbGRlcignTWVyZ2VQYXRocycpO1xuXHRcdHZhciBNZXJnZVBhdGhIaWRlTm9kZXMgPSBNZXJnZVBhdGhHcnAuYWRkKFJFTkRFUk9QVElPTlMsICdIaWRlTm9kZXMnKTtcblx0XHR2YXIgTWVyZ2VQYXRoSGlkZU5hbWVzID0gTWVyZ2VQYXRoR3JwLmFkZChSRU5ERVJPUFRJT05TLCAnSGlkZU5hbWVzJyk7XG5cblx0XHREYXRhVHlwZS5vbkZpbmlzaENoYW5nZShmdW5jdGlvbih2YWwpIHtcblx0XHRcdGlmICh2YWwgPT0gJ1VTJyl7XG5cdFx0XHRcdGRhdGFNYW5hZ2VyLnN0YXJ0KCdVUycpO1xuXHRcdFx0XHQkc2NvcGUuY2x1c3RlcmlkcyA9IFtcblx0XHRcdCAgICAgIHt2YWx1ZTogMSwgZGlzcGxheU5hbWU6ICcxJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDIsIGRpc3BsYXlOYW1lOiAnMid9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiAzLCBkaXNwbGF5TmFtZTogJzMnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogNCwgZGlzcGxheU5hbWU6ICc0J30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDUsIGRpc3BsYXlOYW1lOiAnNSd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiA2LCBkaXNwbGF5TmFtZTogJzYnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogNywgZGlzcGxheU5hbWU6ICc3J30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDgsIGRpc3BsYXlOYW1lOiAnOCd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiA5LCBkaXNwbGF5TmFtZTogJzknfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTAsIGRpc3BsYXlOYW1lOiAnMTAnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTEsIGRpc3BsYXlOYW1lOiAnMTEnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTIsIGRpc3BsYXlOYW1lOiAnMTInfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTMsIGRpc3BsYXlOYW1lOiAnMTMnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTQsIGRpc3BsYXlOYW1lOiAnMTQnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTUsIGRpc3BsYXlOYW1lOiAnMTUnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTYsIGRpc3BsYXlOYW1lOiAnMTYnfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMTcsIGRpc3BsYXlOYW1lOiAnTm90IENsdXN0ZXJlZCd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiAxOCwgZGlzcGxheU5hbWU6ICdBbGwnfVxuXHRcdFx0ICBcdF07XG5cdFx0XHQgIFx0aWYgKFBBR0VfTlVNLnZhbHVlID09IDEpIHtcblx0XHRcdCAgXHRcdCRzY29wZS5yZXNldENsdXN0ZXJzKCk7XG5cdFx0XHQgIFx0fVxuXHRcdFx0ICBcdGVsc2UgaWYgKFBBR0VfTlVNLnZhbHVlID09IDIpe1xuXHRcdFx0ICBcdFx0JHNjb3BlLnJlc2V0TWVyZ2VQYXRocygpO1xuXHRcdFx0ICBcdH1cblx0XHRcdCAgXHQkc2NvcGUubWVyZ2VQYXRoSWRzLnZhbHVlICA9IFwiYWN1dGUgbXlvY2FyZGlhbCBpbmZhcmN0aW9uXCI7XG5cdFx0XHQgIFx0JHNjb3BlLiRhcHBseSgpO1xuXHRcdFx0fVxuXHRcdFx0ZWxzZSBpZiAodmFsID09ICdLT1InKXtcblx0XHRcdFx0ZGF0YU1hbmFnZXIuc3RhcnQoJ0tPUicpO1xuXHRcdFx0XHQkc2NvcGUuY2x1c3RlcmlkcyA9IFtcblx0XHRcdCAgICAgIHt2YWx1ZTogMCwgZGlzcGxheU5hbWU6ICcwJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDEsIGRpc3BsYXlOYW1lOiAnMSd9LFxuXHRcdFx0ICAgICAge3ZhbHVlOiAyLCBkaXNwbGF5TmFtZTogJzInfSxcblx0XHRcdCAgICAgIHt2YWx1ZTogMywgZGlzcGxheU5hbWU6ICdOb3QgQ2x1c3RlcmVkJ30sXG5cdFx0XHQgICAgICB7dmFsdWU6IDQsIGRpc3BsYXlOYW1lOiAnQWxsJ31cblx0XHRcdCAgXHRdO1xuXHRcdFx0ICBcdGlmIChQQUdFX05VTS52YWx1ZSA9PSAxKXtcblx0XHRcdCAgXHRcdCRzY29wZS5yZXNldENsdXN0ZXJzKCk7XG5cdFx0XHQgIFx0fVxuXHRcdFx0ICBcdGVsc2UgaWYgKFBBR0VfTlVNLnZhbHVlID09IDIpe1xuXHRcdFx0ICBcdFx0JHNjb3BlLnJlc2V0TWVyZ2VQYXRocygpOyAgXG5cdFx0XHQgIFx0fVxuXHRcdFx0ICBcdCRzY29wZS5tZXJnZVBhdGhJZHMudmFsdWUgID0gXCJjaHJvbmljIHZpcmFsIGhlcGF0aXRpc1wiO1xuXHRcdFx0ICBcdCRzY29wZS4kYXBwbHkoKTtcblx0XHRcdH1cblx0XHR9KVxuXG5cdCAgICBDbHVzdGVySGlkZU5vZGVzLm9uRmluaXNoQ2hhbmdlKGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgXHRpZiAodmFsID09IHRydWUpIHtcblx0XHQgICAgICAgIE5vZGVNYW5hZ2VyQ2x1c3Rlci50b2dnbGVOb2RlVmlzaWJpbGl0eShmYWxzZSk7XG5cdCAgICBcdH1cblx0ICAgIFx0ZWxzZSB7XG5cdFx0ICAgICAgICBOb2RlTWFuYWdlckNsdXN0ZXIudG9nZ2xlTm9kZVZpc2liaWxpdHkodHJ1ZSk7XG5cdCAgICBcdH1cblx0ICAgIH0pO1xuXG5cdCAgIFx0TWVyZ2VQYXRoSGlkZU5vZGVzLm9uRmluaXNoQ2hhbmdlKGZ1bmN0aW9uKHZhbCkge1xuXHQgICAgXHRpZiAodmFsID09IHRydWUpIHtcblx0ICAgICAgICBcdGZvciAodmFyIGkgPSAwOyBpIDwgTm9kZU1hbmFnZXJNZXJnZVBhdGhzLmxlbmd0aDsgaSsrKXtcblxuXHRcdCAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IFNFTEVDVEVEX01FUkdFUEFUSElEUy5sZW5ndGg7IGorKyl7XG5cblx0XHQgICAgICAgICAgICBpZiAoU0VMRUNURURfTUVSR0VQQVRISURTW2pdID09PSBpKVxuXHRcdCAgICAgICAgICAgICAgTm9kZU1hbmFnZXJNZXJnZVBhdGhzW2ldLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KGZhbHNlKTtcblxuXHRcdCAgICAgICAgICB9XG5cdFx0ICAgICAgICAgIFxuXHRcdCAgICAgICAgfVxuXHQgICAgXHR9XG5cdCAgICBcdGVsc2Uge1xuXHQgICAgICAgIFx0Zm9yICh2YXIgaSA9IDA7IGkgPCBOb2RlTWFuYWdlck1lcmdlUGF0aHMubGVuZ3RoOyBpKyspe1xuXG5cdFx0ICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgU0VMRUNURURfTUVSR0VQQVRISURTLmxlbmd0aDsgaisrKXtcblxuXHRcdCAgICAgICAgICAgIGlmIChTRUxFQ1RFRF9NRVJHRVBBVEhJRFNbal0gPT09IGkpXG5cdFx0ICAgICAgICAgICAgICBOb2RlTWFuYWdlck1lcmdlUGF0aHNbaV0udG9nZ2xlTm9kZVZpc2liaWxpdHkodHJ1ZSk7XG5cblx0XHQgICAgICAgICAgfVxuXG5cdFx0ICAgICAgICB9XG5cdFx0ICAgIH1cblx0ICAgIH0pO1xuXG5cdCAgICBNZXJnZVBhdGhIaWRlTmFtZXMub25GaW5pc2hDaGFuZ2UoZnVuY3Rpb24odmFsKSB7XG5cdCAgICBcdGlmICh2YWwgPT0gdHJ1ZSkge1xuXHQgICAgXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgTm9kZU1hbmFnZXJNZXJnZVBhdGhzLmxlbmd0aDsgaSsrKXtcblxuXHRcdCAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IFNFTEVDVEVEX01FUkdFUEFUSElEUy5sZW5ndGg7IGorKyl7XG5cblx0XHQgICAgICAgICAgICBpZiAoU0VMRUNURURfTUVSR0VQQVRISURTW2pdID09PSBpKVxuXHRcdCAgICAgICAgICAgICAgTm9kZU1hbmFnZXJNZXJnZVBhdGhzW2ldLnRvZ2dsZU5vZGVUZXh0VmlzaWJpbGl0eShmYWxzZSk7XG5cblx0XHQgICAgICAgICAgfVxuXHRcdCAgICAgICAgfVxuXHQgICAgXHR9XG5cdCAgICBcdGVsc2Uge1xuXHQgICAgXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgTm9kZU1hbmFnZXJNZXJnZVBhdGhzLmxlbmd0aDsgaSsrKXtcblxuXHRcdCAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IFNFTEVDVEVEX01FUkdFUEFUSElEUy5sZW5ndGg7IGorKyl7XG5cblx0XHQgICAgICAgICAgICBpZiAoU0VMRUNURURfTUVSR0VQQVRISURTW2pdID09PSBpKVxuXHRcdCAgICAgICAgICAgICAgTm9kZU1hbmFnZXJNZXJnZVBhdGhzW2ldLnRvZ2dsZU5vZGVUZXh0VmlzaWJpbGl0eSh0cnVlKTtcblxuXHRcdCAgICAgICAgICB9XG5cdFx0ICAgICAgICB9XG5cdCAgICBcdH1cblx0ICAgIH0pO1xuXG5cdCAgICBndWkuYWRkKFJFTkRFUk9QVElPTlMsICdSZXN0YXJ0Jyk7XG5cblx0ICAgICQoZ3VpLmRvbUVsZW1lbnQpLmZpbmQoXCI+dWxcIikudG9nZ2xlQ2xhc3MoXCJjbG9zZWRcIik7IC8vIGRhdC5ndWkgZGVmYXVsdCB0byBiZSBjbG9zZWRcblxuXHR9XG4gIFx0c2V0RGF0YUd1aUluaXRpYWxpemUoKTtcbn0pOyIsIlxuYW5ndWxhci5tb2R1bGUoJ2FwcCcpXG4uY29uZmlnKGZ1bmN0aW9uICgkcm91dGVQcm92aWRlcil7XG5cdCRyb3V0ZVByb3ZpZGVyXG5cdC53aGVuKCcvbWVyZ2VwYXRocycsIFxuXHRcdHtcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9tZXJnZXBhdGhzLmh0bWwnLFxuXHRcdFx0Y29udHJvbGxlcjogJ01lcmdlUGF0aEN0cmwnXG5cdFx0fSlcblx0LndoZW4oJy9jbHVzdGVycycsIFxuXHRcdHtcblx0XHRcdHRlbXBsYXRlVXJsOiAnL3RlbXBsYXRlcy9jbHVzdGVycy5odG1sJyxcblx0XHRcdGNvbnRyb2xsZXI6ICdDbHVzdGVyQ3RybCdcblx0XHR9KVxuXHQud2hlbignL2ludHJvJywgXG5cdFx0e1xuXHRcdFx0dGVtcGxhdGVVcmw6ICcvdGVtcGxhdGVzL2ludHJvLmh0bWwnLFxuXHRcdFx0Y29udHJvbGxlcjogJ0ludHJvQ3RybCdcblx0XHR9KVxuXHQub3RoZXJ3aXNlKFxuXHRcdHtcbiAgIFx0XHRcdHJlZGlyZWN0VG86ICcvaW50cm8nXG5cdFx0fSk7XG5cbn0pO1xuIiwiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdDbHVzdGVyQ3RybCcsIGZ1bmN0aW9uKCRyb290U2NvcGUsICRzY29wZSwgJHdpbmRvdyl7XG5cbiAgZnVuY3Rpb24gc2V0UGFnZU51bSgpe1xuICAgIFBBR0VfTlVNLnZhbHVlID0gMTsgLy8gMSAtIGNsdXN0ZXJcblxuICAgIGlmIChiQ2FudmFzTG9hZGVkKVxuICAgICAgJCgnI29wdGlvbnMtY2x1c3RlcnMnKS5jc3MoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpO1xuICB9XG4gIHNldFBhZ2VOdW0oKTtcblxuICAkc2NvcGUuc2VsZWN0ZWRpZCA9IHsgdmFsdWUgOiBTRUxFQ1RFRF9DTFVTVEVSIH07XG5cblxuICBmdW5jdGlvbiBzZXRWaXNpYmlsaXR5KCl7XG4gICAgJCgnLmRhdGEtdmlzaWJpbGl0eScpLmFkZENsYXNzKCdhY3RpdmUnKTtcbiAgfVxuICBzZXRWaXNpYmlsaXR5KCk7XG5cblxuICAvLyByZXNldCBhbmltYXRpb24uXG4gICQoJyNidG4tcmVzZXQtY2x1c3RlcnMnKS5jbGljayhmdW5jdGlvbigpIHtcblxuICAgICRzY29wZS5yZXNldENsdXN0ZXJzKCk7XG5cbiAgfSk7XG5cblxuICAkc2NvcGUudXBkYXRlTWVhbkFnZSgpO1xuICAvKlxuICAvL3NldCBpbml0aWFsIHN0YXRlLiAgZXhhbXBsZSBvZiBjaGVjayBib3ggZXZlbnRcbiAgJCgnI2NoZWNrYm94LWhpZGUtbm9kZXMtY2x1c3RlcnMnKS5jaGFuZ2UoZnVuY3Rpb24oKSB7XG4gICAgICBpZigkKHRoaXMpLmlzKFwiOmNoZWNrZWRcIikpIHtcbiAgICAgICAgTm9kZU1hbmFnZXJDbHVzdGVyLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KHRydWUpO1xuICAgICAgfVxuICAgICAgZWxzZVxuICAgICAge1xuICAgICAgICBOb2RlTWFuYWdlckNsdXN0ZXIudG9nZ2xlTm9kZVZpc2liaWxpdHkoZmFsc2UpO1xuICAgICAgfVxuICB9KTtcbiAgKi9cblxuICAkKCcjY2x1c3RlcmlkJykuY2hhbmdlKGZ1bmN0aW9uKCl7XG5cbiAgICB2YXIgY2x1c3RlcmlkID0gJCgnI2NsdXN0ZXJpZCcpLnZhbCgpO1xuXG4gICAgJHNjb3BlLnNldENsdXN0ZXJJRChjbHVzdGVyaWQpO1xuXG4gIH0pXG5cblxufSk7IiwiXG5hbmd1bGFyLm1vZHVsZSgnYXBwJylcbi5jb250cm9sbGVyKCdJbnRyb0N0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICR3aW5kb3cpe1xuXG5cdGZ1bmN0aW9uIHNldFBhZ2VOdW0oKXtcbiAgICBcdFBBR0VfTlVNLnZhbHVlID0gMDtcbiAgXHR9XG4gIFx0c2V0UGFnZU51bSgpO1xuXG5cblx0ZnVuY3Rpb24gc2V0VmlzaWJpbGl0eSgpe1xuXHRcdCQoJy5kYXRhLXZpc2liaWxpdHknKS5yZW1vdmVDbGFzcygnYWN0aXZlJyk7XG5cdH1cblx0c2V0VmlzaWJpbGl0eSgpO1xuXG59KTsiLCJcbmFuZ3VsYXIubW9kdWxlKCdhcHAnKVxuLmNvbnRyb2xsZXIoJ01lcmdlUGF0aEN0cmwnLCBmdW5jdGlvbigkcm9vdFNjb3BlLCAkc2NvcGUsICR3aW5kb3cpe1xuXG4gIGZ1bmN0aW9uIHNldFBhZ2VOdW0oKXtcblxuICAgIFBBR0VfTlVNLnZhbHVlID0gMjtcbiAgICAvLyRzY29wZS5yZXNldE1lcmdlUGF0aHMoKTtcbiAgICBcbiAgICBpZiAoYkNhbnZhc0xvYWRlZClcbiAgICAgICQoJyNvcHRpb25zLW1lcmdlcGF0aHMnKS5jc3MoJ3Zpc2liaWxpdHknLCAndmlzaWJsZScpO1xuXG4gIH1cbiAgc2V0UGFnZU51bSgpO1xuXG4gIGZ1bmN0aW9uIHNldFZpc2liaWxpdHkoKXtcblxuICAgICQoJy5kYXRhLXZpc2liaWxpdHknKS5hZGRDbGFzcygnYWN0aXZlJyk7XG5cbiAgfVxuICBzZXRWaXNpYmlsaXR5KCk7XG5cblxuICAvLyByZXNldCBhbmltYXRpb24uXG4gICQoJyNidG4tcmVzZXQtbWVyZ2VwYXRocycpLmNsaWNrKGZ1bmN0aW9uKCkge1xuXG4gICAgJHNjb3BlLnJlc2V0TWVyZ2VQYXRocygpOyBcblxuICB9KTtcblxuXG4gICQoJyNidG4tcnVuLW1lcmdlcGF0aHMnKS5jbGljayhmdW5jdGlvbigpIHtcblxuICAgIHZhciBpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwidGV4dGluZm8tbWVyZ2VwYXRoaWRzXCIpLnZhbHVlO1xuXG4gICAgLy8gZGVhbCB3aXRoIGlucHV0IHRvIGZpbmQgbWVyZ2VwYXRoIVxuICAgIHRyeSB7XG5cbiAgICAgIHZhciBtZXJnZVBhdGhJZCA9IHBhcnNlSW50KGlucHV0KTtcbiAgICAgIGlmIChpc05hTihtZXJnZVBhdGhJZCkpe1xuXG4gICAgICAgIHZhciBsb3dlckNhc2VkRGlzZWFzZU5hbWUgPSBpbnB1dC50b0xvd2VyQ2FzZSgpO1xuXG4gICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTUVSR0VQQVRIX0lOSVROT0RFX1JFRi5sZW5ndGg7IGkrKyl7XG5cbiAgICAgICAgICB2YXIgbmFtZSA9IE1FUkdFUEFUSF9JTklUTk9ERV9SRUZbaV07XG5cbiAgICAgICAgICBpZiAobmFtZSA9PSBsb3dlckNhc2VkRGlzZWFzZU5hbWUpe1xuXG4gICAgICAgICAgICBpbnB1dCA9IGk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc2VsZWN0ZWQgZGlzZWFzZSBmb3InLCBsb3dlckNhc2VkRGlzZWFzZU5hbWUsICcgaXMgaWQ6JywgaSk7XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgIH0gXG5cbiAgICAgICAgfVxuXG4gICAgICB9XG4gICAgfVxuICAgIGNhdGNoKGVycikge1xuICAgICAgY29uc29sZS5sb2coZXJyKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAkc2NvcGUuY2xlYW5NZXJnZVBhdGhzKCk7XG5cbiAgICBTRUxFQ1RFRF9NRVJHRVBBVEhJRCA9IGlucHV0O1xuICAgIFxuICAgIGNvbnNvbGUubG9nKGlucHV0KTtcblxuICAgICRzY29wZS5tZXJnZVBhdGhJZHMudmFsdWUgPSBNRVJHRVBBVEhfSU5JVE5PREVfUkVGW2lucHV0XTtcbiAgICAkc2NvcGUuJGFwcGx5KCk7XG5cbiAgICAkc2NvcGUucmVzZXRNZXJnZVBhdGhzKCk7XG5cbiAgfSlcblxuICAvL3NldCBpbml0aWFsIHN0YXRlLlxuICAvKlxuICAkKCcjY2hlY2tib3gtaGlkZS1ub2Rlcy1tZXJnZXBhdGhzJykuY2hhbmdlKGZ1bmN0aW9uKCkge1xuICAgICAgaWYoJCh0aGlzKS5pcyhcIjpjaGVja2VkXCIpKSB7XG5cbiAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgTm9kZU1hbmFnZXJNZXJnZVBhdGhzLmxlbmd0aDsgaSsrKXtcblxuICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgU0VMRUNURURfTUVSR0VQQVRISURTLmxlbmd0aDsgaisrKXtcblxuICAgICAgICAgICAgaWYgKFNFTEVDVEVEX01FUkdFUEFUSElEU1tqXSA9PT0gaSlcbiAgICAgICAgICAgICAgTm9kZU1hbmFnZXJNZXJnZVBhdGhzW2ldLnRvZ2dsZU5vZGVWaXNpYmlsaXR5KHRydWUpO1xuXG4gICAgICAgICAgfVxuICAgICAgICAgIFxuICAgICAgICAgfVxuICAgICAgICBcbiAgICAgIH1cbiAgICAgIGVsc2VcbiAgICAgIHtcblxuICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IE5vZGVNYW5hZ2VyTWVyZ2VQYXRocy5sZW5ndGg7IGkrKyl7XG5cbiAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IFNFTEVDVEVEX01FUkdFUEFUSElEUy5sZW5ndGg7IGorKyl7XG5cbiAgICAgICAgICAgIGlmIChTRUxFQ1RFRF9NRVJHRVBBVEhJRFNbal0gPT09IGkpXG4gICAgICAgICAgICAgIE5vZGVNYW5hZ2VyTWVyZ2VQYXRoc1tpXS50b2dnbGVOb2RlVmlzaWJpbGl0eShmYWxzZSk7XG5cbiAgICAgICAgICB9XG5cbiAgICAgICAgIH1cblxuICAgICAgfVxuICB9KTtcblxuICAvL3NldCBpbml0aWFsIHN0YXRlLlxuICAkKCcjY2hlY2tib3gtaGlkZS1uYW1lcy1tZXJnZXBhdGhzJykuY2hhbmdlKGZ1bmN0aW9uKCkge1xuICAgICAgaWYoJCh0aGlzKS5pcyhcIjpjaGVja2VkXCIpKSB7XG5cbiAgICAgICAgTm9kZU1hbmFnZXJNZXJnZVBhdGhzW1NFTEVDVEVEX01FUkdFUEFUSElEXS50b2dnbGVOb2RlVGV4dFZpc2liaWxpdHkodHJ1ZSk7XG4gICAgICAgIFxuICAgICAgfVxuICAgICAgZWxzZVxuICAgICAge1xuXG4gICAgICAgIE5vZGVNYW5hZ2VyTWVyZ2VQYXRoc1tTRUxFQ1RFRF9NRVJHRVBBVEhJRF0udG9nZ2xlTm9kZVRleHRWaXNpYmlsaXR5KGZhbHNlKTtcblxuICAgICAgICAgIH1cblxuICAgICAgICAgfVxuXG4gICAgICB9XG4gIH0pO1xuKi9cbiAgXG59KTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=